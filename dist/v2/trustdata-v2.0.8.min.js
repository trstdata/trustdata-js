!(function(){"use strict";function t(t,i,r){return(i=(function(t){var i=(function(t){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""})(t);return"symbol"==typeof i?i:i+""})(i))in t?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r,t}function i(t,i){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),r.push.apply(r,e)}return r}function r(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(i){t(r,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))}))}return r}var e="undefined"!=typeof window?window:void 0,n="undefined"!=typeof globalThis?globalThis:e,s=Array.prototype.forEach,a=null==n?void 0:n.navigator,o=null==n?void 0:n.document,h=null==n?void 0:n.location,u=null==n?void 0:n.fetch,c=null!=n&&n.XMLHttpRequest&&"withCredentials"in new n.XMLHttpRequest?n.XMLHttpRequest:void 0,f=null==n?void 0:n.AbortController,l=null==a?void 0:a.userAgent,d=null!=e?e:{},v="undefined",p=Object.prototype,g=p.hasOwnProperty,_=p.toString,m=Array.isArray||function(t){return"[object Array]"===_.call(t)},w=t=>"function"==typeof t,b=t=>void 0===t,y=t=>"[object String]"==_.call(t),S=t=>null===t,x=t=>"[object Number]"==_.call(t),E=t=>{var i={o:function(i){if(e&&d.POSTHOG_DEBUG&&!b(e.console)&&e.console){for(var r=("__rrweb_original__"in e.console[i]?e.console[i].__rrweb_original__:e.console[i]),n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];r(t,...s)}},info:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];i.o("log",...r)},warn:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];i.o("warn",...r)},error:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];i.o("error",...r)},critical:function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r]},uninitializedWarning:t=>{i.error("You must initialize TrustData before calling ".concat(t))},createLogger:i=>E("".concat(t," ").concat(i))};return i},O=E("[TrustData.js]"),T=O.createLogger,k={};function M(t,i,r){if(m(t))if(s&&t.forEach===s)t.forEach(i,r);else if("length"in t&&t.length===+t.length)for(var e=0,n=t.length;e<n;e++)if(e in t&&i.call(r,t[e],e)===k)return}function R(t,i,r){if(!(t=>b(t)||S(t))(t)){if(m(t))return M(t,i,r);if((t=>t instanceof FormData)(t)){for(var e of t.entries())if(i.call(r,e[1],e[0])===k)return}else for(var n in t)if(g.call(t,n)&&i.call(r,t[n],n)===k)return}}var I=function(t){for(var i=arguments.length,r=Array(i>1?i-1:0),e=1;e<i;e++)r[e-1]=arguments[e];return M(r,(function(i){for(var r in i)void 0!==i[r]&&(t[r]=i[r])})),t},D=function(t){return function(){try{for(var i=arguments.length,r=Array(i),e=0;e<i;e++)r[e]=arguments[e];return t.apply(this,r)}catch(t){O.critical("Implementation error. Please turn on debug mode"),O.critical(t)}}};function U(t,i){for(var r=0;r<t.length;r++)if(i(t[r]))return t[r]}function C(t,i,r,e){var{capture:n=!1,passive:s=!0}={};null==t||t.addEventListener(i,r,{capture:n,passive:s})}var j=function(t,i,r){if(!t||!i||!i.length)return t;for(var e=t.split("#"),n=e[1],s=(e[0]||"").split("?"),a=s[1],o=s[0],h=(a||"").split("&"),u=[],c=0;c<h.length;c++){var f=h[c].split("=");m(f)&&(i.includes(f[0])?u.push(f[0]+"="+r):u.push(h[c]))}var l=o;return null!=a&&(l+="?"+u.join("&")),null!=n&&(l+="#"+n),l},N=3e3,P="page_view",A="page_leave",B="event_name",z="client_id",q="session_id",F="page_title",W="page_location",L="page_referrer",J="event_time",G="session_number",K="session_engaged",V="first_visit",X="entrances",$="ignore_referrer",H=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid","gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Q="text/plain",Y=Uint8Array,Z=Uint16Array,tt=Int32Array,it=new Y([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rt=new Y([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),et=new Y([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nt=function(t,i){for(var r=new Z(31),e=0;e<31;++e)r[e]=i+=1<<t[e-1];var n=new tt(r[30]);for(e=1;e<30;++e)for(var s=r[e];s<r[e+1];++s)n[s]=s-r[e]<<5|e;return{b:r,r:n}},st=nt(it,2),at=st.r;st.b[28]=258,at[258]=28;for(var ot=nt(rt,0).r,ht=new Z(32768),ut=0;ut<32768;++ut){var ct=(43690&ut)>>1|(21845&ut)<<1;ht[ut]=((65280&(ct=(61680&(ct=(52428&ct)>>2|(13107&ct)<<2))>>4|(3855&ct)<<4))>>8|(255&ct)<<8)>>1}var ft=function(t,i,r){for(var e=t.length,n=0,s=new Z(i);n<e;++n)t[n]&&++s[t[n]-1];var a,o=new Z(i);for(n=1;n<i;++n)o[n]=o[n-1]+s[n-1]<<1;if(r){a=new Z(1<<i);var h=15-i;for(n=0;n<e;++n)if(t[n])for(var u=n<<4|t[n],c=i-t[n],f=o[t[n]-1]++<<c,l=f|(1<<c)-1;f<=l;++f)a[ht[f]>>h]=u}else for(a=new Z(e),n=0;n<e;++n)t[n]&&(a[n]=ht[o[t[n]-1]++]>>15-t[n]);return a},lt=new Y(288);for(ut=0;ut<144;++ut)lt[ut]=8;for(ut=144;ut<256;++ut)lt[ut]=9;for(ut=256;ut<280;++ut)lt[ut]=7;for(ut=280;ut<288;++ut)lt[ut]=8;var dt=new Y(32);for(ut=0;ut<32;++ut)dt[ut]=5;var vt=ft(lt,9,0),pt=ft(dt,5,0),gt=function(t){return(t+7)/8|0},_t=function(t,i,r){return(null==r||r>t.length)&&(r=t.length),new Y(t.subarray(i,r))},mt=function(t,i,r){var e=i/8|0;t[e]|=r<<=7&i,t[e+1]|=r>>8},wt=function(t,i,r){var e=i/8|0;t[e]|=r<<=7&i,t[e+1]|=r>>8,t[e+2]|=r>>16},bt=function(t,i){for(var r=[],e=0;e<t.length;++e)t[e]&&r.push({s:e,f:t[e]});var n=r.length,s=r.slice();if(!n)return{t:kt,l:0};if(1==n){var a=new Y(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(t,i){return t.f-i.f})),r.push({s:-1,f:25001});var o=r[0],h=r[1],u=0,c=1,f=2;for(r[0]={s:-1,f:o.f+h.f,l:o,r:h};c!=n-1;)o=r[r[u].f<r[f].f?u++:f++],h=r[u!=c&&r[u].f<r[f].f?u++:f++],r[c++]={s:-1,f:o.f+h.f,l:o,r:h};var l=s[0].s;for(e=1;e<n;++e)s[e].s>l&&(l=s[e].s);var d=new Z(l+1),v=yt(r[c-1],d,0);if(v>i){e=0;var p=0,g=v-i,_=1<<g;for(s.sort((function(t,i){return d[i.s]-d[t.s]||t.f-i.f}));e<n;++e){var m=s[e].s;if(!(d[m]>i))break;p+=_-(1<<v-d[m]),d[m]=i}for(p>>=g;p>0;){var w=s[e].s;d[w]<i?p-=1<<i-d[w]++-1:++e}for(;e>=0&&p;--e){var b=s[e].s;d[b]==i&&(--d[b],++p)}v=i}return{t:new Y(d),l:v}},yt=function(t,i,r){return-1==t.s?Math.max(yt(t.l,i,r+1),yt(t.r,i,r+1)):i[t.s]=r},St=function(t){for(var i=t.length;i&&!t[--i];);for(var r=new Z(++i),e=0,n=t[0],s=1,a=function(t){r[e++]=t},o=1;o<=i;++o)if(t[o]==n&&o!=i)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=t[o]}return{c:r.subarray(0,e),n:i}},xt=function(t,i){for(var r=0,e=0;e<i.length;++e)r+=t[e]*i[e];return r},Et=function(t,i,r){var e=r.length,n=gt(i+2);t[n]=255&e,t[n+1]=e>>8,t[n+2]=255^t[n],t[n+3]=255^t[n+1];for(var s=0;s<e;++s)t[n+s+4]=r[s];return 8*(n+4+e)},Ot=function(t,i,r,e,n,s,a,o,h,u,c){mt(i,c++,r),++n[256];for(var f=bt(n,15),l=f.t,d=f.l,v=bt(s,15),p=v.t,g=v.l,_=St(l),m=_.c,w=_.n,b=St(p),y=b.c,S=b.n,x=new Z(19),E=0;E<m.length;++E)++x[31&m[E]];for(E=0;E<y.length;++E)++x[31&y[E]];for(var O=bt(x,7),T=O.t,k=O.l,M=19;M>4&&!T[et[M-1]];--M);var R,I,D,U,C=u+5<<3,j=xt(n,lt)+xt(s,dt)+a,N=xt(n,l)+xt(s,p)+a+14+3*M+xt(x,T)+2*x[16]+3*x[17]+7*x[18];if(h>=0&&C<=j&&C<=N)return Et(i,c,t.subarray(h,h+u));if(mt(i,c,1+(N<j)),c+=2,N<j){R=ft(l,d,0),I=l,D=ft(p,g,0),U=p;var P=ft(T,k,0);for(mt(i,c,w-257),mt(i,c+5,S-1),mt(i,c+10,M-4),c+=14,E=0;E<M;++E)mt(i,c+3*E,T[et[E]]);c+=3*M;for(var A=[m,y],B=0;B<2;++B){var z=A[B];for(E=0;E<z.length;++E)mt(i,c,P[F=31&z[E]]),c+=T[F],F>15&&(mt(i,c,z[E]>>5&127),c+=z[E]>>12)}}else R=vt,I=lt,D=pt,U=dt;for(E=0;E<o;++E){var q=e[E];if(q>255){var F;wt(i,c,R[257+(F=q>>18&31)]),c+=I[F+257],F>7&&(mt(i,c,q>>23&31),c+=it[F]);var W=31&q;wt(i,c,D[W]),c+=U[W],W>3&&(wt(i,c,q>>5&8191),c+=rt[W])}else wt(i,c,R[q]),c+=I[q]}return wt(i,c,R[256]),c+I[256]},Tt=new tt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kt=new Y(0),Mt=(function(){for(var t=new Int32Array(256),i=0;i<256;++i){for(var r=i,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[i]=r}return t})(),Rt=function(t,i,r){for(;r;++i)t[i]=r,r>>>=8},It="undefined"!=typeof TextEncoder&&new TextEncoder,Dt="undefined"!=typeof TextDecoder&&new TextDecoder;try{Dt.decode(kt,{stream:!0})}catch(t){}var Ut=!!c||!!u,Ct=(t,i)=>{var[e,n]=t.split("?"),s=r({},i);null==n||n.split("&").forEach((t=>{var[i]=t.split("=");delete s[i]}));var a=(function(t,i){var r;void 0===i&&(i="&");var e=[];return R(t,(function(t,i){b(t)||b(i)||"undefined"===i||(r=encodeURIComponent((t=>t instanceof File)(t)?t.name:""+t),e[e.length]=encodeURIComponent(i)+"="+r)})),e.join(i)})(s);return a=a?(n?n+"&":"")+a:n,"".concat(e,"?").concat(a)},jt=(t,i)=>JSON.stringify(t,((t,i)=>"bigint"==typeof i?""+i:i),i),Nt=t=>{var{data:i,compression:r}=t;if(i){if("gzip-js"===r){var e=(function(t,i){i||(i={});var r=(function(){var t=-1;return{p:function(i){for(var r=t,e=0;e<i.length;++e)r=Mt[255&r^i[e]]^r>>>8;t=r},d:function(){return~t}}})(),e=t.length;r.p(t);var n,s=(function(t,i,r,e,n){if(!n&&(n={l:1},i.dictionary)){var s=i.dictionary.subarray(-32768),a=new Y(s.length+t.length);a.set(s),a.set(t,s.length),t=a,n.w=s.length}return(function(t,i,r,e,n,s){var a=s.z||t.length,o=new Y(e+a+5*(1+Math.ceil(a/7e3))+8),h=o.subarray(e,o.length-8),u=s.l,c=7&(s.r||0);if(i){c&&(h[0]=s.r>>3);for(var f=Tt[i-1],l=f>>13,d=8191&f,v=(1<<r)-1,p=s.p||new Z(32768),g=s.h||new Z(v+1),_=Math.ceil(r/3),m=2*_,w=function(i){return(t[i]^t[i+1]<<_^t[i+2]<<m)&v},b=new tt(25e3),y=new Z(288),S=new Z(32),x=0,E=0,O=s.i||0,T=0,k=s.w||0,M=0;O+2<a;++O){var R=w(O),I=32767&O,D=g[R];if(p[I]=D,g[R]=I,k<=O){var U=a-O;if((x>7e3||T>24576)&&(U>423||!u)){c=Ot(t,h,0,b,y,S,E,T,M,O-M,c),T=x=E=0,M=O;for(var C=0;C<286;++C)y[C]=0;for(C=0;C<30;++C)S[C]=0}var j=2,N=0,P=d,A=I-D&32767;if(U>2&&R==w(O-A))for(var B=Math.min(l,U)-1,z=Math.min(32767,O),q=Math.min(258,U);A<=z&&--P&&I!=D;){if(t[O+j]==t[O+j-A]){for(var F=0;F<q&&t[O+F]==t[O+F-A];++F);if(F>j){if(j=F,N=A,F>B)break;var W=Math.min(A,F-2),L=0;for(C=0;C<W;++C){var J=O-A+C&32767,G=J-p[J]&32767;G>L&&(L=G,D=J)}}}A+=(I=D)-(D=p[I])&32767}if(N){b[T++]=268435456|at[j]<<18|ot[N];var K=31&at[j],V=31&ot[N];E+=it[K]+rt[V],++y[257+K],++S[V],k=O+j,++x}else b[T++]=t[O],++y[t[O]]}}for(O=Math.max(O,k);O<a;++O)b[T++]=t[O],++y[t[O]];c=Ot(t,h,u,b,y,S,E,T,M,O-M,c),u||(s.r=7&c|h[c/8|0]<<3,c-=7,s.h=g,s.p=p,s.i=O,s.w=k)}else{for(O=s.w||0;O<a+u;O+=65535){var X=O+65535;X>=a&&(h[c/8|0]=u,X=a),c=Et(h,c+1,t.subarray(O,X))}s.i=a}return _t(o,0,e+gt(c)+8)})(t,i.level??6,null==i.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+i.mem,r,0,n)})(t,i,10+((n=i).filename?n.filename.length+1:0)),a=s.length;return(function(t,i){var r=i.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=i.level<2?4:9==i.level?2:0,t[9]=3,0!=i.mtime&&Rt(t,4,Math.floor(new Date(i.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}})(s,i),Rt(s,a-8,r.d()),Rt(s,a-4,e),s})((function(t){if(It)return It.encode(t);for(var i=t.length,r=new Y(t.length+(t.length>>1)),e=0,n=function(t){r[e++]=t},s=0;s<i;++s){if(e+5>r.length){var a=new Y(e+8+(i-s<<1));a.set(r),r=a}var o=t.charCodeAt(s);o<128?n(o):o<2048?(n(192|o>>6),n(128|63&o)):o>55295&&o<57344?(n(240|(o=65536+(1047552&o)|1023&t.charCodeAt(++s))>>18),n(128|o>>12&63),n(128|o>>6&63),n(128|63&o)):(n(224|o>>12),n(128|o>>6&63),n(128|63&o))}return _t(r,0,e)})(jt(i)),{mtime:0}),n=new Blob([e],{type:Q});return{contentType:Q,body:n,estimatedSize:n.size}}if("base64"===r){var s=(function(t){var i,r,e,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,o=0,h="",u=[];if(!t)return t;t=(function(t){var i,r,e,n,s="";for(i=r=0,e=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,n=0;n<e;n++){var a=t.charCodeAt(n),o=null;a<128?r++:o=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),S(o)||(r>i&&(s+=t.substring(i,r)),s+=o,i=r=n+1)}return r>i&&(s+=t.substring(i,t.length)),s})(t);do{i=(n=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>12&63,r=n>>6&63,e=63&n,u[o++]=s.charAt(n>>18&63)+s.charAt(i)+s.charAt(r)+s.charAt(e)}while(a<t.length);switch(h=u.join(""),t.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h})(jt(i)),a=(t=>"data="+encodeURIComponent("string"==typeof t?t:jt(t)))(s);return{contentType:"application/x-www-form-urlencoded",body:a,estimatedSize:new Blob([a]).size}}var o=jt(i);return{contentType:"application/json",body:o,estimatedSize:new Blob([o]).size}}},Pt=[];u&&Pt.push({transport:"fetch",method:t=>{var i,e,{contentType:n,body:s,estimatedSize:a}=null!==(i=Nt(t))&&void 0!==i?i:{},o=new Headers;R(t.headers,(function(t,i){o.append(i,t)})),n&&o.append("Content-Type",n);var h=t.url,c=null;if(f){var l=new f;c={signal:l.signal,timeout:setTimeout((()=>l.abort()),t.timeout)}}u(h,r({method:(null==t?void 0:t.method)||"GET",headers:o,keepalive:"POST"===t.method&&(a||0)<52428.8,body:s,signal:null===(e=c)||void 0===e?void 0:e.signal},t.fetchOptions)).then((i=>i.text().then((r=>{var e,n={statusCode:i.status,text:r};if(200===i.status)try{n.json=JSON.parse(r)}catch(t){O.error(t)}null===(e=t.callback)||void 0===e||e.call(t,n)})))).catch((i=>{var r;O.error(i),null===(r=t.callback)||void 0===r||r.call(t,{statusCode:0,text:i})})).finally((()=>c?clearTimeout(c.timeout):null))}}),c&&Pt.push({transport:"XHR",method:t=>{var i,r=new c;r.open(t.method||"GET",t.url,!0);var{contentType:e,body:n}=null!==(i=Nt(t))&&void 0!==i?i:{};R(t.headers,(function(t,i){r.setRequestHeader(i,t)})),e&&r.setRequestHeader("Content-Type",e),t.timeout&&(r.timeout=t.timeout),r.withCredentials=!0,r.onreadystatechange=()=>{if(4===r.readyState){var i,e={statusCode:r.status,text:r.responseText};if(200===r.status)try{e.json=JSON.parse(r.responseText)}catch{}null===(i=t.callback)||void 0===i||i.call(t,e)}},r.send(n)}}),null!=a&&a.sendBeacon&&Pt.push({transport:"sendBeacon",method:t=>{var i=Ct(t.url,{beacon:"1"});try{var r,{contentType:e,body:n}=null!==(r=Nt(t))&&void 0!==r?r:{},s="string"==typeof n?new Blob([n],{type:e}):n;a.sendBeacon(i,s)}catch{}}});var At=T("[RateLimiter]");class Bt{constructor(t){var i,r;this.instance=t,this.serverLimits={},this.captureEventsPerSecond=(null===(i=t.config.rate_limiting)||void 0===i?void 0:i.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null===(r=t.config.rate_limiting)||void 0===r?void 0:r.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(t){var i;void 0===t&&(t=!1);var r=(new Date).getTime(),e=100;e.tokens+=(r-e.last)/1e3*this.captureEventsPerSecond,e.last=r,e.tokens>this.captureEventsBurstLimit&&(e.tokens=this.captureEventsBurstLimit);var n=e.tokens<1;return n||t||(e.tokens=Math.max(0,e.tokens-1)),!n||this.lastEventRateLimited||t||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"trustdata client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=n,null===(i=this.instance.persistence)||void 0===i||i.set_property(100,e),{isRateLimited:n,remainingTokens:e.tokens}}isServerRateLimited(t){var i=this.serverLimits[t||"events"]||!1;return!1!==i&&(new Date).getTime()<i}checkForLimiting=t=>{var i=t.text;if(i&&i.length)try{(JSON.parse(i).quota_limited||[]).forEach((t=>{this.serverLimits[t]=(new Date).getTime()+6e4}))}catch(t){return void At.warn('could not rate limit - continuing. Error: "'.concat(null==t?void 0:t.message,'"'),{text:i})}}}function zt(t,i,r,e,n){return x(t)?t>r?(O.warn(e+" cannot be greater than max: "+r+". Using max value instead."),r):t<i?(O.warn(e+" cannot be less than min: "+i+". Using min value instead."),i):t:(O.warn(e+" must be a number. using max or fallback. max: "+r+", fallback: "+n),zt(n||r,i,r,e))}class qt{constructor(t,i){this.u=!0,this.v=[],this.m=void 0,this.S=zt((null==i?void 0:i.flush_interval_ms)||N,250,5e3,"flush interval",N),this.O=t}enqueue(t){this.v.push(t),this.m||this.T()}unload(){this.k();var t=this.v.length>0?this.M():{},i=Object.values(t);[...i.filter((t=>0===t.url.indexOf("/e"))),...i.filter((t=>0!==t.url.indexOf("/e")))].map((t=>{this.O(r(r({},t),{},{transport:"sendBeacon"}))}))}enable(){this.u=!1,this.T()}T(){var t=this;this.u||(this.m=setTimeout((()=>{if(this.k(),this.v.length>0){var i=this.M(),r=function(){var r=i[e],n=(new Date).getTime();r.data&&m(r.data)&&R(r.data,(t=>{t.offset=Math.abs(t.timestamp-n),delete t.timestamp})),t.O(r)};for(var e in i)r()}}),this.S))}k(){clearTimeout(this.m),this.m=void 0}M(){var t={};return R(this.v,(i=>{var e,n=i,s=(n?n.batchKey:null)||n.url;b(t[s])&&(t[s]=r(r({},n),{},{data:[]})),null===(e=t[s].data)||void 0===e||e.push(n.data)})),this.v=[],t}}var Ft=["retriesPerformedSoFar"];class Wt{constructor(t){this.R=t,this.I=!1,this.D=void 0,this.U=3e3,this.v=[],this.C=!0,!b(e)&&"onLine"in e.navigator&&(this.C=e.navigator.onLine,C(e,"online",(()=>{this.C=!0,this.j()})),C(e,"offline",(()=>{this.C=!1})))}get length(){return this.v.length}retriableRequest(t){var{retriesPerformedSoFar:i}=t,e=(function(t,i){if(null==t)return{};var r,e,n=(function(t,i){if(null==t)return{};var r={};for(var e in t)if({}.hasOwnProperty.call(t,e)){if(-1!==i.indexOf(e))continue;r[e]=t[e]}return r})(t,i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(e=0;e<s.length;e++)-1===i.indexOf(r=s[e])&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n})(t,Ft);x(i)&&i>0&&(e.url=Ct(e.url,{retry_count:i})),this.R.N(r(r({},e),{},{callback:t=>{var n;200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=i?i:0)<10?this.P(r({retriesPerformedSoFar:i},e)):null===(n=e.callback)||void 0===n||n.call(e,t)}}))}P(t){var i=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=i+1;var r=(function(t){var i=3e3*2**t,r=i/2,e=Math.min(18e5,i),n=Math.random()-.5;return Math.ceil(e+n*(e-r))})(i),e=Date.now()+r;this.v.push({retryAt:e,requestOptions:t});var n="Enqueued failed request for retry in ".concat(r);navigator.onLine||(n+=" (Browser is offline)"),O.warn(n),this.I||(this.I=!0,this.A())}A(){this.D&&clearTimeout(this.D),this.D=setTimeout((()=>{this.C&&this.v.length>0&&this.j(),this.A()}),this.U)}j(){var t=Date.now(),i=[],r=this.v.filter((r=>r.retryAt<t||(i.push(r),!1)));if(this.v=i,r.length>0)for(var{requestOptions:e}of r)this.retriableRequest(e)}unload(){for(var{requestOptions:t}of(this.D&&(clearTimeout(this.D),this.D=void 0),this.v))try{this.R.N(r(r({},t),{},{transport:"sendBeacon"}))}catch(t){O.error(t)}this.v=[]}}Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return x(t)&&isFinite(t)&&Math.floor(t)===t});var Lt="0123456789abcdef";class Jt{constructor(t){if(this.bytes=t,16!==t.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(t,i,r,e){if(!Number.isInteger(t)||!Number.isInteger(i)||!Number.isInteger(r)||!Number.isInteger(e)||t<0||i<0||r<0||e<0||t>0xffffffffffff||i>4095||r>1073741823||e>4294967295)throw new RangeError("invalid field value");var n=new Uint8Array(16);return n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/65536,n[4]=t/256,n[5]=t,n[6]=112|i>>>8,n[7]=i,n[8]=128|r>>>24,n[9]=r>>>16,n[10]=r>>>8,n[11]=r,n[12]=e>>>24,n[13]=e>>>16,n[14]=e>>>8,n[15]=e,new Jt(n)}toString(){for(var t="",i=0;i<this.bytes.length;i++)t=t+Lt.charAt(this.bytes[i]>>>4)+Lt.charAt(15&this.bytes[i]),3!==i&&5!==i&&7!==i&&9!==i||(t+="-");if(36!==t.length)throw Error("Invalid UUIDv7 was generated");return t}clone(){return new Jt(this.bytes.slice(0))}equals(t){return 0===this.compareTo(t)}compareTo(t){for(var i=0;i<16;i++){var r=this.bytes[i]-t.bytes[i];if(0!==r)return Math.sign(r)}return 0}}class Gt{constructor(){this.B=0,this.q=0,this.F=new Xt}generate(){var t=this.generateOrAbort();if(b(t)){this.B=0;var i=this.generateOrAbort();if(b(i))throw Error("Could not generate UUID after timestamp reset");return i}return t}generateOrAbort(){var t=Date.now();if(t>this.B)this.B=t,this.W();else{if(!(t+1e4>this.B))return;this.q++,this.q>4398046511103&&(this.B++,this.W())}return Jt.fromFieldsV7(this.B,Math.trunc(this.q/2**30),this.q&2**30-1,this.F.nextUint32())}W(){this.q=1024*this.F.nextUint32()+(1023&this.F.nextUint32())}}var Kt,Vt=t=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var i=0;i<t.length;i++)t[i]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};e&&!b(e.crypto)&&crypto.getRandomValues&&(Vt=t=>crypto.getRandomValues(t));class Xt{constructor(){this.L=new Uint32Array(8),this.J=1/0}nextUint32(){return this.J>=this.L.length&&(Vt(this.L),this.J=0),this.L[this.J++]}}var $t=()=>""+Ht(),Ht=()=>(Kt||(Kt=new Gt)).generate(),Qt="",Yt=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,Zt={is_supported:()=>!!o,error:function(t){O.error("cookieStore error: "+t)},get:function(t){if(o){try{for(var i=t+"=",r=o.cookie.split(";").filter((t=>t.length)),e=0;e<r.length;e++){for(var n=r[e];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i))return decodeURIComponent(n.substring(i.length,n.length))}}catch{}return null}},parse:function(t){var i;try{i=JSON.parse(Zt.get(t))||{}}catch{}return i},set:function(t,i,r,e,n){if(o)try{var s="",a="",h=(function(t,i){if(i){var r=(function(t,i){if(void 0===i&&(i=o),Qt)return Qt;if(!i)return"";if(["localhost","127.0.0.1"].includes(t))return"";for(var r=t.split("."),e=Math.min(r.length,8),n="dmn_chk_"+$t(),s=RegExp("(^|;)\\s*"+n+"=1");!Qt&&e--;){var a=r.slice(e).join("."),h=n+"=1;domain=."+a;i.cookie=h,s.test(i.cookie)&&(i.cookie=h+";expires=Thu, 01 Jan 1970 00:00:00 GMT",Qt=a)}return Qt})(t);if(!r){var e=(t=>{var i=t.match(Yt);return i?i[0]:""})(t);r=e}return r?"; domain=."+r:""}return""})(o.location.hostname,e);if(r){var u=new Date;u.setTime(u.getTime()+24*r*60*60*1e3),s="; expires="+u.toUTCString()}n&&(a="; secure");var c=t+"="+encodeURIComponent(JSON.stringify(i))+s+"; SameSite=Lax; path=/"+h+a;return c.length>3686.4&&O.warn("cookieStore warning: large cookie, len="+c.length),o.cookie=c,c}catch{return}},remove:function(t,i){try{Zt.set(t,"",-1,i)}catch{return}}},ti=null,ii={is_supported:function(){if(!S(ti))return ti;var t=!0;if(b(e))t=!1;else try{var i="__mplssupport__";ii.set(i,"xyz"),'"xyz"'!==ii.get(i)&&(t=!1),ii.remove(i)}catch{t=!1}return t||O.error("localStorage unsupported; falling back to cookie store"),ti=t,t},error:function(t){O.error("localStorage error: "+t)},get:function(t){try{return e&&e.localStorage.getItem(t)}catch(t){ii.error(t)}return null},parse:function(t){try{return JSON.parse(ii.get(t))||{}}catch{}return null},set:function(t,i){try{e&&e.localStorage.setItem(t,JSON.stringify(i))}catch(t){ii.error(t)}},remove:function(t){try{e&&e.localStorage.removeItem(t)}catch(t){ii.error(t)}}},ri=["cid","uid","udata","sid","sn","last","start","wid","primary_window","fv"],ei=r(r({},ii),{},{parse:function(t){try{var i={};try{i=Zt.parse(t)||{}}catch{}var r=I(i,JSON.parse(ii.get(t)||"{}"));return ii.set(t,r),r}catch{}return null},set:function(t,i,r,e,n,s){try{ii.set(t,i,void 0,void 0,s);var a={};ri.forEach((t=>{i[t]&&(a[t]=i[t])})),Object.keys(a).length&&Zt.set(t,a,r,e,n,s)}catch(t){ii.error(t)}},remove:function(t,i){try{e&&e.localStorage.removeItem(t),Zt.remove(t,i)}catch(t){ii.error(t)}}});function ni(t,i){return-1!==t.indexOf(i)}var si="Mobile",ai="iOS",oi="Android",hi="Tablet",ui=oi+" "+hi,ci="iPad",fi="Apple",li=fi+" Watch",di="Safari",vi="BlackBerry",pi="Samsung",gi=pi+"Browser",_i=pi+" Internet",mi="Chrome",wi=mi+" OS",bi=mi+" "+ai,yi="Internet Explorer",Si=yi+" "+si,xi="Opera",Ei=xi+" Mini",Oi="Edge",Ti="Microsoft "+Oi,ki="Firefox",Mi=ki+" "+ai,Ri="Nintendo",Ii="PlayStation",Di="Xbox",Ui=oi+" "+si,Ci=si+" "+di,ji="Windows",Ni=ji+" Phone",Pi="Nokia",Ai="Ouya",Bi="Generic",zi=Bi+" mobile",qi=Bi+" tablet",Fi="Konqueror",Wi="(\\d+(\\.\\d+)?)",Li=RegExp("Version/"+Wi),Ji=RegExp(Di,"i"),Gi=RegExp(Ii+" \\w+","i"),Ki=RegExp(Ri+" \\w+","i"),Vi=RegExp(vi+"|PlayBook|BB10","i"),Xi={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},$i=function(t,i){return i=i||"",ni(t," OPR/")&&ni(t,"Mini")?Ei:ni(t," OPR/")?xi:Vi.test(t)?vi:ni(t,"IE"+si)||ni(t,"WPDesktop")?Si:ni(t,gi)?_i:ni(t,Oi)||ni(t,"Edg/")?Ti:ni(t,"FBIOS")?"Facebook "+si:ni(t,"UCWEB")||ni(t,"UCBrowser")?"UC Browser":ni(t,"CriOS")?bi:ni(t,"CrMo")||ni(t,mi)?mi:ni(t,oi)&&ni(t,di)?Ui:ni(t,"FxiOS")?Mi:ni(t.toLowerCase(),"konqueror")?Fi:((t,i)=>i&&ni(i,fi)||(function(t){return ni(t,di)&&!ni(t,mi)&&!ni(t,oi)})(t))(t,i)?ni(t,si)?Ci:di:ni(t,ki)?ki:ni(t,"MSIE")||ni(t,"Trident/")?yi:ni(t,"Gecko")?ki:""},Hi={[Si]:[RegExp("rv:"+Wi)],[Ti]:[RegExp(Oi+"?\\/"+Wi)],[mi]:[RegExp("("+mi+"|CrMo)\\/"+Wi)],[bi]:[RegExp("CriOS\\/"+Wi)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+Wi)],[di]:[Li],[Ci]:[Li],[xi]:[RegExp("(Opera|OPR)\\/"+Wi)],[ki]:[RegExp(ki+"\\/"+Wi)],[Mi]:[RegExp("FxiOS\\/"+Wi)],[Fi]:[RegExp("Konqueror[:/]?"+Wi,"i")],[vi]:[RegExp(vi+" "+Wi),Li],[Ui]:[RegExp("android\\s"+Wi,"i")],[_i]:[RegExp(gi+"\\/"+Wi)],[yi]:[RegExp("(rv:|MSIE )"+Wi)],Mozilla:[RegExp("rv:"+Wi)]},Qi=function(t,i){var r=$i(t,i),e=Hi[r];if(b(e))return null;for(var n=0;n<e.length;n++){var s=t.match(e[n]);if(s)return parseFloat(s[s.length-2])}return null},Yi=[[RegExp(Di+"; "+Di+" (.*?)[);]","i"),t=>[Di,t&&t[1]||""]],[RegExp(Ri,"i"),[Ri,""]],[RegExp(Ii,"i"),[Ii,""]],[Vi,[vi,""]],[RegExp(ji,"i"),(t,i)=>{if(/Phone/.test(i)||/WPDesktop/.test(i))return[Ni,""];if(RegExp(si).test(i)&&!/IEMobile\b/.test(i))return[ji+" "+si,""];var r=/Windows NT ([0-9.]+)/i.exec(i);if(r&&r[1]){var e=Xi[r[1]]||"";return/arm/i.test(i)&&(e="RT"),[ji,e]}return[ji,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>t&&t[3]?[ai,[t[3],t[4],t[5]||"0"].join(".")]:[ai,""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var i="";return t&&t.length>=3&&(i=b(t[2])?t[3]:t[2]),["watchOS",i]}],[RegExp("("+oi+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+oi+")","i"),t=>t&&t[2]?[oi,[t[2],t[3],t[4]||"0"].join(".")]:[oi,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var i=["Mac OS X",""];return t&&t[1]&&(i[1]=[t[1],t[2],t[3]||"0"].join(".")),i}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[wi,""]],[/Linux|debian/i,["Linux",""]]],Zi=function(t){return Ki.test(t)?Ri:Gi.test(t)?Ii:Ji.test(t)?Di:RegExp(Ai,"i").test(t)?Ai:RegExp("("+Ni+"|WPDesktop)","i").test(t)?Ni:/iPad/.test(t)?ci:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?li:Vi.test(t)?vi:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":RegExp(Pi,"i").test(t)?Pi:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!RegExp(si).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?oi:ui:oi:RegExp("(pda|"+si+")","i").test(t)?zi:RegExp(hi,"i").test(t)&&!RegExp(hi+" pc","i").test(t)?qi:""},tr="<masked>";function ir(){return navigator.language||navigator.userLanguage}function rr(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function er(){try{return(new Date).getTimezoneOffset()}catch{return}}class nr{constructor(t){this.R=t,this.G=void 0}get _config(){return this.R.config}get consent(){return this.K()?0:this.V}isOptedOut(){return 0===this.consent||-1===this.consent&&this._config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(t){this.X.set(this.$,t?1:0,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie)}reset(){this.X.remove(this.$,this._config.cross_subdomain_cookie)}get $(){var{token:t,opt_out_capturing_cookie_prefix:i}=this.R.config;return(i||"__ph_opt_in_out_")+t}get V(){var t=this.X.get(this.$);return"1"===t?1:"0"===t?0:-1}get X(){if(!this.G){var t=this._config.opt_out_capturing_persistence_type;this.G="localStorage"===t?ii:Zt;var i="localStorage"===t?Zt:ii;i.get(this.$)&&(this.G.get(this.$)||this.optInOut("1"===i.get(this.$)),i.remove(this.$,this._config.cross_subdomain_cookie))}return this.G}K(){return!!this._config.respect_dnt&&!!U([null==a?void 0:a.doNotTrack,null==a?void 0:a.msDoNotTrack,d.doNotTrack],(t=>ni([!0,1,"1","yes"],t)))}}class sr{constructor(t){this.instance=t,this.DEFAULT_SESSION_TIMEOUT_MINUTES=30,this.MIN_SESSION_TIMEOUT_MINUTES=1,this.MAX_SESSION_TIMEOUT_MINUTES=600,this.SESSION_MAX_LENGTH_MS=864e5,this.SESSION_ID_KEY="_trdt_sid",this.SESSION_NUMBER_KEY="_trdt_sn",this.LAST_ACTIVITY_KEY="_trdt_last",this.SESSION_START_KEY="_trdt_start",this.WINDOW_ID_KEY="_trdt_wid",this.PRIMARY_WINDOW_KEY="_trdt_primary_window",this.windowId=null,this.sessionChangeHandlers=[],this.sessionTimer=null,this.H()}Y(){return 60*Math.min(Math.max(this.instance.CONFIG.sessionTimeout||this.DEFAULT_SESSION_TIMEOUT_MINUTES,this.MIN_SESSION_TIMEOUT_MINUTES),this.MAX_SESSION_TIMEOUT_MINUTES)*1e3}Z(){return Date.now()+"-"+Math.random().toString(36).substring(2,10)}tt(){return this.instance.consent.isOptedIn()&&!this.instance.CONFIG.disable_persistence}it(){if(this.windowId)return this.windowId;if(this.tt())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY);if(t)return t}catch(t){}return null}rt(t){if(this.windowId=t,this.tt())try{sessionStorage.setItem(this.WINDOW_ID_KEY,t)}catch(t){}}H(){if(this.tt())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY),i=sessionStorage.getItem(this.PRIMARY_WINDOW_KEY);t&&!i?this.windowId=t:sessionStorage.removeItem(this.WINDOW_ID_KEY),sessionStorage.setItem(this.PRIMARY_WINDOW_KEY,"true"),window.addEventListener("beforeunload",(()=>{sessionStorage.removeItem(this.PRIMARY_WINDOW_KEY)}))}catch(t){}}onSessionChange(t){return this.sessionChangeHandlers.push(t),()=>{this.sessionChangeHandlers=this.sessionChangeHandlers.filter((i=>i!==t))}}et(t,i,r){this.sessionChangeHandlers.forEach((e=>{try{e(t,i,r)}catch(t){}}))}initSession(t){void 0===t&&(t=!1);var i=(new Date).getTime(),r=this.tt(),e=this.Y(),n=null,s=0,a=0,o=1,h=this.it();if(r)try{n=Zt.get(this.SESSION_ID_KEY),a=parseInt(Zt.get(this.LAST_ACTIVITY_KEY)||"0"),s=parseInt(ii.get(this.SESSION_START_KEY)||"0"),o=parseInt(ii.get(this.SESSION_NUMBER_KEY)||"1")}catch(t){}var u=!n,c=!t&&i-a>e,f=s>0&&i-s>this.SESSION_MAX_LENGTH_MS,l=!1,d={};if(u||c||f){if(n=this.Z(),h||(h=this.Z()),s=i,this.instance.STATE.isFirstVisit||o++,this.instance.STATE.sessionId=n,this.instance.STATE.sessionNumber=o,this.instance.STATE.sessionEngaged=!1,this.instance.STATE.isNewVisit=!0,l=!0,d={noSession:u,activityTimeout:c,sessionTooLong:f},r)try{ii.set(this.SESSION_NUMBER_KEY,""+o),ii.set(this.SESSION_START_KEY,""+s),Zt.set(this.SESSION_ID_KEY,n,0,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}catch(t){}}else h||(h=this.Z(),this.rt(h)),this.instance.STATE.sessionId=n,this.instance.STATE.sessionNumber=o,this.instance.STATE.sessionEngaged=!0,this.instance.STATE.isNewVisit=!1;if(!t){if(a=i,r)try{Zt.set(this.LAST_ACTIVITY_KEY,""+a,0,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}catch(t){}this.refreshSessionTimer()}return this.rt(h),l&&this.et(n,h,d),{sessionId:this.instance.STATE.sessionId,windowId:h,sessionStart:s,lastActivity:a,sessionNumber:this.instance.STATE.sessionNumber,isNewVisit:this.instance.STATE.isNewVisit}}refreshSessionTimer(){clearTimeout(this.sessionTimer),this.sessionTimer=setTimeout((()=>{this.resetSession()}),1.1*this.Y())}resetSession(){if(this.tt())try{Zt.remove(this.SESSION_ID_KEY,this.instance.CONFIG.cross_subdomain_cookie),Zt.remove(this.LAST_ACTIVITY_KEY,this.instance.CONFIG.cross_subdomain_cookie)}catch(t){}this.initSession()}getSessionId(){return this.instance.STATE.sessionId}getWindowId(){return this.it()}}class ar{constructor(t){this.instance=t,this.clientId=null,this.isFirstVisit=!1}initClientId(t){void 0===t&&(t={});var i=this.tt(),r=this.instance.CONFIG.persistence_name||"_trdt",e=t.client_id||i&&this.instance.persistence.get(r+"_cid"),n=i&&this.instance.persistence.get(r+"_fv");return e?(this.clientId=e,this.isFirstVisit=!n):(this.clientId=this.Z(),this.isFirstVisit=!0,i&&(this.nt(this.clientId),this.st())),this.instance.STATE.clientId=this.clientId,this.instance.STATE.isFirstVisit=this.isFirstVisit,this.clientId}Z(){return this.instance.CONFIG.get_device_id?this.instance.CONFIG.get_device_id($t()):$t()}nt(t){this.tt()&&this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_cid",t,this.instance.CONFIG.cookie_expiration,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}st(){if(this.tt()&&this.isFirstVisit){var t=this.instance.CONFIG.persistence_name||"_trdt",i=this.instance.CONFIG.cookie_expiration,r=this.instance.CONFIG.cross_subdomain_cookie,e=this.instance.CONFIG.secure_cookie,n=""+Date.now();this.instance.persistence.set(t+"_fv",n,i,r,e)}}setClientId(t){return!!t&&(this.clientId=t,this.instance.STATE.clientId=t,this.tt()&&this.nt(t),!0)}getClientId(){return this.clientId}tt(){return this.instance.consent.isOptedIn()&&!this.instance.CONFIG.disable_persistence}}class or{constructor(t){this.instance=t,this.userId=null,this.userData={},this.identifiers={}}initUser(t){void 0===t&&(t={});var i=this.tt(),r=this.instance.CONFIG.persistence_name||"_trdt";if(this.userId=t.user_id||i&&this.instance.persistence.get(r+"_uid"),i)try{var e=this.instance.persistence.get(r+"_udata");e&&(this.userData=JSON.parse(e))}catch(t){O.error("Error parsing stored user data",t),this.userData={}}return this.instance.STATE.userId=this.userId,this.userData}setUserId(t){return!!t&&(this.userId=t,this.instance.STATE.userId=t,this.tt()&&this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_uid",t,this.instance.CONFIG.cookie_expiration,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie),!0)}setUserData(t){if(!(t=>t===Object(t)&&!m(t))(t))return!1;if(this.userData=r(r({},this.userData),t),this.tt()){var i=this.instance.CONFIG.cookie_expiration,e=this.instance.CONFIG.cross_subdomain_cookie,n=this.instance.CONFIG.secure_cookie;this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_udata",JSON.stringify(this.userData),i,e,n)}return!0}setIdentifier(t,i){return!(!y(t)||!y(i)||(this.identifiers[t]=i,0))}getUserData(){return r(r({},this.userData),this.identifiers)}getUserId(){return this.userId}tt(){return this.instance.consent.isOptedIn()&&!this.instance.CONFIG.disable_persistence}}var hr=()=>{},ur="__default";!Ut&&-1===(null==l?void 0:l.indexOf("MSIE"))&&(null==l||l.indexOf("Mozilla"));var cr=()=>{var t;return{api_host:"https://t.trstdata.com",api_endpoint:"/api/events",attribution_ids:[],ignore_referrer_domains:[],cross_subdomain_cookie:!0,persistence:"localStorage+cookie",persistence_name:"_trdt",debug:!1,loaded:hr,cookie_expiration:365,disable_persistence:!1,disable_compression:!1,secure_cookie:e&&"https:"===(null===(t=e.location)||void 0===t?void 0:t.protocol),request_batching:!0,properties_string_max_length:65535,session_timeout:30,on_request_error:t=>{O.error("Bad HTTP status: "+t.statusCode+" "+t.text)},send_page_view:!0,onCapture:hr,flush_interval_ms:N}};class fr{__loaded=!1;CONFIG=cr();analyticsDefaultEndpoint="/api/events";constructor(){this.STATE={clientId:null,userId:null,sessionId:null,sessionNumber:0,sessionEngaged:!1,isNewVisit:!1,isFirstVisit:!1,ignoreReferrer:!1,consentStatus:{analytics:!1,advertising:!1,personalization:!1},persistentParameters:{},initializedTargets:new Set},this.consent=new nr(this),this.logger=T("[TrustData.js]")}config(t,i,r){var e;if(void 0===i&&(i={}),void 0===r&&(r=null),!r||r===ur)return this._config(t,i,r);var n=null!==(e=vr[r])&&void 0!==e?e:new fr;return n._config(t,i,r),vr[r]=n,vr[ur][r]=n,n}_config(t,i,e){if(void 0===i&&(i={}),void 0===e&&(e=null),!t)return O.critical("TrustData was initialized without a target ID. This likely indicates a misconfiguration."),this;if(this.__loaded)return O.warn("You have already initialized TrustData! Re-initializing is a no-op"),this;var n=r(r(r({},cr()),i),{},{name:e,attribution_ids:[t]});return this.set_config(n),this.ot(i),this.ht(),this._processQueuedCommands(),this.__loaded=!0,"function"==typeof this.CONFIG.loaded&&this.CONFIG.loaded(this),this}set_config(t){Object.keys(t).forEach((i=>{i in this.CONFIG&&(this.CONFIG[i]=t[i])})),t.consent&&this.consent("update",{consent:t.consent})}ot(t){this.ut(),this.rateLimiter=new Bt(this),this._requestQueue=new qt((t=>this.ct(t)),{flush_interval_ms:this.CONFIG.flush_interval_ms}),this._retryQueue=new Wt(this),this.sessionManager=new sr(this),this.clientManager=new ar(this),this.userManager=new or(this),this.clientManager.initClientId(t),this.userManager.initUser(t),this.consent.isOptedIn()&&this.CONFIG.request_batching&&this._requestQueue.enable(),!1!==this.CONFIG.send_page_view&&setTimeout((()=>this.event(P)),0)}_processQueuedCommands(){if(e.ft&&e.ft.length){var t=e.ft.slice();e.ft.length=0;for(var i=0;i<t.length;i++){var r=t[i];if(Array.isArray(r)&&0!==r.length)try{var n=r[0],s=r.slice(1);if("config"===n&&this.STATE.pendingConfig){this._config(this.STATE.pendingConfig.targetId,this.STATE.pendingConfig.options);continue}"function"==typeof this[n]?this[n].apply(this,s):O.warn("Unknown command:",n)}catch(t){O.error("Error processing command:",t)}}}}ut(){var t=this.CONFIG;this.persistence="localStorage"===t.persistence?ii:"cookie"===t.persistence?Zt:ei,this.sessionPersistence="sessionStorage"===this.CONFIG.persistence?this.persistence:r(r({},this.persistence),{},{persistence:"sessionStorage"}),this.persistence_name=t.persistence_name||"_trdt"}ht(){var t="onpagehide"in self?"pagehide":"unload";e.addEventListener(t,this.lt.bind(this),{passive:!1})}lt(){this.CONFIG.request_batching?(this.event(A),this._requestQueue.unload(),this._retryQueue.unload()):this.event(A,null,{transport:"sendBeacon"})}set(t,i){if(!this.__loaded)return this.push(["set",t,i]);if("object"==typeof t)return Object.entries(t).forEach((t=>{var[i,r]=t;return this.set(i,r)})),!0;if("function"==typeof i)try{i=i()}catch(t){return O.error("Error processing function value:",t),!1}switch("string"==typeof i&&(i=i.substring(0,100)),t){case"user_id":this.STATE.userId=i,this.userManager.setUserId(i);break;case"client_id":this.clientManager.setClientId(i);break;case"debug_mode":this.CONFIG.debug=!0===i||"true"===i;break;case"page_referrer":case"page_location":case"page_title":case"ignore_referrer":this.STATE.persistentParameters[t]=i,"ignore_referrer"===t&&(this.STATE.ignoreReferrer=!0===i||"true"===i);break;case"user_data":"object"==typeof i&&this.userManager.setUserData(i);break;case"email_hash":case"phone_hash":this.userManager.setIdentifier(t,i);break;default:this.STATE.persistentParameters[t]=i}return!0}event(t,i,e){if(void 0===i&&(i={}),void 0===e&&(e={}),!t)return O.error("Missing event name"),!1;if(!this.__loaded)return this.push(["event",t,i,e]);this.STATE.sessionEngaged=!0,i&&i.hasOwnProperty("ignore_referrer")&&(this.STATE.ignoreReferrer=!0===i.ignore_referrer,delete i.ignore_referrer),i&&["page_referrer","page_location","page_title"].forEach((t=>{i.hasOwnProperty(t)&&(this.STATE.persistentParameters[t]=i[t])}));var n=this.CONFIG.attribution_ids;i&&i.send_to&&(n=Array.isArray(i.send_to)?i.send_to:[i.send_to],delete i.send_to);var s=n.filter((t=>this.STATE.initializedTargets.has(t)));0===s.length&&this.CONFIG.attribution_ids.length>0&&(s=[this.CONFIG.attribution_ids[0]]);var a=this.STATE.isFirstVisit,o=this.STATE.isNewVisit,h=this.dt(t,i);return s.forEach((t=>{var i=r(r({},h),{},{attribution_id:t}),n={method:"POST",url:this.CONFIG.api_host+this.CONFIG.api_endpoint,data:i,compression:this.CONFIG.disable_compression?void 0:"gzip-js",batchKey:t};e&&e.transport&&(n.transport=e.transport),this.CONFIG.request_batching&&!e.send_instantly?this._requestQueue.enqueue(n):this.ct(n)})),a&&(this.STATE.isFirstVisit=!1),o&&(this.STATE.isNewVisit=!1),this.sessionManager&&this.sessionManager.refreshSessionTimer(),!0}dt(t,i){var n,s,a;void 0===i&&(i={});var u=r(r({},i),{},{[B]:t}),c={[z]:this.STATE.clientId,[q]:null===(n=this.sessionManager)||void 0===n?void 0:n.getSessionId(),[G]:this.STATE.sessionNumber,[K]:this.STATE.sessionEngaged?1:0,[J]:Math.floor(Date.now()/1e3)};Object.entries(c).forEach((t=>{var[i,r]=t;u.hasOwnProperty(i)||(u[i]=r)}));var f=(function(){if(!l)return{};var t,i,r,[n,s]=(function(t){for(var i=0;i<Yi.length;i++){var[r,e]=Yi[i],n=r.exec(t),s=n&&(w(e)?e(n,t):e);if(s)return s}return["",""]})(l);return I({lib:"web",lib_version:v,event_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),event_time:Date.now()/1e3,page_location:j(null==h?void 0:h.href,[],tr),page_hostname:null==h?void 0:h.host,page_path:null==h?void 0:h.pathname,os_name:n,os_version:s,browser:$i(l,navigator.vendor),device:Zi(l),device_type:(i=l,r=Zi(i),r===ci||r===ui||"Kobo"===r||"Kindle Fire"===r||r===qi?hi:r===Ri||r===Di||r===Ii||r===Ai?"Console":r===li?"Wearable":r?si:"Desktop"),timezone:rr(),timezone_offset:er(),raw_user_agent:l.length>1e3?l.substring(0,997)+"...":l,browser_version:Qi(l,navigator.vendor),browser_language:ir(),browser_language_prefix:(t=ir(),"string"==typeof t?t.split("-")[0]:void 0),screen_resolution:e&&e.screen.width+"x"+e&&e.screen.height,viewport_resolution:e&&e.innerWidth+"x"+e&&e.innerHeight})})();Object.entries(f).forEach((t=>{var[i,r]=t;u[i]||(u[i]=r)}));var d,p={referrer:o&&o.referrer||"$direct",referring_domain:!o&&o.referrer?"$direct":(null===(d=(t=>{var i=o&&o.createElement("a");return b(i)?null:(i.href=t,i)})(o.referrer))||void 0===d?void 0:d.host)||"$direct"};Object.entries(p).forEach((t=>{var[i,r]=t;u[i]||(u[i]=r)}));var g,_,y,S=o?(g=j(o.URL,[],tr),_=H.concat([]),y={},R(_,(function(t){var i=(function(t,i){for(var r,e=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),n=0;n<e.length;n++){var s=e[n].split("=");if(s[0]===i){r=s;break}}if(!m(r)||r.length<2)return"";var a=r[1];try{a=decodeURIComponent(a)}catch{O.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")})(g,t);y[t]=i||null})),y):{};Object.entries(S).forEach((t=>{var[i,r]=t;r&&!u[i]&&(u[i]=r)})),this.STATE.userId&&(u.user_id=this.STATE.userId);var x=null===(s=this.userManager)||void 0===s?void 0:s.getUserData();x&&Object.keys(x).length>0&&Object.entries(x).forEach((t=>{var[i,r]=t;u[i]||(u[i]=r)})),this.STATE.isNewVisit&&!u[X]&&(u[X]=1),this.STATE.isFirstVisit&&!u[V]&&(u[V]=1);var E=o&&(null===(a=o.location)||void 0===a?void 0:a.href),T=o&&o.referrer,k=this.STATE.ignoreReferrer;if(T)try{var M=new URL(T).hostname;this.CONFIG.ignore_referrer_domains.includes(M)&&(k=!0)}catch(t){}if(this.STATE.persistentParameters.page_referrer){var D=this.vt(this.STATE.persistentParameters.page_referrer),U=this.vt(E);U&&D&&U===D&&(k=!0)}return k&&!u[$]&&(u[$]=!0),k||!T||this.STATE.persistentParameters.page_referrer||u[L]||(u[L]=T),this.STATE.persistentParameters.page_referrer||this.STATE.persistentParameters.page_location||this.STATE.persistentParameters.page_title||u[L]||u[W]||u[F]||o&&(u[W]||(u[W]=o.location.href),u[F]||(u[F]=o.title)),Object.entries(this.STATE.persistentParameters).forEach((t=>{var[i,r]=t;u[i]||(u[i]=r)})),u.consent_analytics||(u.consent_analytics=this.STATE.consentStatus.analytics),u.consent_advertising||(u.consent_advertising=this.STATE.consentStatus.advertising),u.consent_personalization||(u.consent_personalization=this.STATE.consentStatus.personalization),u}vt(t){try{return new URL(t||"").hostname}catch(t){return""}}ct(t){this._retryQueue?this._retryQueue.retriableRequest(t):this.N(t)}N(t){if(this.__loaded){if(t.headers=t.headers||{},"sendBeacon"===t.transport&&a&&a.sendBeacon)try{if(a.sendBeacon(t.url,new Blob([JSON.stringify(t.data)],{type:"text/plain"})))return;O.warn("sendBeacon failed, falling back to regular request")}catch(t){O.error("Error in sendBeacon, falling back to regular request:",t)}(t=>{var i,e,n,s=r({},t);s.timeout=s.timeout||6e4,s.url=Ct(s.url,{_:""+(new Date).getTime(),ver:v,compression:s.compression});var a=null!==(i=s.transport)&&void 0!==i?i:"fetch",o=null!==(e=null===(n=U(Pt,(t=>t.transport===a)))||void 0===n?void 0:n.method)&&void 0!==e?e:Pt[0].method;if(!o)throw Error("No available transport method");o(s)})(r(r({},t),{},{callback:i=>{var r,e,n;i.statusCode>=400&&(O.error("Request error:",i.statusCode,i.text),null===(e=(n=this.CONFIG).on_request_error)||void 0===e||e.call(n,i)),null===(r=t.callback)||void 0===r||r.call(t,i)}}))}else O.warn("TrustData not initialized, cannot send request")}consent(t,i){if(!this.__loaded)return this.push(["consent",t,i]);if(!i||!i.hasOwnProperty("consent"))return O.error("Invalid consent parameters"),!1;var r=i.consent;return"analytics"in r&&(this.STATE.consentStatus.analytics=!0===r.analytics||"granted"===r.analytics),"advertising"in r&&(this.STATE.consentStatus.advertising=!0===r.advertising||"granted"===r.advertising),"personalization"in r&&(this.STATE.consentStatus.personalization=!0===r.personalization||"granted"===r.personalization),this.consent instanceof nr&&(this.consent.optInOut(this.STATE.consentStatus.analytics),this.STATE.consentStatus.analytics&&this.CONFIG.request_batching&&this._requestQueue.enable()),!0}get(t,i,e){var n,s,a;if("string"==typeof t&&"function"==typeof i&&(e=i,i=t,t=null),!this.__loaded)return this.push(["get",t,i,e]);switch(i){case"client_id":a=this.STATE.clientId;break;case"user_id":a=this.STATE.userId;break;case"session_id":a=null===(n=this.sessionManager)||void 0===n?void 0:n.getSessionId();break;case"user_data":a=(null===(s=this.userManager)||void 0===s?void 0:s.getUserData())||{};break;case"consent_status":a=r({},this.STATE.consentStatus);break;case"debug_mode":a=this.CONFIG.debug;break;default:a=this.STATE.persistentParameters[i]}return"function"==typeof e&&e(a),a}push(t){if(e.ft||(e.ft=[]),e.ft.push(t),this.__loaded&&t&&t.length>0&&Array.isArray(t)&&t.length>0){var i=t[0],r=t.slice(1);if("function"==typeof this[i])try{return this[i].apply(this,r)}catch(t){O.error("Error processing command:",t)}else O.warn("Unknown command:",i)}return!0}}e.gt=e.gt||{},e.ft=e.ft||[],e._t=!1;var lr,dr,vr={};!(function(t,i){for(var r=0;r<5;r++)t.prototype[i[r]]=D(t.prototype[i[r]])})(fr,["event","set","get","consent","push"]),fr.prototype.wt=function(){this.CONFIG.send_page_view&&this.__loaded&&this.event(P)},lr=vr[ur]=new fr,(dr=e.trustdata)&&dr.bt&&m(dr.bt)&&R(dr.bt,(function(t){if(t&&m(t)){var i=t[2]||ur,r=lr.config(t[0],t[1]||{},i);r&&(function(t,i){i&&m(i)&&R(i,(function(i){if(m(i)){var r=i[0],e=i.slice(1);try{"function"==typeof t[r]?t[r].apply(t,e):O.warn("Unknown command: ".concat(r))}catch(t){O.error("Error executing command ".concat(r,":"),t)}}}))})(r,dr[i]||dr)}})),e.trustdata=lr,(function(){function t(){t.done||(t.done=!0,Object.values(vr).forEach((function(t){"function"==typeof t.wt&&t.wt()})))}o&&o.addEventListener?"complete"===o.readyState?t():o.addEventListener("DOMContentLoaded",t,{capture:!1,passive:!0}):e&&O.error("Browser doesn't support `document.addEventListener` so TrustData couldn't be initialized")})()})();
