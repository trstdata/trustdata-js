!(function(){"use strict";function t(t,i,e){return(i=(function(t){var i=(function(t){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var e=i.call(t,"string");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""})(t);return"symbol"==typeof i?i:i+""})(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function i(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,s)}return e}function e(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{};s%2?i(Object(r),!0).forEach((function(i){t(e,i,r[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s="undefined"!=typeof window?window:void 0,r="undefined"!=typeof globalThis?globalThis:s,n=Array.prototype.forEach,a=null==r?void 0:r.navigator,o=null==r?void 0:r.document,h=null==r?void 0:r.location,u=null==r?void 0:r.fetch,c=null!=r&&r.XMLHttpRequest&&"withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:void 0,d=null==r?void 0:r.AbortController,l=null==a?void 0:a.userAgent,v=null!=s?s:{},f="1.0.0",g=Object.prototype,p=g.hasOwnProperty,m=g.toString,_=Array.isArray||function(t){return"[object Array]"===m.call(t)},b=t=>"function"==typeof t,y=t=>void 0===t,w=t=>"[object String]"==m.call(t),S=t=>null===t,O=t=>"[object Number]"==m.call(t),x=t=>{var i={t:function(t){},info:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];i.t("log",...e)},warn:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];i.t("warn",...e)},error:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];i.t("error",...e)},critical:function(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e]},uninitializedWarning:t=>{i.error("You must initialize TrustData before calling ".concat(t))},createLogger:i=>x("".concat(t," ").concat(i))};return i},E=x("[TrustData.js]"),I=E.createLogger,T={};function k(t,i,e){if(_(t))if(n&&t.forEach===n)t.forEach(i,e);else if("length"in t&&t.length===+t.length)for(var s=0,r=t.length;s<r;s++)if(s in t&&i.call(e,t[s],s)===T)return}function R(t,i,e){if(!y(s=t)&&!S(s)){var s;if(_(t))return k(t,i,e);if((t=>t instanceof FormData)(t)){for(var r of t.entries())if(i.call(e,r[1],r[0])===T)return}else for(var n in t)if(p.call(t,n)&&i.call(e,t[n],n)===T)return}}var M=function(t){for(var i=arguments.length,e=Array(i>1?i-1:0),s=1;s<i;s++)e[s-1]=arguments[s];return k(e,(function(i){for(var e in i)void 0!==i[e]&&(t[e]=i[e])})),t},N=function(t){return function(){try{for(var i=arguments.length,e=Array(i),s=0;s<i;s++)e[s]=arguments[s];return t.apply(this,e)}catch(t){E.critical("Implementation error. Please turn on debug mode"),E.critical(t)}}};function D(t,i){for(var e=0;e<t.length;e++)if(i(t[e]))return t[e]}function P(t,i,e,s){var{capture:r=!1,passive:n=!0}={};null==t||t.addEventListener(i,e,{capture:r,passive:n})}var C=function(t,i,e){if(!t||!i||!i.length)return t;for(var s=t.split("#"),r=s[1],n=(s[0]||"").split("?"),a=n[1],o=n[0],h=(a||"").split("&"),u=[],c=0;c<h.length;c++){var d=h[c].split("=");_(d)&&(i.includes(d[0])?u.push(d[0]+"="+e):u.push(h[c]))}var l=o;return null!=a&&(l+="?"+u.join("&")),null!=r&&(l+="#"+r),l},j="cid",A="uid",U="udata",B="primary_window",z="fv",W=3e3,q="Mobile",F="Tablet",L="page_view",J="page_leave",K="event_name",G="client_id",V="session_id",Y="page_title",X="page_location",H="page_referrer",Q="event_time",$="session_number",Z="session_engaged",tt="first_visit",it="entrances",et="ignore_referrer",st=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","trdt_cpid","trdt_agid","trdt_kwid","trdt_ctid","mc_cid","gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],rt=!!c||!!u,nt=(t,i)=>{var[s,r]=t.split("?"),n=e({},i);null==r||r.split("&").forEach((t=>{var[i]=t.split("=");delete n[i]}));var a=(function(t,i){var e;void 0===i&&(i="&");var s=[];return R(t,(function(t,i){y(t)||y(i)||"undefined"===i||(e=encodeURIComponent(t instanceof File?t.name:""+t),s[s.length]=encodeURIComponent(i)+"="+e)})),s.join(i)})(n);return a=a?(r?r+"&":"")+a:r,"".concat(s,"?").concat(a)},at=(t,i)=>JSON.stringify(t,((t,i)=>"bigint"==typeof i?""+i:i),i),ot=t=>{var{data:i,compression:e}=t;if(i){if("base64"===e){var s=(function(t){var i,e,s,r,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,o=0,h="",u=[];if(!t)return t;t=(function(t){var i,e,s,r,n="";for(i=e=0,s=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,r=0;r<s;r++){var a=t.charCodeAt(r),o=null;a<128?e++:o=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),S(o)||(e>i&&(n+=t.substring(i,e)),n+=o,i=e=r+1)}return e>i&&(n+=t.substring(i,t.length)),n})(t);do{i=(r=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>12&63,e=r>>6&63,s=63&r,u[o++]=n.charAt(r>>18&63)+n.charAt(i)+n.charAt(e)+n.charAt(s)}while(a<t.length);switch(h=u.join(""),t.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h})(at(i)),r=(t=>"data="+encodeURIComponent("string"==typeof t?t:at(t)))(s);return{contentType:"application/x-www-form-urlencoded",body:r,estimatedSize:new Blob([r]).size}}var n=at(i);return{contentType:"application/json",body:n,estimatedSize:new Blob([n]).size}}},ht=[];function ut(t,i,e,s,r){return O(t)?t>e?(E.warn(s+" cannot be greater than max: "+e+". Using max value instead."),e):t<i?(E.warn(s+" cannot be less than min: "+i+". Using min value instead."),i):t:(E.warn(s+" must be a number. using max or fallback. max: "+e+", fallback: "+r),ut(r||e,i,e,s))}u&&ht.push({transport:"fetch",method:t=>{var i,s,{contentType:r,body:n,estimatedSize:a}=null!==(i=ot(t))&&void 0!==i?i:{},o=new Headers;R(t.headers,(function(t,i){o.append(i,t)})),r&&o.append("Content-Type",r);var h=t.url,c=null;if(d){var l=new d;c={signal:l.signal,timeout:setTimeout((()=>l.abort()),t.timeout)}}u(h,e({method:(null==t?void 0:t.method)||"GET",headers:o,keepalive:"POST"===t.method&&(a||0)<52428.8,body:n,signal:null===(s=c)||void 0===s?void 0:s.signal},t.fetchOptions)).then((i=>i.text().then((e=>{var s,r={statusCode:i.status,text:e};if(200===i.status)try{r.json=JSON.parse(e)}catch(t){E.error(t)}null===(s=t.callback)||void 0===s||s.call(t,r)})))).catch((i=>{var e;E.error(i),null===(e=t.callback)||void 0===e||e.call(t,{statusCode:0,text:i})})).finally((()=>c?clearTimeout(c.timeout):null))}}),c&&ht.push({transport:"XHR",method:t=>{var i,e=new c;e.open(t.method||"GET",t.url,!0);var{contentType:s,body:r}=null!==(i=ot(t))&&void 0!==i?i:{};R(t.headers,(function(t,i){e.setRequestHeader(i,t)})),s&&e.setRequestHeader("Content-Type",s),t.timeout&&(e.timeout=t.timeout),e.withCredentials=!0,e.onreadystatechange=()=>{if(4===e.readyState){var i,s={statusCode:e.status,text:e.responseText};if(200===e.status)try{s.json=JSON.parse(e.responseText)}catch{}null===(i=t.callback)||void 0===i||i.call(t,s)}},e.send(r)}}),null!=a&&a.sendBeacon&&ht.push({transport:"sendBeacon",method:t=>{var i=nt(t.url,{beacon:"1"});try{var e,{contentType:s,body:r}=null!==(e=ot(t))&&void 0!==e?e:{},n="string"==typeof r?new Blob([r],{type:s}):r;a.sendBeacon(i,n)}catch{}}});class ct{constructor(t,i){this.i=!0,this.o=[],this.h=void 0,this.u=ut((null==i?void 0:i.flush_interval_ms)||W,250,5e3,"flush interval",W),this.l=t}enqueue(t){this.o.push(t),this.h||this.v()}unload(){this.p();var t=this.o.length>0?this.m():{},i=Object.values(t);[...i.filter((t=>0===t.url.indexOf("/e"))),...i.filter((t=>0!==t.url.indexOf("/e")))].map((t=>{this.l(e(e({},t),{},{transport:"sendBeacon"}))}))}enable(){this.i=!1,this.v()}v(){var t=this;this.i||(this.h=setTimeout((()=>{if(this.p(),this.o.length>0){var i=this.m(),e=function(){var e=i[s],r=(new Date).getTime();e.data&&_(e.data)&&R(e.data,(t=>{t.offset=Math.abs(t.timestamp-r),delete t.timestamp})),t.l(e)};for(var s in i)e()}}),this.u))}p(){clearTimeout(this.h),this.h=void 0}m(){var t={};return R(this.o,(i=>{var s,r=i,n=(r?r.batchKey:null)||r.url;y(t[n])&&(t[n]=e(e({},r),{},{data:[]})),null===(s=t[n].data)||void 0===s||s.push(r.data)})),this.o=[],t}}var dt=["retriesPerformedSoFar"];class lt{constructor(t){this.S=t,this.O=!1,this.I=void 0,this.T=3e3,this.o=[],this.k=!0,!y(s)&&"onLine"in s.navigator&&(this.k=s.navigator.onLine,P(s,"online",(()=>{this.k=!0,this.R()})),P(s,"offline",(()=>{this.k=!1})))}get length(){return this.o.length}retriableRequest(t){var{retriesPerformedSoFar:i}=t,s=(function(t,i){if(null==t)return{};var e,s,r=(function(t,i){if(null==t)return{};var e={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(-1!==i.indexOf(s))continue;e[s]=t[s]}return e})(t,i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)-1===i.indexOf(e=n[s])&&{}.propertyIsEnumerable.call(t,e)&&(r[e]=t[e])}return r})(t,dt);O(i)&&i>0&&(s.url=nt(s.url,{retry_count:i})),this.S.M(e(e({},s),{},{callback:t=>{var r;200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=i?i:0)<10?this.N(e({retriesPerformedSoFar:i},s)):null===(r=s.callback)||void 0===r||r.call(s,t)}}))}N(t){var i=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=i+1;var e=(function(t){var i=3e3*2**t,e=i/2,s=Math.min(18e5,i),r=Math.random()-.5;return Math.ceil(s+r*(s-e))})(i),s=Date.now()+e;this.o.push({retryAt:s,requestOptions:t});var r="Enqueued failed request for retry in ".concat(e);navigator.onLine||(r+=" (Browser is offline)"),E.warn(r),this.O||(this.O=!0,this.D())}D(){this.I&&clearTimeout(this.I),this.I=setTimeout((()=>{this.k&&this.o.length>0&&this.R(),this.D()}),this.T)}R(){var t=Date.now(),i=[],e=this.o.filter((e=>e.retryAt<t||(i.push(e),!1)));if(this.o=i,e.length>0)for(var{requestOptions:s}of e)this.retriableRequest(s)}unload(){for(var{requestOptions:t}of(this.I&&(clearTimeout(this.I),this.I=void 0),this.o))try{this.S.M(e(e({},t),{},{transport:"sendBeacon"}))}catch(t){E.error(t)}this.o=[]}}function vt(){return Date.now().toString(36)+Math.random().toString(36).substring(2,9)}function ft(){return Math.floor(Date.now()/1e3)}var gt="",pt=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,mt={is_supported:()=>!!o,error:function(t){E.error("cookieStore error: "+t)},get:function(t){if(o){try{for(var i=t+"=",e=o.cookie.split(";").filter((t=>t.length)),s=0;s<e.length;s++){for(var r=e[s];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(i))return decodeURIComponent(r.substring(i.length,r.length))}}catch{}return null}},parse:function(t){var i;try{i=JSON.parse(mt.get(t))||{}}catch{}return i},set:function(t,i,e,s,r){if(o)try{var n="",a="",h=(function(t,i){if(i){var e=(function(t,i){if(void 0===i&&(i=o),gt)return gt;if(!i)return"";if(["localhost","127.0.0.1"].includes(t))return"";for(var e=t.split("."),s=Math.min(e.length,8),r="dmn_chk_"+vt(),n=RegExp("(^|;)\\s*"+r+"=1");!gt&&s--;){var a=e.slice(s).join("."),h=r+"=1;domain=."+a;i.cookie=h,n.test(i.cookie)&&(i.cookie=h+";expires=Thu, 01 Jan 1970 00:00:00 GMT",gt=a)}return gt})(t);if(!e){var s=(t=>{var i=t.match(pt);return i?i[0]:""})(t);e=s}return e?"; domain=."+e:""}return""})(o.location.hostname,s);if(e){var u=new Date;u.setTime(u.getTime()+24*e*60*60*1e3),n="; expires="+u.toUTCString()}r&&(a="; secure");var c=t+"="+encodeURIComponent(JSON.stringify(i))+n+"; SameSite=Lax; path=/"+h+a;return c.length>3686.4&&E.warn("cookieStore warning: large cookie, len="+c.length),o.cookie=c,c}catch{return}},remove:function(t,i){try{mt.set(t,"",-1,i)}catch{return}}},_t=null,bt={is_supported:function(){if(!S(_t))return _t;var t=!0;if(y(s))t=!1;else try{var i="__mplssupport__";bt.set(i,"xyz"),'"xyz"'!==bt.get(i)&&(t=!1),bt.remove(i)}catch{t=!1}return t||E.error("localStorage unsupported; falling back to cookie store"),_t=t,t},error:function(t){E.error("localStorage error: "+t)},get:function(t){try{return s&&s.localStorage.getItem(t)}catch(t){bt.error(t)}return null},parse:function(t){try{return JSON.parse(bt.get(t))||{}}catch{}return null},set:function(t,i){try{s&&s.localStorage.setItem(t,JSON.stringify(i))}catch(t){bt.error(t)}},remove:function(t){try{s&&s.localStorage.removeItem(t)}catch(t){bt.error(t)}}},yt=[j,A,U,"sid","sn","last","start","wid",B,z],wt=e(e({},bt),{},{parse:function(t){try{var i={};try{i=mt.parse(t)||{}}catch{}var e=M(i,JSON.parse(bt.get(t)||"{}"));return bt.set(t,e),e}catch{}return null},set:function(t,i,e,s,r,n){try{bt.set(t,i,void 0,void 0,n);var a={};yt.forEach((t=>{i[t]&&(a[t]=i[t])})),Object.keys(a).length&&mt.set(t,a,e,s,r,n)}catch(t){bt.error(t)}},remove:function(t,i){try{s&&s.localStorage.removeItem(t),mt.remove(t,i)}catch(t){bt.error(t)}}});function St(t,i){return-1!==t.indexOf(i)}var Ot=q,xt="iOS",Et="Android",It=F,Tt=Et,kt="iPad",Rt="Apple",Mt=Rt+" Watch",Nt="Safari",Dt="BlackBerry",Pt="Samsung",Ct=Pt+"Browser",jt=Pt+" Internet",At="Chrome",Ut=At+" OS",Bt=At+" "+xt,zt="Internet Explorer",Wt=zt,qt="Opera",Ft=qt+" Mini",Lt="Edge",Jt="Edge",Kt="Firefox",Gt=Kt+" "+xt,Vt="Nintendo",Yt="PlayStation",Xt="Xbox",Ht=Et,Qt=Nt,$t="Windows",Zt=$t+" Phone",ti="Nokia",ii="Ouya",ei="Generic",si=ei+" "+Ot.toLowerCase(),ri=ei+" "+It.toLowerCase(),ni="Konqueror",ai="(\\d+(\\.\\d+)?)",oi=RegExp("Version/"+ai),hi=RegExp(Xt,"i"),ui=RegExp(Yt+" \\w+","i"),ci=RegExp(Vt+" \\w+","i"),di=RegExp(Dt+"|PlayBook|BB10","i"),li={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},vi=function(t,i){return i=i||"",St(t," OPR/")&&St(t,"Mini")?Ft:St(t," OPR/")?qt:di.test(t)?Dt:St(t,"IE"+Ot)||St(t,"WPDesktop")?Wt:St(t,Ct)?jt:St(t,Lt)||St(t,"Edg/")?Jt:St(t,"FBIOS")?"Facebook "+Ot:St(t,"UCWEB")||St(t,"UCBrowser")?"UC Browser":St(t,"CriOS")?Bt:St(t,"CrMo")||St(t,At)?At:St(t,Et)&&St(t,Nt)?Ht:St(t,"FxiOS")?Gt:St(t.toLowerCase(),"konqueror")?ni:((t,i)=>i&&St(i,Rt)||(function(t){return St(t,Nt)&&!St(t,At)&&!St(t,Et)})(t))(t,i)?St(t,Ot)?Qt:Nt:St(t,Kt)?Kt:St(t,"MSIE")||St(t,"Trident/")?zt:St(t,"Gecko")?Kt:""},fi={[Wt]:[RegExp("rv:"+ai)],[Jt]:[RegExp(Lt+"?\\/"+ai)],[At]:[RegExp("("+At+"|CrMo)\\/"+ai)],[Bt]:[RegExp("CriOS\\/"+ai)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+ai)],[Nt]:[oi],[Qt]:[oi],[qt]:[RegExp("(Opera|OPR)\\/"+ai)],[Kt]:[RegExp(Kt+"\\/"+ai)],[Gt]:[RegExp("FxiOS\\/"+ai)],[ni]:[RegExp("Konqueror[:/]?"+ai,"i")],[Dt]:[RegExp(Dt+" "+ai),oi],[Ht]:[RegExp("android\\s"+ai,"i")],[jt]:[RegExp(Ct+"\\/"+ai)],[zt]:[RegExp("(rv:|MSIE )"+ai)],Mozilla:[RegExp("rv:"+ai)]},gi=function(t,i){var e=vi(t,i),s=fi[e];if(y(s))return null;for(var r=0;r<s.length;r++){var n=t.match(s[r]);if(n)return parseFloat(n[n.length-2])}return null},pi=[[RegExp(Xt+"; "+Xt+" (.*?)[);]","i"),t=>[Xt,t&&t[1]||""]],[RegExp(Vt,"i"),[Vt,""]],[RegExp(Yt,"i"),[Yt,""]],[di,[Dt,""]],[RegExp($t,"i"),(t,i)=>{if(/Phone/.test(i)||/WPDesktop/.test(i))return[Zt,""];if(RegExp(Ot).test(i)&&!/IEMobile\b/.test(i))return[$t+" "+Ot,""];var e=/Windows NT ([0-9.]+)/i.exec(i);if(e&&e[1]){var s=li[e[1]]||"";return/arm/i.test(i)&&(s="RT"),[$t,s]}return[$t,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>t&&t[3]?[xt,[t[3],t[4],t[5]||"0"].join(".")]:[xt,""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var i="";return t&&t.length>=3&&(i=y(t[2])?t[3]:t[2]),["watchOS",i]}],[RegExp("("+Et+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Et+")","i"),t=>t&&t[2]?[Et,[t[2],t[3],t[4]||"0"].join(".")]:[Et,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var i=["Mac OS X",""];return t&&t[1]&&(i[1]=[t[1],t[2],t[3]||"0"].join(".")),i}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Ut,""]],[/Linux|debian/i,["Linux",""]]],mi=function(t){return ci.test(t)?Vt:ui.test(t)?Yt:hi.test(t)?Xt:RegExp(ii,"i").test(t)?ii:RegExp("("+Zt+"|WPDesktop)","i").test(t)?Zt:/iPad/.test(t)?kt:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?Mt:di.test(t)?Dt:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":RegExp(ti,"i").test(t)?ti:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!RegExp(Ot).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?Et:Tt:Et:RegExp("(pda|"+Ot+")","i").test(t)?si:RegExp(It,"i").test(t)&&!RegExp(It+" pc","i").test(t)?ri:""},_i="<masked>";function bi(){return navigator.language||navigator.userLanguage}function yi(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function wi(){try{return(new Date).getTimezoneOffset()}catch{return}}class Si{constructor(t){this._config=t.CONFIG,this.P=void 0,this.C=t.STATE}get consent(){return this.j()?0:this.A}isOptedOut(){return 0===this.consent||-1===this.consent&&this._config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(t){this.U.set(this.B,t?1:0,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie),this.C&&(this.C.consentStatus=e(e({},this.C.consentStatus),{},{analytics:t}))}reset(){this.U.remove(this.B,this._config.cross_subdomain_cookie)}get B(){var{attribution_ids:t,opt_out_capturing_cookie_prefix:i}=this._config;return(i||"__tr_opt_in_out_")+t[0]}get A(){var t=this.U.get(this.B);return"1"===t?1:"0"===t?0:-1}get U(){if(!this.P){var t=this._config.opt_out_capturing_persistence_type;this.P="localStorage"===t?bt:mt;var i="localStorage"===t?mt:bt;i.get(this.B)&&(this.P.get(this.B)||this.optInOut("1"===i.get(this.B)),i.remove(this.B,this._config.cross_subdomain_cookie))}return this.P}j(){return!!this._config.respect_dnt&&!!D([null==a?void 0:a.doNotTrack,null==a?void 0:a.msDoNotTrack,v.doNotTrack],(t=>St([!0,1,"1","yes"],t)))}}class Oi{constructor(t){this.logger=I("[SessionManager]"),this.logger.log("SessionManager constructor called"),this._config=t.CONFIG,this.C=t.STATE,this.W=t.consentManager,this.q=t.persistence;var i=this._config.persistence_name||"_trdt";this.SESSION_DATA_KEY=i+"_sdata",this.SESSION_NUMBER_KEY=i+"_sn",this.WINDOW_ID_KEY=i+"_wid",this.PRIMARY_WINDOW_KEY=i+"_"+B,this.logger.log("Session storage keys:",{SESSION_DATA_KEY:this.SESSION_DATA_KEY,SESSION_NUMBER_KEY:this.SESSION_NUMBER_KEY,WINDOW_ID_KEY:this.WINDOW_ID_KEY,PRIMARY_WINDOW_KEY:this.PRIMARY_WINDOW_KEY}),this._sessionId=null,this._sessionActivityTimestamp=null,this._sessionStartTimestamp=null,this.F=null,this.windowId=null,this.sessionChangeHandlers=[],this.sessionTimer=null,this.L(),this.initSession(!0),this.logger.log("SessionManager initialized with session data:",{sessionId:this._sessionId,activityTimestamp:this._sessionActivityTimestamp,startTimestamp:this._sessionStartTimestamp,windowId:this.windowId,sessionNumber:this.F})}J(){return 60*Math.min(Math.max(this._config.sessionTimeout||30,1),600)*1e3}K(){var t=this.W.isOptedIn()&&!this._config.disable_persistence&&this.q;return this.logger.log("Can use storage:",t,{isOptedIn:this.W.isOptedIn(),disable_persistence:this._config.disable_persistence,persistence:!!this.q}),t}G(){try{var t="undefined"!=typeof sessionStorage&&null!==sessionStorage;return this.logger.log("Can use sessionStorage:",t),t}catch(t){return this.logger.error("Error accessing sessionStorage:",t),!1}}V(){if(this.windowId)return this.windowId;if(this.G())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY);if(t)return this.logger.log("Retrieved window ID from sessionStorage:",t),t}catch(t){this.logger.error("Error reading window ID from sessionStorage:",t)}return null}Y(t){if(t!==this.windowId&&(this.logger.log("Setting window ID:",t),this.windowId=t,this.G()))try{sessionStorage.setItem(this.WINDOW_ID_KEY,t)}catch(t){this.logger.error("Error storing window ID in sessionStorage:",t)}}L(){if(this.logger.log("Initializing window tracking"),this.G())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY),i=sessionStorage.getItem(this.PRIMARY_WINDOW_KEY);this.logger.log("Window tracking state:",{lastWindowId:t,primaryWindowExists:i}),t&&!i?(this.windowId=t,this.logger.log("Using existing window ID:",t)):(sessionStorage.removeItem(this.WINDOW_ID_KEY),this.logger.log("Removed previous window ID")),sessionStorage.setItem(this.PRIMARY_WINDOW_KEY,"true"),window.addEventListener("beforeunload",(()=>{sessionStorage.removeItem(this.PRIMARY_WINDOW_KEY),this.logger.log("Window unloading, removed PRIMARY_WINDOW_KEY")}))}catch(t){this.logger.error("Error initializing window tracking:",t)}}X(t,i,e){if(this.logger.log("Setting session data:",{sessionId:t,activityTimestamp:i,startTimestamp:e}),t!==this._sessionId||i!==this._sessionActivityTimestamp||e!==this._sessionStartTimestamp)if(this._sessionId=t,this._sessionActivityTimestamp=i,this._sessionStartTimestamp=e,this.K())try{var s=[i,t,e];if(this.logger.log("Storing session data:",s),!this.q||"function"!=typeof this.q.set)return void this.logger.error("Persistence layer is not properly initialized");this.q.set(this.SESSION_DATA_KEY,JSON.stringify(s),this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie);var r=this.q.get(this.SESSION_DATA_KEY);this.logger.log("Verification - stored session data:",r)}catch(t){this.logger.error("Error storing session data:",t)}else this.logger.log("Not storing session data - storage not available");else this.logger.log("No changes to session data, skipping update")}H(){if(this.logger.log("Getting session data"),this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return this.logger.log("Using in-memory session data:",[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp]),[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];if(this.K())try{var t=this.q.get(this.SESSION_DATA_KEY);if(this.logger.log("Raw session data from storage:",t),t){var i=JSON.parse(t);if(this.logger.log("Parsed session data:",i),Array.isArray(i))return 2===i.length&&(i.push(i[0]),this.logger.log("Added missing startTimestamp:",i)),this._sessionActivityTimestamp=i[0],this._sessionId=i[1],this._sessionStartTimestamp=i[2],i;this.logger.error("Stored session data is not an array:",i)}else this.logger.log("No session data found in storage")}catch(t){this.logger.error("Error reading session data:",t)}else this.logger.log("Storage not available for getting session data");return this.logger.log("Returning default session data"),[0,null,0]}$(){if(this.F)return this.logger.log("Using in-memory session number:",this.F),this.F;if(this.K())try{var t=this.q.get(this.SESSION_NUMBER_KEY);if(this.logger.log("Raw session number from storage:",t),t){var i=parseInt(t)||1;return this.F=i,this.logger.log("Parsed session number:",i),i}}catch(t){this.logger.error("Error reading session number:",t)}return this.logger.log("Using default session number: 1"),1}Z(t){if(this.logger.log("Setting session number:",t),this.F=t,this.K())try{this.q.set(this.SESSION_NUMBER_KEY,""+t,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie);var i=this.q.get(this.SESSION_NUMBER_KEY);this.logger.log("Verification - stored session number:",i)}catch(t){this.logger.error("Error storing session number:",t)}else this.logger.log("Not storing session number - storage not available")}tt(t,i){var e=864e5,s=t>0&&i-t>e;return this.logger.log("Checking if session is too long:",{startTimestamp:t,now:i,difference:i-t,maxLength:e,isTooLong:s}),s}checkAndGetSessionAndWindowId(t,i){void 0===t&&(t=!1),void 0===i&&(i=null),this.logger.log("checkAndGetSessionAndWindowId called, readOnly:",t);var e=i||(new Date).getTime();if(this.K()){var s=this.q.get(this.SESSION_DATA_KEY);this.logger.log("Raw session data before processing:",s);try{s&&this.logger.log("Parsed raw session data:",JSON.parse(s))}catch(t){this.logger.error("Error parsing raw session data:",t)}}var[r,n,a]=this.H(),o=this.V(),h=this.$();this.logger.log("Current session state:",{lastActivityTimestamp:r,sessionId:n,startTimestamp:a,windowId:o,sessionNumber:h,timestamp:e});var u=a>0&&e-a>864e5,c=!1,d=!n,l=!t&&r>0&&e-r>this.J();this.logger.log("Session conditions:",{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u,timeoutMs:this.J(),timeSinceLastActivity:r>0?e-r:"N/A"}),d||l||u?(this.logger.log("Creating new session due to:",{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}),n=ft(),o=vt(),a=e,h++,this.Z(h),c=!0):o?this.logger.log("Keeping existing session and window IDs"):(o=vt(),c=!0,this.logger.log("Created new window ID:",o));var v=0===r||!t||u?e:r;this.logger.log("Activity timestamp calculation:",{lastActivityTimestamp:r,readOnly:t,sessionPastMaximumLength:u,newActivityTimestamp:v});var f=0===a?e:a;return this.Y(o),this.X(n,v,f),this.C?(this.C.sessionId=n,this.C.sessionNumber=h,this.C.sessionEngaged=!c,this.C.isNewVisit=c,this.logger.log("Updated state:",{sessionId:this.C.sessionId,sessionNumber:this.C.sessionNumber,sessionEngaged:this.C.sessionEngaged,isNewVisit:this.C.isNewVisit})):this.logger.error("State object is not available"),t||this.refreshSessionTimer(),c&&this.it(n,o,c?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0),this.logger.log("Final session state:",{sessionId:n,windowId:o,sessionStartTimestamp:f,sessionNumber:h,changeReason:c?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0,lastActivityTimestamp:v}),{sessionId:n,windowId:o,sessionStartTimestamp:f,sessionNumber:h,changeReason:c?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0,lastActivityTimestamp:v}}initSession(t){return void 0===t&&(t=!1),this.logger.log("initSession called, readOnly:",t),this.checkAndGetSessionAndWindowId(t)}refreshSessionTimer(){this.logger.log("Refreshing session timer"),clearTimeout(this.sessionTimer);var t=1.1*this.J();this.logger.log("Setting session timeout for ".concat(t,"ms")),this.sessionTimer=setTimeout((()=>{this.logger.log("Session timeout reached, resetting session"),this.resetSession()}),t)}resetSession(){this.logger.log("Resetting session"),this.X(null,0,0),this.initSession()}onSessionChange(t){return this.logger.log("Registering session change handler"),this.sessionChangeHandlers.push(t),this._sessionId&&(this.logger.log("Calling session change handler immediately with existing session:",this._sessionId),t(this._sessionId,this.windowId)),()=>{this.logger.log("Unregistering session change handler"),this.sessionChangeHandlers=this.sessionChangeHandlers.filter((i=>i!==t))}}it(t,i,e){this.logger.log("Notifying session change handlers:",{handlers:this.sessionChangeHandlers.length,sessionId:t,windowId:i,reason:e}),this.sessionChangeHandlers.forEach((s=>{try{s(t,i,e)}catch(t){this.logger.error("Error in session change handler:",t)}}))}getSessionId(){var t=this._sessionId||this.C&&this.C.sessionId||null;return this.logger.log("getSessionId called, returning:",t),t}getWindowId(){var t=this.V();return this.logger.log("getWindowId called, returning:",t),t}}class xi{constructor(t){this._config=t.CONFIG,this.C=t.STATE,this.q=t.persistence,this.W=t.consentManager,this.clientId=null,this.isFirstVisit=!1}initClientId(t){void 0===t&&(t={});var i=this.K(),e=this._config.persistence_name||"_trdt",s=t.client_id;if(!s&&i&&(s=this.q.get(e+"_"+j))&&s.startsWith('"')&&s.endsWith('"'))try{s=JSON.parse(s)}catch(t){E.error("Error parsing stored client ID",t)}var r=i&&this.q.get(e+"_"+z);return s?(this.clientId=s,this.isFirstVisit=!r):(this.clientId=Math.floor(2147483647*Math.random())+"."+ft(),this.isFirstVisit=!0,i&&(this.et(this.clientId),this.st())),this.C.clientId=this.clientId,this.C.isFirstVisit=this.isFirstVisit,this.clientId}et(t){if(this.K()){var i=this._config.persistence_name||"_trdt",e=this._config.cookie_expiration,s=this._config.cross_subdomain_cookie,r=this._config.secure_cookie,n=t&&"string"==typeof t&&t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t;this.q.set(i+"_"+j,n,e,s,r)}}st(){if(this.K()&&this.isFirstVisit){var t=this._config.persistence_name||"_trdt",i=this._config.cookie_expiration,e=this._config.cross_subdomain_cookie,s=this._config.secure_cookie,r=""+Date.now();this.q.set(t+"_"+z,r,i,e,s)}}setClientId(t){if(!t)return!1;var i=t&&"string"==typeof t&&t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t;return this.clientId=i,this.C.clientId=i,this.K()&&this.et(i),!0}getClientId(){return this.clientId}K(){return this.W.isOptedIn()&&!this._config.disable_persistence}}class Ei{constructor(t){this._config=t.CONFIG,this.C=t.STATE,this.q=t.persistence,this.W=t.consentManager,this.userId=null,this.userData={},this.identifiers={}}initUser(t){void 0===t&&(t={});var i=this.K(),e=this._config.persistence_name||"_trdt";if(this.userId=t.user_id||i&&this.q.get(e+"_"+A),i)try{var s=this.q.get(e+"_"+U);s&&(this.userData=JSON.parse(s))}catch(t){E.error("Error parsing stored user data",t),this.userData={}}return this.C.userId=this.userId,this.userData}setUserId(t){return!!t&&(this.userId=t,this.C.userId=t,this.K()&&this.q.set((this._config.persistence_name||"_trdt")+"_"+A,t,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie),!0)}setUserData(t){if((i=t)!==Object(i)||_(i))return!1;var i;if(this.userData=e(e({},this.userData),t),this.K()){var s=this._config.cookie_expiration,r=this._config.cross_subdomain_cookie,n=this._config.secure_cookie;this.q.set((this._config.persistence_name||"_trdt")+"_"+U,JSON.stringify(this.userData),s,r,n)}return!0}setIdentifier(t,i){return!(!w(t)||!w(i)||(this.identifiers[t]=i,0))}getUserData(){return e(e({},this.userData),this.identifiers)}getUserId(){return this.userId}K(){return this.W.isOptedIn()&&!this._config.disable_persistence}}var Ii=()=>{},Ti="trustdata";!rt&&-1===(null==l?void 0:l.indexOf("MSIE"))&&(null==l||l.indexOf("Mozilla"));class ki{__loaded=!1;CONFIG=(()=>{var t;return{api_host:"https://t.trstdata.com",api_endpoint:"/api/events",attribution_ids:[],ignore_referrer_domains:[],cross_subdomain_cookie:!0,persistence:"localStorage+cookie",persistence_name:"_trdt",debug:!1,loaded:Ii,cookie_expiration:365,disable_persistence:!1,disable_compression:!0,secure_cookie:s&&"https:"===(null===(t=s.location)||void 0===t?void 0:t.protocol),request_batching:!0,properties_string_max_length:65535,session_timeout:30,on_request_error:t=>{E.error("Bad HTTP status: "+t.statusCode+" "+t.text)},send_page_view:!0,onCapture:Ii,flush_interval_ms:W}})();constructor(){this.STATE={clientId:null,userId:null,sessionId:null,sessionNumber:1,sessionEngaged:!1,isNewVisit:!1,isFirstVisit:!1,ignoreReferrer:!1,consentStatus:{analytics:!1,advertising:!1,personalization:!1},persistentParameters:{},initializedTargets:new Set},this.logger=I("[TrustData.js]"),this.consentManager=new Si(this)}config(t,i,e){var s;if(void 0===i&&(i={}),void 0===e&&(e=null),!e||e===Ti)return this._config(t,i,e);var r=null!==(s=Ri[e])&&void 0!==s?s:new ki;return r._config(t,i,e),Ri[e]=r,Ri[Ti][e]=r,r}rt(t){if(_(t)){var i=[],e=[],s=[];R(t,(t=>{if(t){var r=t[0];_(r)?s.push(t):b(t)?t.call(this):_(t)&&"config"===r?i.push(t):_(t)&&-1!==r.indexOf("event")&&b(this[r])?s.push(t):e.push(t)}}));var r=t=>{R(t,(t=>{if(_(t[0])){var i=this;R(t,(t=>{i=i[t[0]].apply(i,t.slice(1))}))}else"function"==typeof this[t[0]]?this[t[0]].apply(this,t.slice(1)):E.warn("Unknown command:",t[0])}))};r(i),r(e),r(s)}}_config(t,i,e){return void 0===i&&(i={}),this.__loaded?(E.warn("You have already initialized TrustData! Re-initializing is a no-op"),this):(t&&!this.CONFIG.attribution_ids.includes(t)&&this.CONFIG.attribution_ids.push(t),t?(i.ignoreReferrerDomains&&(this.CONFIG.ignore_referrer_domains=Array.isArray(i.ignoreReferrerDomains)?i.ignoreReferrerDomains:[i.ignoreReferrerDomains]),Object.keys(i).forEach((t=>{t in this.CONFIG&&(this.CONFIG[t]=i[t])})),i.consent&&this.consent("update",{consent:i.consent}),this.nt(),this._requestQueue=new ct((t=>this.ot(t)),{flush_interval_ms:this.CONFIG.flush_interval_ms}),this._retryQueue=new lt(this),this.clientManager=new xi(this),this.userManager=new Ei(this),this.clientManager.initClientId(i),this.userManager.initUser(i),this.sessionManager=new Oi(this),this.__loaded=!0,this.consentManager.isOptedIn()&&this.CONFIG.request_batching&&this._requestQueue.enable(),this.ht(),s.ut=!0,t&&this.STATE.initializedTargets.add(t),!1!==i.send_page_view&&setTimeout((()=>this.event(L,{send_to:t})),50),"function"==typeof this.CONFIG.loaded&&this.CONFIG.loaded(this),!0):(E.critical("TrustData was initialized without a target ID. This likely indicates a misconfiguration."),this))}nt(){var t=this.CONFIG;this.persistence="localStorage"===t.persistence?bt:"cookie"===t.persistence?mt:wt,this.sessionPersistence="sessionStorage"===this.CONFIG.persistence?this.persistence:e(e({},this.persistence),{},{persistence:"sessionStorage"}),this.persistence_name=t.persistence_name||"_trdt"}ht(){var t="onpagehide"in self?"pagehide":"unload";s.addEventListener(t,this.ct.bind(this),{passive:!1})}ct(){this.CONFIG.request_batching?(this.event(J),this._requestQueue.unload(),this._retryQueue.unload()):this.event(J,null,{transport:"sendBeacon"})}set(t,i){if(!this.__loaded)return this.push(["set",t,i]);if("object"==typeof t)return Object.entries(t).forEach((t=>{var[i,e]=t;return this.set(i,e)})),!0;if("function"==typeof i)try{i=i()}catch(t){return E.error("Error processing function value:",t),!1}switch("string"==typeof i&&(i=i.substring(0,100)),t){case"user_id":this.STATE.userId=i,this.userManager.setUserId(i);break;case"client_id":this.clientManager.setClientId(i);break;case"debug_mode":this.CONFIG.debug=!0===i||"true"===i;break;case"page_referrer":case"page_location":case"page_title":case"ignore_referrer":this.STATE.persistentParameters[t]=i,"ignore_referrer"===t&&(this.STATE.ignoreReferrer=!0===i||"true"===i);break;case"user_data":"object"==typeof i&&this.userManager.setUserData(i);break;case"email_hash":case"phone_hash":this.userManager.setIdentifier(t,i);break;default:this.STATE.persistentParameters[t]=i}return!0}event(t,i,s){if(void 0===i&&(i={}),void 0===s&&(s={}),!t)return E.error("Missing event name"),!1;if(!this.__loaded)return this.push(["event",t,i,s]);this.STATE.sessionEngaged=!0,i&&i.hasOwnProperty("ignore_referrer")&&(this.STATE.ignoreReferrer=!0===i.ignore_referrer,delete i.ignore_referrer),i&&["page_referrer","page_location","page_title"].forEach((t=>{i.hasOwnProperty(t)&&(this.STATE.persistentParameters[t]=i[t])}));var r=this.CONFIG.attribution_ids;i&&i.send_to&&(r=Array.isArray(i.send_to)?i.send_to:[i.send_to],delete i.send_to);var n=r.filter((t=>this.STATE.initializedTargets.has(t)));0===n.length&&this.CONFIG.attribution_ids.length>0&&(n=[this.CONFIG.attribution_ids[0]]);var a=this.STATE.isFirstVisit,o=this.STATE.isNewVisit,h=this.dt(t,i);return n.forEach((t=>{var i=e(e({},h),{},{attribution_id:t}),r={method:"POST",url:this.CONFIG.api_host+this.CONFIG.api_endpoint,data:i,compression:this.CONFIG.disable_compression?void 0:"gzip-js",batchKey:t};s&&s.transport&&(r.transport=s.transport),this.CONFIG.request_batching&&!s.send_instantly?this._requestQueue.enqueue(r):this.ot(r)})),a&&(this.STATE.isFirstVisit=!1),o&&(this.STATE.isNewVisit=!1),this.sessionManager&&this.sessionManager.refreshSessionTimer(),!0}dt(t,i){var r,n;void 0===i&&(i={});var a=e(e({},i),{},{[K]:t}),u={[G]:this.STATE.clientId,[V]:this.STATE.sessionId,[$]:this.STATE.sessionNumber||1,[Z]:this.STATE.sessionEngaged?1:0,[Q]:Math.floor(Date.now()/1e3)};Object.entries(u).forEach((t=>{var[i,e]=t;a.hasOwnProperty(i)||(a[i]=e)}));var c=(function(){if(!l)return{};var t,i,e,[r,n]=(function(t){for(var i=0;i<pi.length;i++){var[e,s]=pi[i],r=e.exec(t),n=r&&(b(s)?s(r,t):s);if(n)return n}return["",""]})(l);return M({lib:"web",lib_version:f,event_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),[Q]:Date.now()/1e3,[X]:C(null==h?void 0:h.href,[],_i),page_hostname:null==h?void 0:h.host,page_path:null==h?void 0:h.pathname,os_name:r,os_version:n,browser:vi(l,navigator.vendor),device:mi(l),device_type:(i=l,e=mi(i),e===kt||e===Tt||"Kobo"===e||"Kindle Fire"===e||e===ri?F:e===Vt||e===Xt||e===Yt||e===ii?"Console":e===Mt?"Wearable":e?q:"Desktop").toLowerCase(),timezone:yi(),timezone_offset:wi(),raw_user_agent:l.length>1e3?l.substring(0,997)+"...":l,browser_version:gi(l,navigator.vendor),browser_language:bi(),browser_language_prefix:(t=bi(),"string"==typeof t?t.split("-")[0]:void 0),screen_resolution:(s&&s.screen.width)+"x"+(s&&s.screen.height),viewport_resolution:(s&&s.innerWidth)+"x"+(s&&s.innerHeight)})})();Object.entries(c).forEach((t=>{var[i,e]=t;a[i]||(a[i]=e)}));var d,v={[H]:o&&o.referrer||"$direct",page_referring_domain:!o&&o.referrer?"$direct":(null===(d=(t=>{var i=o&&o.createElement("a");return y(i)?null:(i.href=t,i)})(o.referrer))||void 0===d?void 0:d.host)||"$direct"};Object.entries(v).forEach((t=>{var[i,e]=t;a[i]||(a[i]=e)}));var g,p,m,w=o?(g=C(o.URL,[],_i),p=st.concat([]),m={},R(p,(function(t){var i=(function(t,i){for(var e,s=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),r=0;r<s.length;r++){var n=s[r].split("=");if(n[0]===i){e=n;break}}if(!_(e)||e.length<2)return"";var a=e[1];try{a=decodeURIComponent(a)}catch{E.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")})(g,t);m[t]=i||null})),m):{};Object.entries(w).forEach((t=>{var[i,e]=t;e&&!a[i]&&(a[i]=e)})),this.STATE.userId&&(a.user_id=this.STATE.userId);var S=null===(r=this.userManager)||void 0===r?void 0:r.getUserData();S&&Object.keys(S).length>0&&Object.entries(S).forEach((t=>{var[i,e]=t;a[i]||(a[i]=e)})),this.STATE.isNewVisit&&!a[it]&&(a[it]=1),this.STATE.isFirstVisit&&!a[tt]&&(a[tt]=1);var O=o&&(null===(n=o.location)||void 0===n?void 0:n.href),x=o&&o.referrer,I=this.STATE.ignoreReferrer;if(x)try{var T=new URL(x).hostname;this.CONFIG.ignore_referrer_domains.includes(T)&&(I=!0)}catch(t){}if(this.STATE.persistentParameters.page_referrer){var k=this.lt(this.STATE.persistentParameters.page_referrer),N=this.lt(O);N&&k&&N===k&&(I=!0)}return I&&!a[et]&&(a[et]=!0),I||!x||this.STATE.persistentParameters.page_referrer||a[H]||(a[H]=x),this.STATE.persistentParameters.page_referrer||this.STATE.persistentParameters.page_location||this.STATE.persistentParameters.page_title||a[H]||a[X]||a[Y]||o&&(a[X]||(a[X]=o.location.href),a[Y]||(a[Y]=o.title)),Object.entries(this.STATE.persistentParameters).forEach((t=>{var[i,e]=t;a[i]||(a[i]=e)})),a.consent_analytics||(a.consent_analytics=this.STATE.consentStatus.analytics),a.consent_advertising||(a.consent_advertising=this.STATE.consentStatus.advertising),a.consent_personalization||(a.consent_personalization=this.STATE.consentStatus.personalization),a}lt(t){try{return new URL(t||"").hostname}catch(t){return""}}ot(t){this._retryQueue?this._retryQueue.retriableRequest(t):this.M(t)}M(t){if(this.__loaded){if(t.headers=t.headers||{},"sendBeacon"===t.transport&&a&&a.sendBeacon)try{if(a.sendBeacon(t.url,new Blob([JSON.stringify(t.data)],{type:"text/plain"})))return;E.warn("sendBeacon failed, falling back to regular request")}catch(t){E.error("Error in sendBeacon, falling back to regular request:",t)}(t=>{var i,s,r,n=e({},t);n.timeout=n.timeout||6e4,n.url=nt(n.url,{_:""+(new Date).getTime(),ver:f,compression:n.compression});var a=null!==(i=n.transport)&&void 0!==i?i:"fetch",o=null!==(s=null===(r=D(ht,(t=>t.transport===a)))||void 0===r?void 0:r.method)&&void 0!==s?s:ht[0].method;if(!o)throw Error("No available transport method");o(n)})(e(e({},t),{},{callback:i=>{var e,s,r;i.statusCode>=400&&(E.error("Request error:",i.statusCode,i.text),null===(s=(r=this.CONFIG).on_request_error)||void 0===s||s.call(r,i)),null===(e=t.callback)||void 0===e||e.call(t,i)}}))}else E.warn("TrustData not initialized, cannot send request")}consent(t,i){if(!this.__loaded)return this.push(["consent",t,i]);if(!i||!i.hasOwnProperty("consent"))return E.error("Invalid consent parameters"),!1;var e=i.consent;return"analytics"in e&&(this.STATE.consentStatus.analytics=!0===e.analytics||"granted"===e.analytics),"advertising"in e&&(this.STATE.consentStatus.advertising=!0===e.advertising||"granted"===e.advertising),"personalization"in e&&(this.STATE.consentStatus.personalization=!0===e.personalization||"granted"===e.personalization),this.consentManager instanceof Si&&(this.consentManager.optInOut(this.STATE.consentStatus.analytics),this.STATE.consentStatus.analytics&&this.CONFIG.request_batching&&this._requestQueue.enable()),!0}get(t,i,s){var r,n,a;if("string"==typeof t&&"function"==typeof i&&(s=i,i=t,t=null),!this.__loaded)return this.push(["get",t,i,s]);switch(i){case"client_id":a=this.STATE.clientId;break;case"user_id":a=this.STATE.userId;break;case"session_id":a=null===(r=this.sessionManager)||void 0===r?void 0:r.getSessionId();break;case"user_data":a=(null===(n=this.userManager)||void 0===n?void 0:n.getUserData())||{};break;case"consent_status":a=e({},this.STATE.consentStatus);break;case"debug_mode":a=this.CONFIG.debug;break;default:a=this.STATE.persistentParameters[i]}return"function"==typeof s&&s(a),a}push(t){this.__loaded?_(t)?this.rt([t]):b(t)&&t.call(this):s.trustdata&&_(s.trustdata)&&s.trustdata.push(t)}}ki.prototype.vt=function(){this.CONFIG.send_page_view&&this.__loaded&&this.event(L)},s.ft=s.ft||{},s.ut=!1;var Ri={};!(function(t,i){for(var e=0;e<5;e++)t.prototype[i[e]]=N(t.prototype[i[e]])})(ki,["event","set","get","consent","push"]),(function(){var t=new ki;Ri[Ti]=t;var i=s.trustdata;if(i&&_(i)){i.gt&&_(i.gt)&&R(i.gt,(function(e){if(e&&_(e)){var s=e[2]||Ti,r=t.config(e[0],e[1]||{},s);r&&s!==Ti&&i[s]&&_(i[s])&&r.rt(i[s])}}));for(var e=[],r=0;r<i.length;r++){var n=i[r];_(n)&&e.push(n)}e.length>0&&t.rt(e)}s.trustdata=t,(function(){function t(){t.done||(t.done=!0,Object.values(Ri).forEach((function(t){"function"==typeof t.vt&&t.vt()})))}o&&o.addEventListener?"complete"===o.readyState?t():o.addEventListener("DOMContentLoaded",t,{capture:!1,passive:!0}):s&&E.error("Browser doesn't support `document.addEventListener` so TrustData couldn't be initialized")})()})()})();
