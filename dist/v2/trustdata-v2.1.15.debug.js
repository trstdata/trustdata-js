!(function(){"use strict";function e(e,t,i){return(t=(function(e){var t=(function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return e+""})(e);return"symbol"==typeof t?t:t+""})(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function t(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function i(i){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?t(Object(n),!0).forEach((function(t){e(i,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))}))}return i}var s="undefined"!=typeof window?window:void 0,n="undefined"!=typeof globalThis?globalThis:s,r=Array.prototype.forEach,o=null==n?void 0:n.navigator,a=null==n?void 0:n.document,c=null==n?void 0:n.location,u=null==n?void 0:n.fetch,h=null!=n&&n.XMLHttpRequest&&"withCredentials"in new n.XMLHttpRequest?n.XMLHttpRequest:void 0,d=null==n?void 0:n.AbortController,l=null==o?void 0:o.userAgent,_=null!=s?s:{},g="1.0.0",f=Object.prototype,p=f.hasOwnProperty,m=f.toString,v=Array.isArray||function(e){return"[object Array]"===m.call(e)},S=e=>"function"==typeof e,y=e=>void 0===e,T=e=>"[object String]"==m.call(e),I=e=>null===e,b=e=>"[object Number]"==m.call(e),w=e=>{var t={_log:function(e){},info:function(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];t._log("log",...i)},warn:function(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];t._log("warn",...i)},error:function(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];t._log("error",...i)},critical:function(){for(var t=arguments.length,i=Array(t),s=0;s<t;s++)i[s]=arguments[s];console.error(e,...i)},uninitializedWarning:e=>{t.error("You must initialize TrustData before calling ".concat(e))},createLogger:t=>w("".concat(e," ").concat(t))};return t},E=w("[TrustData.js]"),O=E.createLogger,A={};function N(e,t,i){if(v(e))if(r&&e.forEach===r)e.forEach(t,i);else if("length"in e&&e.length===+e.length)for(var s=0,n=e.length;s<n;s++)if(s in e&&t.call(i,e[s],s)===A)return}function k(e,t,i){if(!y(s=e)&&!I(s)){var s;if(v(e))return N(e,t,i);if((e=>e instanceof FormData)(e)){for(var n of e.entries())if(t.call(i,n[1],n[0])===A)return}else for(var r in e)if(p.call(e,r)&&t.call(i,e[r],r)===A)return}}var x=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return N(i,(function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])})),e},C=function(e){return function(){try{for(var t=arguments.length,i=Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.apply(this,i)}catch(e){E.critical("Implementation error. Please turn on debug mode"),E.critical(e)}}};function D(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return e[i]}function R(e,t,i,s){var{capture:n=!1,passive:r=!0}={};null==e||e.addEventListener(t,i,{capture:n,passive:r})}var P=function(e,t,i){if(!e||!t||!t.length)return e;for(var s=e.split("#"),n=s[1],r=(s[0]||"").split("?"),o=r[1],a=r[0],c=(o||"").split("&"),u=[],h=0;h<c.length;h++){var d=c[h].split("=");v(d)&&(t.includes(d[0])?u.push(d[0]+"="+i):u.push(c[h]))}var l=a;return null!=o&&(l+="?"+u.join("&")),null!=n&&(l+="#"+n),l},M="cid",q="uid",W="udata",U="primary_window",F="fv",j=3e3,z="Mobile",K="Tablet",B="page_view",G="page_leave",L="event_name",Y="client_id",V="session_id",H="page_title",J="page_location",Q="page_referrer",X="event_time",Z="session_number",$="session_engaged",ee="first_visit",te="entrances",ie="ignore_referrer",se=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","trdt_cpid","trdt_agid","trdt_kwid","trdt_ctid","mc_cid","gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],ne=!!h||!!u,re=(e,t)=>{var[s,n]=e.split("?"),r=i({},t);null==n||n.split("&").forEach((e=>{var[t]=e.split("=");delete r[t]}));var o=(function(e,t){var i;void 0===t&&(t="&");var s=[];return k(e,(function(e,t){y(e)||y(t)||"undefined"===t||(i=encodeURIComponent(e instanceof File?e.name:""+e),s[s.length]=encodeURIComponent(t)+"="+i)})),s.join(t)})(r);return o=o?(n?n+"&":"")+o:n,"".concat(s,"?").concat(o)},oe=(e,t)=>JSON.stringify(e,((e,t)=>"bigint"==typeof t?""+t:t),t),ae=e=>{var{data:t,compression:i}=e;if(t){if("base64"===i){var s=(function(e){var t,i,s,n,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,a=0,c="",u=[];if(!e)return e;e=(function(e){var t,i,s,n,r="";for(t=i=0,s=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,n=0;n<s;n++){var o=e.charCodeAt(n),a=null;o<128?i++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),I(a)||(i>t&&(r+=e.substring(t,i)),r+=a,t=i=n+1)}return i>t&&(r+=e.substring(t,e.length)),r})(e);do{t=(n=e.charCodeAt(o++)<<16|e.charCodeAt(o++)<<8|e.charCodeAt(o++))>>12&63,i=n>>6&63,s=63&n,u[a++]=r.charAt(n>>18&63)+r.charAt(t)+r.charAt(i)+r.charAt(s)}while(o<e.length);switch(c=u.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c})(oe(t)),n=(e=>"data="+encodeURIComponent("string"==typeof e?e:oe(e)))(s);return{contentType:"application/x-www-form-urlencoded",body:n,estimatedSize:new Blob([n]).size}}var r=oe(t);return{contentType:"application/json",body:r,estimatedSize:new Blob([r]).size}}},ce=[];function ue(e,t,i,s,n){return b(e)?e>i?(E.warn(s+" cannot be greater than max: "+i+". Using max value instead."),i):e<t?(E.warn(s+" cannot be less than min: "+t+". Using min value instead."),t):e:(E.warn(s+" must be a number. using max or fallback. max: "+i+", fallback: "+n),ue(n||i,t,i,s))}u&&ce.push({transport:"fetch",method:e=>{var t,s,{contentType:n,body:r,estimatedSize:o}=null!==(t=ae(e))&&void 0!==t?t:{},a=new Headers;k(e.headers,(function(e,t){a.append(t,e)})),n&&a.append("Content-Type",n);var c=e.url,h=null;if(d){var l=new d;h={signal:l.signal,timeout:setTimeout((()=>l.abort()),e.timeout)}}u(c,i({method:(null==e?void 0:e.method)||"GET",headers:a,keepalive:"POST"===e.method&&(o||0)<52428.8,body:r,signal:null===(s=h)||void 0===s?void 0:s.signal},e.fetchOptions)).then((t=>t.text().then((i=>{var s,n={statusCode:t.status,text:i};if(200===t.status)try{n.json=JSON.parse(i)}catch(e){E.error(e)}null===(s=e.callback)||void 0===s||s.call(e,n)})))).catch((t=>{var i;E.error(t),null===(i=e.callback)||void 0===i||i.call(e,{statusCode:0,text:t})})).finally((()=>h?clearTimeout(h.timeout):null))}}),h&&ce.push({transport:"XHR",method:e=>{var t,i=new h;i.open(e.method||"GET",e.url,!0);var{contentType:s,body:n}=null!==(t=ae(e))&&void 0!==t?t:{};k(e.headers,(function(e,t){i.setRequestHeader(t,e)})),s&&i.setRequestHeader("Content-Type",s),e.timeout&&(i.timeout=e.timeout),i.withCredentials=!0,i.onreadystatechange=()=>{if(4===i.readyState){var t,s={statusCode:i.status,text:i.responseText};if(200===i.status)try{s.json=JSON.parse(i.responseText)}catch{}null===(t=e.callback)||void 0===t||t.call(e,s)}},i.send(n)}}),null!=o&&o.sendBeacon&&ce.push({transport:"sendBeacon",method:e=>{var t=re(e.url,{beacon:"1"});try{var i,{contentType:s,body:n}=null!==(i=ae(e))&&void 0!==i?i:{},r="string"==typeof n?new Blob([n],{type:s}):n;o.sendBeacon(t,r)}catch{}}});class he{constructor(e,t){this._isPaused=!0,this._queue=[],this._flushTimeout=void 0,this._flushTimeoutMs=ue((null==t?void 0:t.flush_interval_ms)||j,250,5e3,"flush interval",j),this._sendRequest=e}enqueue(e){this._queue.push(e),this._flushTimeout||this._setFlushTimeout()}unload(){this._clearFlushTimeout();var e=this._queue.length>0?this._formatQueue():{},t=Object.values(e);[...t.filter((e=>0===e.url.indexOf("/e"))),...t.filter((e=>0!==e.url.indexOf("/e")))].map((e=>{this._sendRequest(i(i({},e),{},{transport:"sendBeacon"}))}))}enable(){this._isPaused=!1,this._setFlushTimeout()}_setFlushTimeout(){var e=this;this._isPaused||(this._flushTimeout=setTimeout((()=>{if(this._clearFlushTimeout(),this._queue.length>0){var t=this._formatQueue(),i=function(){var i=t[s],n=(new Date).getTime();i.data&&v(i.data)&&k(i.data,(e=>{e.offset=Math.abs(e.timestamp-n),delete e.timestamp})),e._sendRequest(i)};for(var s in t)i()}}),this._flushTimeoutMs))}_clearFlushTimeout(){clearTimeout(this._flushTimeout),this._flushTimeout=void 0}_formatQueue(){var e={};return k(this._queue,(t=>{var s,n=t,r=(n?n.batchKey:null)||n.url;y(e[r])&&(e[r]=i(i({},n),{},{data:[]})),null===(s=e[r].data)||void 0===s||s.push(n.data)})),this._queue=[],e}}var de=["retriesPerformedSoFar"];class le{constructor(e){this._instance=e,this._isPolling=!1,this._poller=void 0,this._pollIntervalMs=3e3,this._queue=[],this._areWeOnline=!0,!y(s)&&"onLine"in s.navigator&&(this._areWeOnline=s.navigator.onLine,R(s,"online",(()=>{this._areWeOnline=!0,this._flush()})),R(s,"offline",(()=>{this._areWeOnline=!1})))}get length(){return this._queue.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,s=(function(e,t){if(null==e)return{};var i,s,n=(function(e,t){if(null==e)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;i[s]=e[s]}return i})(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)-1===t.indexOf(i=r[s])&&{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n})(e,de);b(t)&&t>0&&(s.url=re(s.url,{retry_count:t})),this._instance._send_request(i(i({},s),{},{callback:e=>{var n;200!==e.statusCode&&(e.statusCode<400||e.statusCode>=500)&&(null!=t?t:0)<10?this._enqueue(i({retriesPerformedSoFar:t},s)):null===(n=s.callback)||void 0===n||n.call(s,e)}}))}_enqueue(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var i=(function(e){var t=3e3*2**e,i=t/2,s=Math.min(18e5,t),n=Math.random()-.5;return Math.ceil(s+n*(s-i))})(t),s=Date.now()+i;this._queue.push({retryAt:s,requestOptions:e});var n="Enqueued failed request for retry in ".concat(i);navigator.onLine||(n+=" (Browser is offline)"),E.warn(n),this._isPolling||(this._isPolling=!0,this._poll())}_poll(){this._poller&&clearTimeout(this._poller),this._poller=setTimeout((()=>{this._areWeOnline&&this._queue.length>0&&this._flush(),this._poll()}),this._pollIntervalMs)}_flush(){var e=Date.now(),t=[],i=this._queue.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this._queue=t,i.length>0)for(var{requestOptions:s}of i)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this._poller&&(clearTimeout(this._poller),this._poller=void 0),this._queue))try{this._instance._send_request(i(i({},e),{},{transport:"sendBeacon"}))}catch(e){E.error(e)}this._queue=[]}}function _e(){return Date.now().toString(36)+Math.random().toString(36).substring(2,9)}function ge(){return Math.floor(Date.now()/1e3)}var fe="",pe=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,me={is_supported:()=>!!a,error:function(e){E.error("cookieStore error: "+e)},get:function(e){if(a){try{for(var t=e+"=",i=a.cookie.split(";").filter((e=>e.length)),s=0;s<i.length;s++){for(var n=i[s];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}}catch{}return null}},parse:function(e){var t;try{t=JSON.parse(me.get(e))||{}}catch{}return t},set:function(e,t,i,s,n){if(a)try{var r="",o="",c=(function(e,t){if(t){var i=(function(e,t){if(void 0===t&&(t=a),fe)return fe;if(!t)return"";if(["localhost","127.0.0.1"].includes(e))return"";for(var i=e.split("."),s=Math.min(i.length,8),n="dmn_chk_"+_e(),r=RegExp("(^|;)\\s*"+n+"=1");!fe&&s--;){var o=i.slice(s).join("."),c=n+"=1;domain=."+o;t.cookie=c,r.test(t.cookie)&&(t.cookie=c+";expires=Thu, 01 Jan 1970 00:00:00 GMT",fe=o)}return fe})(e);if(!i){var s=(e=>{var t=e.match(pe);return t?t[0]:""})(e);s!==i&&E.info("Warning: cookie subdomain discovery mismatch",s,i),i=s}return i?"; domain=."+i:""}return""})(a.location.hostname,s);if(i){var u=new Date;u.setTime(u.getTime()+24*i*60*60*1e3),r="; expires="+u.toUTCString()}n&&(o="; secure");var h=e+"="+encodeURIComponent(JSON.stringify(t))+r+"; SameSite=Lax; path=/"+c+o;return h.length>3686.4&&E.warn("cookieStore warning: large cookie, len="+h.length),a.cookie=h,h}catch{return}},remove:function(e,t){try{me.set(e,"",-1,t)}catch{return}}},ve=null,Se={is_supported:function(){if(!I(ve))return ve;var e=!0;if(y(s))e=!1;else try{var t="__mplssupport__";Se.set(t,"xyz"),'"xyz"'!==Se.get(t)&&(e=!1),Se.remove(t)}catch{e=!1}return e||E.error("localStorage unsupported; falling back to cookie store"),ve=e,e},error:function(e){E.error("localStorage error: "+e)},get:function(e){try{return s&&s.localStorage.getItem(e)}catch(e){Se.error(e)}return null},parse:function(e){try{return JSON.parse(Se.get(e))||{}}catch{}return null},set:function(e,t){try{s&&s.localStorage.setItem(e,JSON.stringify(t))}catch(e){Se.error(e)}},remove:function(e){try{s&&s.localStorage.removeItem(e)}catch(e){Se.error(e)}}},ye=[M,q,W,"sid","sn","last","start","wid",U,F],Te=i(i({},Se),{},{parse:function(e){try{var t={};try{t=me.parse(e)||{}}catch{}var i=x(t,JSON.parse(Se.get(e)||"{}"));return Se.set(e,i),i}catch{}return null},set:function(e,t,i,s,n,r){try{Se.set(e,t,void 0,void 0,r);var o={};ye.forEach((e=>{t[e]&&(o[e]=t[e])})),Object.keys(o).length&&me.set(e,o,i,s,n,r)}catch(e){Se.error(e)}},remove:function(e,t){try{s&&s.localStorage.removeItem(e),me.remove(e,t)}catch(e){Se.error(e)}}});function Ie(e,t){return-1!==e.indexOf(t)}var be=z,we="iOS",Ee="Android",Oe=K,Ae=Ee,Ne="iPad",ke="Apple",xe=ke+" Watch",Ce="Safari",De="BlackBerry",Re="Samsung",Pe=Re+"Browser",Me=Re+" Internet",qe="Chrome",We=qe+" OS",Ue=qe+" "+we,Fe="Internet Explorer",je=Fe,ze="Opera",Ke=ze+" Mini",Be="Edge",Ge="Edge",Le="Firefox",Ye=Le+" "+we,Ve="Nintendo",He="PlayStation",Je="Xbox",Qe=Ee,Xe=Ce,Ze="Windows",$e=Ze+" Phone",et="Nokia",tt="Ouya",it="Generic",st=it+" "+be.toLowerCase(),nt=it+" "+Oe.toLowerCase(),rt="Konqueror",ot="(\\d+(\\.\\d+)?)",at=RegExp("Version/"+ot),ct=RegExp(Je,"i"),ut=RegExp(He+" \\w+","i"),ht=RegExp(Ve+" \\w+","i"),dt=RegExp(De+"|PlayBook|BB10","i"),lt={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},_t=function(e,t){return t=t||"",Ie(e," OPR/")&&Ie(e,"Mini")?Ke:Ie(e," OPR/")?ze:dt.test(e)?De:Ie(e,"IE"+be)||Ie(e,"WPDesktop")?je:Ie(e,Pe)?Me:Ie(e,Be)||Ie(e,"Edg/")?Ge:Ie(e,"FBIOS")?"Facebook "+be:Ie(e,"UCWEB")||Ie(e,"UCBrowser")?"UC Browser":Ie(e,"CriOS")?Ue:Ie(e,"CrMo")||Ie(e,qe)?qe:Ie(e,Ee)&&Ie(e,Ce)?Qe:Ie(e,"FxiOS")?Ye:Ie(e.toLowerCase(),"konqueror")?rt:((e,t)=>t&&Ie(t,ke)||(function(e){return Ie(e,Ce)&&!Ie(e,qe)&&!Ie(e,Ee)})(e))(e,t)?Ie(e,be)?Xe:Ce:Ie(e,Le)?Le:Ie(e,"MSIE")||Ie(e,"Trident/")?Fe:Ie(e,"Gecko")?Le:""},gt={[je]:[RegExp("rv:"+ot)],[Ge]:[RegExp(Be+"?\\/"+ot)],[qe]:[RegExp("("+qe+"|CrMo)\\/"+ot)],[Ue]:[RegExp("CriOS\\/"+ot)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+ot)],[Ce]:[at],[Xe]:[at],[ze]:[RegExp("(Opera|OPR)\\/"+ot)],[Le]:[RegExp(Le+"\\/"+ot)],[Ye]:[RegExp("FxiOS\\/"+ot)],[rt]:[RegExp("Konqueror[:/]?"+ot,"i")],[De]:[RegExp(De+" "+ot),at],[Qe]:[RegExp("android\\s"+ot,"i")],[Me]:[RegExp(Pe+"\\/"+ot)],[Fe]:[RegExp("(rv:|MSIE )"+ot)],Mozilla:[RegExp("rv:"+ot)]},ft=function(e,t){var i=_t(e,t),s=gt[i];if(y(s))return null;for(var n=0;n<s.length;n++){var r=e.match(s[n]);if(r)return parseFloat(r[r.length-2])}return null},pt=[[RegExp(Je+"; "+Je+" (.*?)[);]","i"),e=>[Je,e&&e[1]||""]],[RegExp(Ve,"i"),[Ve,""]],[RegExp(He,"i"),[He,""]],[dt,[De,""]],[RegExp(Ze,"i"),(e,t)=>{if(/Phone/.test(t)||/WPDesktop/.test(t))return[$e,""];if(RegExp(be).test(t)&&!/IEMobile\b/.test(t))return[Ze+" "+be,""];var i=/Windows NT ([0-9.]+)/i.exec(t);if(i&&i[1]){var s=lt[i[1]]||"";return/arm/i.test(t)&&(s="RT"),[Ze,s]}return[Ze,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,e=>e&&e[3]?[we,[e[3],e[4],e[5]||"0"].join(".")]:[we,""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,e=>{var t="";return e&&e.length>=3&&(t=y(e[2])?e[3]:e[2]),["watchOS",t]}],[RegExp("("+Ee+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Ee+")","i"),e=>e&&e[2]?[Ee,[e[2],e[3],e[4]||"0"].join(".")]:[Ee,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,e=>{var t=["Mac OS X",""];return e&&e[1]&&(t[1]=[e[1],e[2],e[3]||"0"].join(".")),t}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[We,""]],[/Linux|debian/i,["Linux",""]]],mt=function(e){return ht.test(e)?Ve:ut.test(e)?He:ct.test(e)?Je:RegExp(tt,"i").test(e)?tt:RegExp("("+$e+"|WPDesktop)","i").test(e)?$e:/iPad/.test(e)?Ne:/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(e)?xe:dt.test(e)?De:/(kobo)\s(ereader|touch)/i.test(e)?"Kobo":RegExp(et,"i").test(e)?et:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(e)||/(kf[a-z]+)( bui|\)).+silk\//i.test(e)?"Kindle Fire":/(Android|ZTE)/i.test(e)?!RegExp(be).test(e)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(e)?/pixel[\daxl ]{1,6}/i.test(e)&&!/pixel c/i.test(e)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(e)||/lmy47v/i.test(e)&&!/QTAQZ3/i.test(e)?Ee:Ae:Ee:RegExp("(pda|"+be+")","i").test(e)?st:RegExp(Oe,"i").test(e)&&!RegExp(Oe+" pc","i").test(e)?nt:""},vt="<masked>";function St(){return navigator.language||navigator.userLanguage}function yt(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Tt(){try{return(new Date).getTimezoneOffset()}catch{return}}class It{constructor(e){this._config=e.CONFIG,this._persistentStore=void 0,this._state=e.STATE}get consent(){return this._getDnt()?0:this._storedConsent}isOptedOut(){return 0===this.consent||-1===this.consent&&this._config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this._storage.set(this._storageKey,e?1:0,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie),this._state&&(this._state.consentStatus=i(i({},this._state.consentStatus),{},{analytics:e}))}reset(){this._storage.remove(this._storageKey,this._config.cross_subdomain_cookie)}get _storageKey(){var{attribution_ids:e,opt_out_capturing_cookie_prefix:t}=this._config;return(t||"__tr_opt_in_out_")+e[0]}get _storedConsent(){var e=this._storage.get(this._storageKey);return"1"===e?1:"0"===e?0:-1}get _storage(){if(!this._persistentStore){var e=this._config.opt_out_capturing_persistence_type;this._persistentStore="localStorage"===e?Se:me;var t="localStorage"===e?me:Se;t.get(this._storageKey)&&(this._persistentStore.get(this._storageKey)||this.optInOut("1"===t.get(this._storageKey)),t.remove(this._storageKey,this._config.cross_subdomain_cookie))}return this._persistentStore}_getDnt(){return!!this._config.respect_dnt&&!!D([null==o?void 0:o.doNotTrack,null==o?void 0:o.msDoNotTrack,_.doNotTrack],(e=>Ie([!0,1,"1","yes"],e)))}}class bt{constructor(e){this.logger=O("[SessionManager]"),E.info("SessionManager constructor called"),this._config=e.CONFIG,this._state=e.STATE,this._consent=e.consentManager,this._persistence=e.persistence;var t=this._config.persistence_name||"_trdt";this.SESSION_DATA_KEY=t+"_sdata",this.SESSION_NUMBER_KEY=t+"_sn",this.WINDOW_ID_KEY=t+"_wid",this.PRIMARY_WINDOW_KEY=t+"_"+U,E.info("Session storage keys:",{SESSION_DATA_KEY:this.SESSION_DATA_KEY,SESSION_NUMBER_KEY:this.SESSION_NUMBER_KEY,WINDOW_ID_KEY:this.WINDOW_ID_KEY,PRIMARY_WINDOW_KEY:this.PRIMARY_WINDOW_KEY}),this._sessionId=null,this._sessionActivityTimestamp=null,this._sessionStartTimestamp=null,this._sessionNumber=null,this.windowId=null,this.sessionChangeHandlers=[],this.sessionTimer=null,this._initWindowTracking(),this.initSession(!0),E.info("SessionManager initialized with session data:",{sessionId:this._sessionId,activityTimestamp:this._sessionActivityTimestamp,startTimestamp:this._sessionStartTimestamp,windowId:this.windowId,sessionNumber:this._sessionNumber})}_getSessionTimeoutMs(){return 60*Math.min(Math.max(this._config.sessionTimeout||30,1),600)*1e3}_canUseStorage(){var e=this._consent.isOptedIn()&&!this._config.disable_persistence&&this._persistence;return E.info("Can use storage:",e,{isOptedIn:this._consent.isOptedIn(),disable_persistence:this._config.disable_persistence,persistence:!!this._persistence}),e}_canUseSessionStorage(){try{var e="undefined"!=typeof sessionStorage&&null!==sessionStorage;return E.info("Can use sessionStorage:",e),e}catch(e){return E.error("Error accessing sessionStorage:",e),!1}}_getWindowId(){if(this.windowId)return this.windowId;if(this._canUseSessionStorage())try{var e=sessionStorage.getItem(this.WINDOW_ID_KEY);if(e)return E.info("Retrieved window ID from sessionStorage:",e),e}catch(e){E.error("Error reading window ID from sessionStorage:",e)}return null}_setWindowId(e){if(e!==this.windowId&&(E.info("Setting window ID:",e),this.windowId=e,this._canUseSessionStorage()))try{sessionStorage.setItem(this.WINDOW_ID_KEY,e)}catch(e){E.error("Error storing window ID in sessionStorage:",e)}}_initWindowTracking(){if(E.info("Initializing window tracking"),this._canUseSessionStorage())try{var e=sessionStorage.getItem(this.WINDOW_ID_KEY),t=sessionStorage.getItem(this.PRIMARY_WINDOW_KEY);E.info("Window tracking state:",{lastWindowId:e,primaryWindowExists:t}),e&&!t?(this.windowId=e,E.info("Using existing window ID:",e)):(sessionStorage.removeItem(this.WINDOW_ID_KEY),E.info("Removed previous window ID")),sessionStorage.setItem(this.PRIMARY_WINDOW_KEY,"true"),window.addEventListener("beforeunload",(()=>{sessionStorage.removeItem(this.PRIMARY_WINDOW_KEY),E.info("Window unloading, removed PRIMARY_WINDOW_KEY")}))}catch(e){E.error("Error initializing window tracking:",e)}}_setSessionData(e,t,i){if(E.info("Setting session data:",{sessionId:e,activityTimestamp:t,startTimestamp:i}),e!==this._sessionId||t!==this._sessionActivityTimestamp||i!==this._sessionStartTimestamp)if(this._sessionId=e,this._sessionActivityTimestamp=t,this._sessionStartTimestamp=i,this._canUseStorage())try{var s=[t,e,i];if(E.info("Storing session data:",s),!this._persistence||"function"!=typeof this._persistence.set)return void E.error("Persistence layer is not properly initialized");this._persistence.set(this.SESSION_DATA_KEY,JSON.stringify(s),this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie);var n=this._persistence.get(this.SESSION_DATA_KEY);E.info("Verification - stored session data:",n)}catch(e){E.error("Error storing session data:",e)}else E.info("Not storing session data - storage not available");else E.info("No changes to session data, skipping update")}_getSessionData(){if(E.info("Getting session data"),this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return E.info("Using in-memory session data:",[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp]),[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];if(this._canUseStorage())try{var e=this._persistence.get(this.SESSION_DATA_KEY);if(E.info("Raw session data from storage:",e),e){var t=JSON.parse(e);if(E.info("Parsed session data:",t),Array.isArray(t))return 2===t.length&&(t.push(t[0]),E.info("Added missing startTimestamp:",t)),this._sessionActivityTimestamp=t[0],this._sessionId=t[1],this._sessionStartTimestamp=t[2],t;E.error("Stored session data is not an array:",t)}else E.info("No session data found in storage")}catch(e){E.error("Error reading session data:",e)}else E.info("Storage not available for getting session data");return E.info("Returning default session data"),[0,null,0]}_getSessionNumber(){if(this._sessionNumber)return E.info("Using in-memory session number:",this._sessionNumber),this._sessionNumber;if(this._canUseStorage())try{var e=this._persistence.get(this.SESSION_NUMBER_KEY);if(E.info("Raw session number from storage:",e),e){var t=parseInt(e)||1;return this._sessionNumber=t,E.info("Parsed session number:",t),t}}catch(e){E.error("Error reading session number:",e)}return E.info("Using default session number: 1"),1}_setSessionNumber(e){if(E.info("Setting session number:",e),this._sessionNumber=e,this._canUseStorage())try{this._persistence.set(this.SESSION_NUMBER_KEY,""+e,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie);var t=this._persistence.get(this.SESSION_NUMBER_KEY);E.info("Verification - stored session number:",t)}catch(e){E.error("Error storing session number:",e)}else E.info("Not storing session number - storage not available")}_isSessionTooLong(e,t){var i=864e5,s=e>0&&t-e>i;return E.info("Checking if session is too long:",{startTimestamp:e,now:t,difference:t-e,maxLength:i,isTooLong:s}),s}checkAndGetSessionAndWindowId(e,t){void 0===e&&(e=!1),void 0===t&&(t=null),E.info("checkAndGetSessionAndWindowId called, readOnly:",e);var i=t||(new Date).getTime();if(this._canUseStorage()){var s=this._persistence.get(this.SESSION_DATA_KEY);E.info("Raw session data before processing:",s);try{s&&E.info("Parsed raw session data:",JSON.parse(s))}catch(e){E.error("Error parsing raw session data:",e)}}var[n,r,o]=this._getSessionData(),a=this._getWindowId(),c=this._getSessionNumber();E.info("Current session state:",{lastActivityTimestamp:n,sessionId:r,startTimestamp:o,windowId:a,sessionNumber:c,timestamp:i});var u=o>0&&i-o>864e5,h=!1,d=!r,l=!e&&n>0&&i-n>this._getSessionTimeoutMs();E.info("Session conditions:",{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u,timeoutMs:this._getSessionTimeoutMs(),timeSinceLastActivity:n>0?i-n:"N/A"}),d||l||u?(E.info("Creating new session due to:",{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}),r=ge(),a=_e(),o=i,c++,this._setSessionNumber(c),h=!0):a?E.info("Keeping existing session and window IDs"):(a=_e(),h=!0,E.info("Created new window ID:",a));var _=0===n||!e||u?i:n;E.info("Activity timestamp calculation:",{lastActivityTimestamp:n,readOnly:e,sessionPastMaximumLength:u,newActivityTimestamp:_});var g=0===o?i:o;return this._setWindowId(a),this._setSessionData(r,_,g),this._state?(this._state.sessionId=r,this._state.sessionNumber=c,this._state.sessionEngaged=!h,this._state.isNewVisit=h,E.info("Updated state:",{sessionId:this._state.sessionId,sessionNumber:this._state.sessionNumber,sessionEngaged:this._state.sessionEngaged,isNewVisit:this._state.isNewVisit})):E.error("State object is not available"),e||this.refreshSessionTimer(),h&&this._notifySessionChange(r,a,h?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0),E.info("Final session state:",{sessionId:r,windowId:a,sessionStartTimestamp:g,sessionNumber:c,changeReason:h?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0,lastActivityTimestamp:_}),{sessionId:r,windowId:a,sessionStartTimestamp:g,sessionNumber:c,changeReason:h?{noSessionId:d,activityTimeout:l,sessionPastMaximumLength:u}:void 0,lastActivityTimestamp:_}}initSession(e){return void 0===e&&(e=!1),E.info("initSession called, readOnly:",e),this.checkAndGetSessionAndWindowId(e)}refreshSessionTimer(){E.info("Refreshing session timer"),clearTimeout(this.sessionTimer);var e=1.1*this._getSessionTimeoutMs();E.info("Setting session timeout for ".concat(e,"ms")),this.sessionTimer=setTimeout((()=>{E.info("Session timeout reached, resetting session"),this.resetSession()}),e)}resetSession(){E.info("Resetting session"),this._setSessionData(null,0,0),this.initSession()}onSessionChange(e){return E.info("Registering session change handler"),this.sessionChangeHandlers.push(e),this._sessionId&&(E.info("Calling session change handler immediately with existing session:",this._sessionId),e(this._sessionId,this.windowId)),()=>{E.info("Unregistering session change handler"),this.sessionChangeHandlers=this.sessionChangeHandlers.filter((t=>t!==e))}}_notifySessionChange(e,t,i){E.info("Notifying session change handlers:",{handlers:this.sessionChangeHandlers.length,sessionId:e,windowId:t,reason:i}),this.sessionChangeHandlers.forEach((s=>{try{s(e,t,i)}catch(e){E.error("Error in session change handler:",e)}}))}getSessionId(){var e=this._sessionId||this._state&&this._state.sessionId||null;return E.info("getSessionId called, returning:",e),e}getWindowId(){var e=this._getWindowId();return E.info("getWindowId called, returning:",e),e}}class wt{constructor(e){this._config=e.CONFIG,this._state=e.STATE,this._persistence=e.persistence,this._consent=e.consentManager,this.clientId=null,this.isFirstVisit=!1}initClientId(e){void 0===e&&(e={}),E.info("Initializing client ID");var t=this._canUseStorage(),i=this._config.persistence_name||"_trdt",s=e.client_id;if(!s&&t&&(s=this._persistence.get(i+"_"+M))&&s.startsWith('"')&&s.endsWith('"'))try{s=JSON.parse(s)}catch(e){E.error("Error parsing stored client ID",e)}var n=t&&this._persistence.get(i+"_"+F);return s?(this.clientId=s,this.isFirstVisit=!n):(this.clientId=Math.floor(2147483647*Math.random())+"."+ge(),this.isFirstVisit=!0,t&&(this._storeClientId(this.clientId),this._storeFirstVisitMarker())),this._state.clientId=this.clientId,this._state.isFirstVisit=this.isFirstVisit,this.clientId}_storeClientId(e){if(this._canUseStorage()){var t=this._config.persistence_name||"_trdt",i=this._config.cookie_expiration,s=this._config.cross_subdomain_cookie,n=this._config.secure_cookie,r=e&&"string"==typeof e&&e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e;this._persistence.set(t+"_"+M,r,i,s,n)}}_storeFirstVisitMarker(){if(this._canUseStorage()&&this.isFirstVisit){var e=this._config.persistence_name||"_trdt",t=this._config.cookie_expiration,i=this._config.cross_subdomain_cookie,s=this._config.secure_cookie,n=""+Date.now();this._persistence.set(e+"_"+F,n,t,i,s)}}setClientId(e){if(!e)return!1;var t=e&&"string"==typeof e&&e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e;return this.clientId=t,this._state.clientId=t,this._canUseStorage()&&this._storeClientId(t),!0}getClientId(){return this.clientId}_canUseStorage(){return this._consent.isOptedIn()&&!this._config.disable_persistence}}class Et{constructor(e){this._config=e.CONFIG,this._state=e.STATE,this._persistence=e.persistence,this._consent=e.consentManager,this.userId=null,this.userData={},this.identifiers={}}initUser(e){void 0===e&&(e={}),E.info("Initializing user data");var t=this._canUseStorage(),i=this._config.persistence_name||"_trdt";if(this.userId=e.user_id||t&&this._persistence.get(i+"_"+q),t)try{var s=this._persistence.get(i+"_"+W);s&&(this.userData=JSON.parse(s))}catch(e){E.error("Error parsing stored user data",e),this.userData={}}return this._state.userId=this.userId,this.userData}setUserId(e){return!!e&&(this.userId=e,this._state.userId=e,this._canUseStorage()&&this._persistence.set((this._config.persistence_name||"_trdt")+"_"+q,e,this._config.cookie_expiration,this._config.cross_subdomain_cookie,this._config.secure_cookie),!0)}setUserData(e){if((t=e)!==Object(t)||v(t))return!1;var t;if(this.userData=i(i({},this.userData),e),this._canUseStorage()){var s=this._config.cookie_expiration,n=this._config.cross_subdomain_cookie,r=this._config.secure_cookie;this._persistence.set((this._config.persistence_name||"_trdt")+"_"+W,JSON.stringify(this.userData),s,n,r)}return!0}setIdentifier(e,t){return!(!T(e)||!T(t)||(this.identifiers[e]=t,0))}getUserData(){return i(i({},this.userData),this.identifiers)}getUserId(){return this.userId}_canUseStorage(){return this._consent.isOptedIn()&&!this._config.disable_persistence}}var Ot=()=>{},At="trustdata";!ne&&-1===(null==l?void 0:l.indexOf("MSIE"))&&(null==l||l.indexOf("Mozilla"));class Nt{__loaded=!1;CONFIG=(()=>{var e;return{api_host:"https://t.trstdata.com",api_endpoint:"/api/events",attribution_ids:[],ignore_referrer_domains:[],cross_subdomain_cookie:!0,persistence:"localStorage+cookie",persistence_name:"_trdt",debug:!1,loaded:Ot,cookie_expiration:365,disable_persistence:!1,disable_compression:!0,secure_cookie:s&&"https:"===(null===(e=s.location)||void 0===e?void 0:e.protocol),request_batching:!0,properties_string_max_length:65535,session_timeout:30,on_request_error:e=>{E.error("Bad HTTP status: "+e.statusCode+" "+e.text)},send_page_view:!0,onCapture:Ot,flush_interval_ms:j}})();constructor(){this.STATE={clientId:null,userId:null,sessionId:null,sessionNumber:1,sessionEngaged:!1,isNewVisit:!1,isFirstVisit:!1,ignoreReferrer:!1,consentStatus:{analytics:!1,advertising:!1,personalization:!1},persistentParameters:{},initializedTargets:new Set},this.logger=O("[TrustData.js]"),this.consentManager=new It(this)}config(e,t,i){var s;if(void 0===t&&(t={}),void 0===i&&(i=null),!i||i===At)return this._config(e,t,i);var n=null!==(s=kt[i])&&void 0!==s?s:new Nt;return n._config(e,t,i),kt[i]=n,kt[At][i]=n,n}_execute_array(e){if(v(e)){var t=[],i=[],s=[];k(e,(e=>{if(e){var n=e[0];v(n)?s.push(e):S(e)?e.call(this):v(e)&&"config"===n?t.push(e):v(e)&&-1!==n.indexOf("event")&&S(this[n])?s.push(e):i.push(e)}}));var n=e=>{k(e,(e=>{if(v(e[0])){var t=this;k(e,(e=>{t=t[e[0]].apply(t,e.slice(1))}))}else"function"==typeof this[e[0]]?this[e[0]].apply(this,e.slice(1)):E.warn("Unknown command:",e[0])}))};n(t),n(i),n(s)}}_config(e,t,i){return void 0===t&&(t={}),this.__loaded?(E.warn("You have already initialized TrustData! Re-initializing is a no-op"),this):(e&&!this.CONFIG.attribution_ids.includes(e)&&this.CONFIG.attribution_ids.push(e),e?(t.ignoreReferrerDomains&&(this.CONFIG.ignore_referrer_domains=Array.isArray(t.ignoreReferrerDomains)?t.ignoreReferrerDomains:[t.ignoreReferrerDomains]),Object.keys(t).forEach((e=>{e in this.CONFIG&&(this.CONFIG[e]=t[e])})),t.consent&&this.consent("update",{consent:t.consent}),this._initPersistence(),this._requestQueue=new he((e=>this._send_retriable_request(e)),{flush_interval_ms:this.CONFIG.flush_interval_ms}),this._retryQueue=new le(this),this.clientManager=new wt(this),this.userManager=new Et(this),this.clientManager.initClientId(t),this.userManager.initUser(t),this.sessionManager=new bt(this),this.__loaded=!0,E.info("TrustData initialized with target ID:",e),this.consentManager.isOptedIn()&&this.CONFIG.request_batching&&(E.info("Enabling request queue"),this._requestQueue.enable()),this._setupUnloadHandlers(),s._trdt_uat_ready=!0,e&&this.STATE.initializedTargets.add(e),!1!==t.send_page_view&&(E.info("Scheduling page view event"),setTimeout((()=>this.event(B,{send_to:e})),50)),"function"==typeof this.CONFIG.loaded&&this.CONFIG.loaded(this),!0):(E.critical("TrustData was initialized without a target ID. This likely indicates a misconfiguration."),this))}_initPersistence(){var e=this.CONFIG;this.persistence="localStorage"===e.persistence?Se:"cookie"===e.persistence?me:Te,this.sessionPersistence="sessionStorage"===this.CONFIG.persistence?this.persistence:i(i({},this.persistence),{},{persistence:"sessionStorage"}),this.persistence_name=e.persistence_name||"_trdt"}_setupUnloadHandlers(){var e="onpagehide"in self?"pagehide":"unload";s.addEventListener(e,this._handle_unload.bind(this),{passive:!1})}_handle_unload(){this.CONFIG.request_batching?(this.event(G),this._requestQueue.unload(),this._retryQueue.unload()):this.event(G,null,{transport:"sendBeacon"})}set(e,t){if(!this.__loaded)return E.info("TrustData not initialized, queueing set command"),this.push(["set",e,t]);if("object"==typeof e)return Object.entries(e).forEach((e=>{var[t,i]=e;return this.set(t,i)})),!0;if("function"==typeof t)try{t=t()}catch(e){return E.error("Error processing function value:",e),!1}switch("string"==typeof t&&(t=t.substring(0,100)),E.info("Setting property:",e,t),e){case"user_id":this.STATE.userId=t,this.userManager.setUserId(t);break;case"client_id":this.clientManager.setClientId(t);break;case"debug_mode":this.CONFIG.debug=!0===t||"true"===t;break;case"page_referrer":case"page_location":case"page_title":case"ignore_referrer":this.STATE.persistentParameters[e]=t,"ignore_referrer"===e&&(this.STATE.ignoreReferrer=!0===t||"true"===t);break;case"user_data":"object"==typeof t&&this.userManager.setUserData(t);break;case"email_hash":case"phone_hash":this.userManager.setIdentifier(e,t);break;default:this.STATE.persistentParameters[e]=t}return!0}event(e,t,s){if(void 0===t&&(t={}),void 0===s&&(s={}),!e)return E.error("Missing event name"),!1;if(!this.__loaded)return E.info("TrustData not initialized, queueing event:",e),this.push(["event",e,t,s]);E.info("Processing event: ".concat(e)),this.STATE.sessionEngaged=!0,t&&t.hasOwnProperty("ignore_referrer")&&(this.STATE.ignoreReferrer=!0===t.ignore_referrer,delete t.ignore_referrer),t&&["page_referrer","page_location","page_title"].forEach((e=>{t.hasOwnProperty(e)&&(this.STATE.persistentParameters[e]=t[e])}));var n=this.CONFIG.attribution_ids;t&&t.send_to&&(n=Array.isArray(t.send_to)?t.send_to:[t.send_to],delete t.send_to);var r=n.filter((e=>this.STATE.initializedTargets.has(e)));0===r.length&&this.CONFIG.attribution_ids.length>0&&(r=[this.CONFIG.attribution_ids[0]]);var o=this.STATE.isFirstVisit,a=this.STATE.isNewVisit,c=this._createEventPayload(e,t);return r.forEach((e=>{var t=i(i({},c),{},{attribution_id:e}),n={method:"POST",url:this.CONFIG.api_host+this.CONFIG.api_endpoint,data:t,compression:this.CONFIG.disable_compression?void 0:"gzip-js",batchKey:e};s&&s.transport&&(n.transport=s.transport),E.info("Sending event to ".concat(e),n.data),this.CONFIG.request_batching&&!s.send_instantly?(E.info("Enqueueing event in request queue"),this._requestQueue.enqueue(n)):(E.info("Sending event immediately"),this._send_retriable_request(n))})),o&&(this.STATE.isFirstVisit=!1),a&&(this.STATE.isNewVisit=!1),this.sessionManager&&this.sessionManager.refreshSessionTimer(),!0}_createEventPayload(e,t){var n,r;void 0===t&&(t={});var o=i(i({},t),{},{[L]:e}),u={[Y]:this.STATE.clientId,[V]:this.STATE.sessionId,[Z]:this.STATE.sessionNumber||1,[$]:this.STATE.sessionEngaged?1:0,[X]:Math.floor(Date.now()/1e3)};Object.entries(u).forEach((e=>{var[t,i]=e;o.hasOwnProperty(t)||(o[t]=i)}));var h=(function(){if(!l)return{};var e,t,i,[n,r]=(function(e){for(var t=0;t<pt.length;t++){var[i,s]=pt[t],n=i.exec(e),r=n&&(S(s)?s(n,e):s);if(r)return r}return["",""]})(l);return x({lib:"web",lib_version:g,event_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),[X]:Date.now()/1e3,[J]:P(null==c?void 0:c.href,[],vt),page_hostname:null==c?void 0:c.host,page_path:null==c?void 0:c.pathname,os_name:n,os_version:r,browser:_t(l,navigator.vendor),device:mt(l),device_type:(t=l,i=mt(t),i===Ne||i===Ae||"Kobo"===i||"Kindle Fire"===i||i===nt?K:i===Ve||i===Je||i===He||i===tt?"Console":i===xe?"Wearable":i?z:"Desktop").toLowerCase(),timezone:yt(),timezone_offset:Tt(),raw_user_agent:l.length>1e3?l.substring(0,997)+"...":l,browser_version:ft(l,navigator.vendor),browser_language:St(),browser_language_prefix:(e=St(),"string"==typeof e?e.split("-")[0]:void 0),screen_resolution:(s&&s.screen.width)+"x"+(s&&s.screen.height),viewport_resolution:(s&&s.innerWidth)+"x"+(s&&s.innerHeight)})})();Object.entries(h).forEach((e=>{var[t,i]=e;o[t]||(o[t]=i)}));var d,_={[Q]:a&&a.referrer||"$direct",page_referring_domain:!a&&a.referrer?"$direct":(null===(d=(e=>{var t=a&&a.createElement("a");return y(t)?null:(t.href=e,t)})(a.referrer))||void 0===d?void 0:d.host)||"$direct"};Object.entries(_).forEach((e=>{var[t,i]=e;o[t]||(o[t]=i)}));var f,p,m,T=a?(f=P(a.URL,[],vt),p=se.concat([]),m={},k(p,(function(e){var t=(function(e,t){for(var i,s=((e.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),n=0;n<s.length;n++){var r=s[n].split("=");if(r[0]===t){i=r;break}}if(!v(i)||i.length<2)return"";var o=i[1];try{o=decodeURIComponent(o)}catch{E.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")})(f,e);m[e]=t||null})),m):{};Object.entries(T).forEach((e=>{var[t,i]=e;i&&!o[t]&&(o[t]=i)})),this.STATE.userId&&(o.user_id=this.STATE.userId);var I=null===(n=this.userManager)||void 0===n?void 0:n.getUserData();I&&Object.keys(I).length>0&&Object.entries(I).forEach((e=>{var[t,i]=e;o[t]||(o[t]=i)})),this.STATE.isNewVisit&&!o[te]&&(o[te]=1),this.STATE.isFirstVisit&&!o[ee]&&(o[ee]=1);var b=a&&(null===(r=a.location)||void 0===r?void 0:r.href),w=a&&a.referrer,O=this.STATE.ignoreReferrer;if(w)try{var A=new URL(w).hostname;this.CONFIG.ignore_referrer_domains.includes(A)&&(O=!0)}catch(e){}if(this.STATE.persistentParameters.page_referrer){var N=this._getDomain(this.STATE.persistentParameters.page_referrer),C=this._getDomain(b);C&&N&&C===N&&(O=!0)}return O&&!o[ie]&&(o[ie]=!0),O||!w||this.STATE.persistentParameters.page_referrer||o[Q]||(o[Q]=w),this.STATE.persistentParameters.page_referrer||this.STATE.persistentParameters.page_location||this.STATE.persistentParameters.page_title||o[Q]||o[J]||o[H]||a&&(o[J]||(o[J]=a.location.href),o[H]||(o[H]=a.title)),Object.entries(this.STATE.persistentParameters).forEach((e=>{var[t,i]=e;o[t]||(o[t]=i)})),o.consent_analytics||(o.consent_analytics=this.STATE.consentStatus.analytics),o.consent_advertising||(o.consent_advertising=this.STATE.consentStatus.advertising),o.consent_personalization||(o.consent_personalization=this.STATE.consentStatus.personalization),o}_getDomain(e){try{return new URL(e||"").hostname}catch(e){return""}}_send_retriable_request(e){this._retryQueue?(E.info("Sending retriable request"),this._retryQueue.retriableRequest(e)):(E.info("Sending request directly (no retry queue)"),this._send_request(e))}_send_request(e){if(this.__loaded){if(e.headers=e.headers||{},"sendBeacon"===e.transport&&o&&o.sendBeacon)try{if(E.info("Using sendBeacon for transport"),o.sendBeacon(e.url,new Blob([JSON.stringify(e.data)],{type:"text/plain"})))return void E.info("sendBeacon successful");E.warn("sendBeacon failed, falling back to regular request")}catch(e){E.error("Error in sendBeacon, falling back to regular request:",e)}E.info("Sending request via standard transport"),(e=>{var t,s,n,r=i({},e);r.timeout=r.timeout||6e4,r.url=re(r.url,{_:""+(new Date).getTime(),ver:g,compression:r.compression});var o=null!==(t=r.transport)&&void 0!==t?t:"fetch",a=null!==(s=null===(n=D(ce,(e=>e.transport===o)))||void 0===n?void 0:n.method)&&void 0!==s?s:ce[0].method;if(!a)throw Error("No available transport method");a(r)})(i(i({},e),{},{callback:t=>{var i,s,n;t.statusCode>=400?(E.error("Request error:",t.statusCode,t.text),null===(s=(n=this.CONFIG).on_request_error)||void 0===s||s.call(n,t)):E.info("Request successful:",t.statusCode),null===(i=e.callback)||void 0===i||i.call(e,t)}}))}else E.warn("TrustData not initialized, cannot send request")}consent(e,t){if(!this.__loaded)return E.info("TrustData not initialized, queueing consent command"),this.push(["consent",e,t]);if(!t||!t.hasOwnProperty("consent"))return E.error("Invalid consent parameters"),!1;var i=t.consent;return E.info("Updating consent settings:",i),"analytics"in i&&(this.STATE.consentStatus.analytics=!0===i.analytics||"granted"===i.analytics),"advertising"in i&&(this.STATE.consentStatus.advertising=!0===i.advertising||"granted"===i.advertising),"personalization"in i&&(this.STATE.consentStatus.personalization=!0===i.personalization||"granted"===i.personalization),this.consentManager instanceof It&&(this.consentManager.optInOut(this.STATE.consentStatus.analytics),this.STATE.consentStatus.analytics&&this.CONFIG.request_batching&&(E.info("Enabling request queue after consent granted"),this._requestQueue.enable())),!0}get(e,t,s){var n,r,o;if("string"==typeof e&&"function"==typeof t&&(s=t,t=e,e=null),!this.__loaded)return E.info("TrustData not initialized, queueing get command"),this.push(["get",e,t,s]);switch(t){case"client_id":o=this.STATE.clientId;break;case"user_id":o=this.STATE.userId;break;case"session_id":o=null===(n=this.sessionManager)||void 0===n?void 0:n.getSessionId();break;case"user_data":o=(null===(r=this.userManager)||void 0===r?void 0:r.getUserData())||{};break;case"consent_status":o=i({},this.STATE.consentStatus);break;case"debug_mode":o=this.CONFIG.debug;break;default:o=this.STATE.persistentParameters[t]}return"function"==typeof s&&s(o),o}push(e){this.__loaded?v(e)?this._execute_array([e]):S(e)&&e.call(this):s.trustdata&&v(s.trustdata)&&s.trustdata.push(e)}}Nt.prototype._dom_loaded=function(){this.CONFIG.send_page_view&&this.__loaded&&(E.info("DOM loaded, sending page view event"),this.event(B))},s._trdt_uat=s._trdt_uat||{},s._trdt_uat_ready=!1;var kt={};!(function(e,t){for(var i=0;i<5;i++)e.prototype[t[i]]=C(e.prototype[t[i]])})(Nt,["event","set","get","consent","push"]),(function(){var e=new Nt;kt[At]=e;var t=s.trustdata;if(t&&v(t)){t._i&&v(t._i)&&k(t._i,(function(i){if(i&&v(i)){var s=i[2]||At,n=e.config(i[0],i[1]||{},s);n&&s!==At&&t[s]&&v(t[s])&&n._execute_array(t[s])}}));for(var i=[],n=0;n<t.length;n++){var r=t[n];v(r)&&i.push(r)}i.length>0&&e._execute_array(i)}s.trustdata=e,(function(){function e(){e.done||(e.done=!0,Object.values(kt).forEach((function(e){"function"==typeof e._dom_loaded&&e._dom_loaded()})))}a&&a.addEventListener?"complete"===a.readyState?e():a.addEventListener("DOMContentLoaded",e,{capture:!1,passive:!0}):s&&E.error("Browser doesn't support `document.addEventListener` so TrustData couldn't be initialized")})()})()})();
//# sourceMappingURL=trustdata.debug.js.map
