!(function(){"use strict";function t(t,r,i){return(r=(function(t){var r=(function(t){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""})(t);return"symbol"==typeof r?r:r+""})(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}function r(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.push.apply(i,e)}return i}function i(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(r){t(i,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(n,t))}))}return i}var e="undefined"!=typeof window?window:void 0,n="undefined"!=typeof globalThis?globalThis:e,s=Array.prototype.forEach,a=null==n?void 0:n.navigator,o=null==n?void 0:n.document,h=null==n?void 0:n.location,u=null==n?void 0:n.fetch,c=null!=n&&n.XMLHttpRequest&&"withCredentials"in new n.XMLHttpRequest?n.XMLHttpRequest:void 0,f=null==n?void 0:n.AbortController,l=null==a?void 0:a.userAgent,d=null!=e?e:{},v="undefined",p=Object.prototype,g=p.hasOwnProperty,_=p.toString,b=Array.isArray||function(t){return"[object Array]"===_.call(t)},m=t=>"function"==typeof t,w=t=>void 0===t,y=t=>"[object String]"==_.call(t),S=t=>null===t,x=t=>"[object Number]"==_.call(t),E=t=>{var r={o:function(r){if(e&&d.POSTHOG_DEBUG&&!w(e.console)&&e.console){for(var i=("__rrweb_original__"in e.console[r]?e.console[r].__rrweb_original__:e.console[r]),n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];i(t,...s)}},info:function(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e];r.o("log",...i)},warn:function(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e];r.o("warn",...i)},error:function(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e];r.o("error",...i)},critical:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i]},uninitializedWarning:t=>{r.error("You must initialize TrustData before calling ".concat(t))},createLogger:r=>E("".concat(t," ").concat(r))};return r},O=E("[TrustData.js]"),T=O.createLogger,k={};function M(t,r,i){if(b(t))if(s&&t.forEach===s)t.forEach(r,i);else if("length"in t&&t.length===+t.length)for(var e=0,n=t.length;e<n;e++)if(e in t&&r.call(i,t[e],e)===k)return}function R(t,r,i){if(!(t=>w(t)||S(t))(t)){if(b(t))return M(t,r,i);if((t=>t instanceof FormData)(t)){for(var e of t.entries())if(r.call(i,e[1],e[0])===k)return}else for(var n in t)if(g.call(t,n)&&r.call(i,t[n],n)===k)return}}var I=function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),e=1;e<r;e++)i[e-1]=arguments[e];return M(i,(function(r){for(var i in r)void 0!==r[i]&&(t[i]=r[i])})),t},U=function(t){return function(){try{for(var r=arguments.length,i=Array(r),e=0;e<r;e++)i[e]=arguments[e];return t.apply(this,i)}catch(t){O.critical("Implementation error. Please turn on debug mode"),O.critical(t)}}};function j(t,r,i,e){var{capture:n=!1,passive:s=!0}={};null==t||t.addEventListener(r,i,{capture:n,passive:s})}var D=function(t,r,i){if(!t||!r||!r.length)return t;for(var e=t.split("#"),n=e[1],s=(e[0]||"").split("?"),a=s[1],o=s[0],h=(a||"").split("&"),u=[],c=0;c<h.length;c++){var f=h[c].split("=");b(f)&&(r.includes(f[0])?u.push(f[0]+"="+i):u.push(h[c]))}var l=o;return null!=a&&(l+="?"+u.join("&")),null!=n&&(l+="#"+n),l},C=3e3,N="page_view",P="page_leave",A="event_name",B="client_id",z="session_id",q="page_title",F="page_location",W="page_referrer",J="event_time",G="session_number",L="session_engaged",V="first_visit",K="entrances",X="ignore_referrer",H=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid","gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Q="text/plain",Y=Uint8Array,$=Uint16Array,Z=Int32Array,tt=new Y([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rt=new Y([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),it=new Y([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),et=function(t,r){for(var i=new $(31),e=0;e<31;++e)i[e]=r+=1<<t[e-1];var n=new Z(i[30]);for(e=1;e<30;++e)for(var s=i[e];s<i[e+1];++s)n[s]=s-i[e]<<5|e;return{b:i,r:n}},nt=et(tt,2),st=nt.r;nt.b[28]=258,st[258]=28;for(var at=et(rt,0).r,ot=new $(32768),ht=0;ht<32768;++ht){var ut=(43690&ht)>>1|(21845&ht)<<1;ot[ht]=((65280&(ut=(61680&(ut=(52428&ut)>>2|(13107&ut)<<2))>>4|(3855&ut)<<4))>>8|(255&ut)<<8)>>1}var ct=function(t,r,i){for(var e=t.length,n=0,s=new $(r);n<e;++n)t[n]&&++s[t[n]-1];var a,o=new $(r);for(n=1;n<r;++n)o[n]=o[n-1]+s[n-1]<<1;if(i){a=new $(1<<r);var h=15-r;for(n=0;n<e;++n)if(t[n])for(var u=n<<4|t[n],c=r-t[n],f=o[t[n]-1]++<<c,l=f|(1<<c)-1;f<=l;++f)a[ot[f]>>h]=u}else for(a=new $(e),n=0;n<e;++n)t[n]&&(a[n]=ot[o[t[n]-1]++]>>15-t[n]);return a},ft=new Y(288);for(ht=0;ht<144;++ht)ft[ht]=8;for(ht=144;ht<256;++ht)ft[ht]=9;for(ht=256;ht<280;++ht)ft[ht]=7;for(ht=280;ht<288;++ht)ft[ht]=8;var lt=new Y(32);for(ht=0;ht<32;++ht)lt[ht]=5;var dt=ct(ft,9,0),vt=ct(lt,5,0),pt=function(t){return(t+7)/8|0},gt=function(t,r,i){return(null==i||i>t.length)&&(i=t.length),new Y(t.subarray(r,i))},_t=function(t,r,i){var e=r/8|0;t[e]|=i<<=7&r,t[e+1]|=i>>8},bt=function(t,r,i){var e=r/8|0;t[e]|=i<<=7&r,t[e+1]|=i>>8,t[e+2]|=i>>16},mt=function(t,r){for(var i=[],e=0;e<t.length;++e)t[e]&&i.push({s:e,f:t[e]});var n=i.length,s=i.slice();if(!n)return{t:Tt,l:0};if(1==n){var a=new Y(i[0].s+1);return a[i[0].s]=1,{t:a,l:1}}i.sort((function(t,r){return t.f-r.f})),i.push({s:-1,f:25001});var o=i[0],h=i[1],u=0,c=1,f=2;for(i[0]={s:-1,f:o.f+h.f,l:o,r:h};c!=n-1;)o=i[i[u].f<i[f].f?u++:f++],h=i[u!=c&&i[u].f<i[f].f?u++:f++],i[c++]={s:-1,f:o.f+h.f,l:o,r:h};var l=s[0].s;for(e=1;e<n;++e)s[e].s>l&&(l=s[e].s);var d=new $(l+1),v=wt(i[c-1],d,0);if(v>r){e=0;var p=0,g=v-r,_=1<<g;for(s.sort((function(t,r){return d[r.s]-d[t.s]||t.f-r.f}));e<n;++e){var b=s[e].s;if(!(d[b]>r))break;p+=_-(1<<v-d[b]),d[b]=r}for(p>>=g;p>0;){var m=s[e].s;d[m]<r?p-=1<<r-d[m]++-1:++e}for(;e>=0&&p;--e){var w=s[e].s;d[w]==r&&(--d[w],++p)}v=r}return{t:new Y(d),l:v}},wt=function(t,r,i){return-1==t.s?Math.max(wt(t.l,r,i+1),wt(t.r,r,i+1)):r[t.s]=i},yt=function(t){for(var r=t.length;r&&!t[--r];);for(var i=new $(++r),e=0,n=t[0],s=1,a=function(t){i[e++]=t},o=1;o<=r;++o)if(t[o]==n&&o!=r)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=t[o]}return{c:i.subarray(0,e),n:r}},St=function(t,r){for(var i=0,e=0;e<r.length;++e)i+=t[e]*r[e];return i},xt=function(t,r,i){var e=i.length,n=pt(r+2);t[n]=255&e,t[n+1]=e>>8,t[n+2]=255^t[n],t[n+3]=255^t[n+1];for(var s=0;s<e;++s)t[n+s+4]=i[s];return 8*(n+4+e)},Et=function(t,r,i,e,n,s,a,o,h,u,c){_t(r,c++,i),++n[256];for(var f=mt(n,15),l=f.t,d=f.l,v=mt(s,15),p=v.t,g=v.l,_=yt(l),b=_.c,m=_.n,w=yt(p),y=w.c,S=w.n,x=new $(19),E=0;E<b.length;++E)++x[31&b[E]];for(E=0;E<y.length;++E)++x[31&y[E]];for(var O=mt(x,7),T=O.t,k=O.l,M=19;M>4&&!T[it[M-1]];--M);var R,I,U,j,D=u+5<<3,C=St(n,ft)+St(s,lt)+a,N=St(n,l)+St(s,p)+a+14+3*M+St(x,T)+2*x[16]+3*x[17]+7*x[18];if(h>=0&&D<=C&&D<=N)return xt(r,c,t.subarray(h,h+u));if(_t(r,c,1+(N<C)),c+=2,N<C){R=ct(l,d,0),I=l,U=ct(p,g,0),j=p;var P=ct(T,k,0);for(_t(r,c,m-257),_t(r,c+5,S-1),_t(r,c+10,M-4),c+=14,E=0;E<M;++E)_t(r,c+3*E,T[it[E]]);c+=3*M;for(var A=[b,y],B=0;B<2;++B){var z=A[B];for(E=0;E<z.length;++E)_t(r,c,P[F=31&z[E]]),c+=T[F],F>15&&(_t(r,c,z[E]>>5&127),c+=z[E]>>12)}}else R=dt,I=ft,U=vt,j=lt;for(E=0;E<o;++E){var q=e[E];if(q>255){var F;bt(r,c,R[257+(F=q>>18&31)]),c+=I[F+257],F>7&&(_t(r,c,q>>23&31),c+=tt[F]);var W=31&q;bt(r,c,U[W]),c+=j[W],W>3&&(bt(r,c,q>>5&8191),c+=rt[W])}else bt(r,c,R[q]),c+=I[q]}return bt(r,c,R[256]),c+I[256]},Ot=new Z([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Tt=new Y(0),kt=(function(){for(var t=new Int32Array(256),r=0;r<256;++r){for(var i=r,e=9;--e;)i=(1&i&&-306674912)^i>>>1;t[r]=i}return t})(),Mt=function(t,r,i){for(;i;++r)t[r]=i,i>>>=8},Rt="undefined"!=typeof TextEncoder&&new TextEncoder,It="undefined"!=typeof TextDecoder&&new TextDecoder;try{It.decode(Tt,{stream:!0})}catch(t){}var Ut=!!c||!!u,jt=(t,r)=>{var[e,n]=t.split("?"),s=i({},r);null==n||n.split("&").forEach((t=>{var[r]=t.split("=");delete s[r]}));var a=(function(t,r){var i;void 0===r&&(r="&");var e=[];return R(t,(function(t,r){w(t)||w(r)||"undefined"===r||(i=encodeURIComponent((t=>t instanceof File)(t)?t.name:""+t),e[e.length]=encodeURIComponent(r)+"="+i)})),e.join(r)})(s);return a=a?(n?n+"&":"")+a:n,"".concat(e,"?").concat(a)},Dt=(t,r)=>JSON.stringify(t,((t,r)=>"bigint"==typeof r?""+r:r),r),Ct=t=>{var{data:r,compression:i}=t;if(r){if("gzip-js"===i){var e=(function(t,r){r||(r={});var i=(function(){var t=-1;return{p:function(r){for(var i=t,e=0;e<r.length;++e)i=kt[255&i^r[e]]^i>>>8;t=i},d:function(){return~t}}})(),e=t.length;i.p(t);var n,s=(function(t,r,i,e,n){if(!n&&(n={l:1},r.dictionary)){var s=r.dictionary.subarray(-32768),a=new Y(s.length+t.length);a.set(s),a.set(t,s.length),t=a,n.w=s.length}return(function(t,r,i,e,n,s){var a=s.z||t.length,o=new Y(e+a+5*(1+Math.ceil(a/7e3))+8),h=o.subarray(e,o.length-8),u=s.l,c=7&(s.r||0);if(r){c&&(h[0]=s.r>>3);for(var f=Ot[r-1],l=f>>13,d=8191&f,v=(1<<i)-1,p=s.p||new $(32768),g=s.h||new $(v+1),_=Math.ceil(i/3),b=2*_,m=function(r){return(t[r]^t[r+1]<<_^t[r+2]<<b)&v},w=new Z(25e3),y=new $(288),S=new $(32),x=0,E=0,O=s.i||0,T=0,k=s.w||0,M=0;O+2<a;++O){var R=m(O),I=32767&O,U=g[R];if(p[I]=U,g[R]=I,k<=O){var j=a-O;if((x>7e3||T>24576)&&(j>423||!u)){c=Et(t,h,0,w,y,S,E,T,M,O-M,c),T=x=E=0,M=O;for(var D=0;D<286;++D)y[D]=0;for(D=0;D<30;++D)S[D]=0}var C=2,N=0,P=d,A=I-U&32767;if(j>2&&R==m(O-A))for(var B=Math.min(l,j)-1,z=Math.min(32767,O),q=Math.min(258,j);A<=z&&--P&&I!=U;){if(t[O+C]==t[O+C-A]){for(var F=0;F<q&&t[O+F]==t[O+F-A];++F);if(F>C){if(C=F,N=A,F>B)break;var W=Math.min(A,F-2),J=0;for(D=0;D<W;++D){var G=O-A+D&32767,L=G-p[G]&32767;L>J&&(J=L,U=G)}}}A+=(I=U)-(U=p[I])&32767}if(N){w[T++]=268435456|st[C]<<18|at[N];var V=31&st[C],K=31&at[N];E+=tt[V]+rt[K],++y[257+V],++S[K],k=O+C,++x}else w[T++]=t[O],++y[t[O]]}}for(O=Math.max(O,k);O<a;++O)w[T++]=t[O],++y[t[O]];c=Et(t,h,u,w,y,S,E,T,M,O-M,c),u||(s.r=7&c|h[c/8|0]<<3,c-=7,s.h=g,s.p=p,s.i=O,s.w=k)}else{for(O=s.w||0;O<a+u;O+=65535){var X=O+65535;X>=a&&(h[c/8|0]=u,X=a),c=xt(h,c+1,t.subarray(O,X))}s.i=a}return gt(o,0,e+pt(c)+8)})(t,r.level??6,null==r.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+r.mem,i,0,n)})(t,r,10+((n=r).filename?n.filename.length+1:0)),a=s.length;return(function(t,r){var i=r.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=r.level<2?4:9==r.level?2:0,t[9]=3,0!=r.mtime&&Mt(t,4,Math.floor(new Date(r.mtime||Date.now())/1e3)),i){t[3]=8;for(var e=0;e<=i.length;++e)t[e+10]=i.charCodeAt(e)}})(s,r),Mt(s,a-8,i.d()),Mt(s,a-4,e),s})((function(t){if(Rt)return Rt.encode(t);for(var r=t.length,i=new Y(t.length+(t.length>>1)),e=0,n=function(t){i[e++]=t},s=0;s<r;++s){if(e+5>i.length){var a=new Y(e+8+(r-s<<1));a.set(i),i=a}var o=t.charCodeAt(s);o<128?n(o):o<2048?(n(192|o>>6),n(128|63&o)):o>55295&&o<57344?(n(240|(o=65536+(1047552&o)|1023&t.charCodeAt(++s))>>18),n(128|o>>12&63),n(128|o>>6&63),n(128|63&o)):(n(224|o>>12),n(128|o>>6&63),n(128|63&o))}return gt(i,0,e)})(Dt(r)),{mtime:0}),n=new Blob([e],{type:Q});return{contentType:Q,body:n,estimatedSize:n.size}}if("base64"===i){var s=(function(t){var r,i,e,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,o=0,h="",u=[];if(!t)return t;t=(function(t){var r,i,e,n,s="";for(r=i=0,e=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,n=0;n<e;n++){var a=t.charCodeAt(n),o=null;a<128?i++:o=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),S(o)||(i>r&&(s+=t.substring(r,i)),s+=o,r=i=n+1)}return i>r&&(s+=t.substring(r,t.length)),s})(t);do{r=(n=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>12&63,i=n>>6&63,e=63&n,u[o++]=s.charAt(n>>18&63)+s.charAt(r)+s.charAt(i)+s.charAt(e)}while(a<t.length);switch(h=u.join(""),t.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h})(Dt(r)),a=(t=>"data="+encodeURIComponent("string"==typeof t?t:Dt(t)))(s);return{contentType:"application/x-www-form-urlencoded",body:a,estimatedSize:new Blob([a]).size}}var o=Dt(r);return{contentType:"application/json",body:o,estimatedSize:new Blob([o]).size}}},Nt=[];function Pt(t,r,i,e,n){return x(t)?t>i?(O.warn(e+" cannot be greater than max: "+i+". Using max value instead."),i):t<r?(O.warn(e+" cannot be less than min: "+r+". Using min value instead."),r):t:(O.warn(e+" must be a number. using max or fallback. max: "+i+", fallback: "+n),Pt(n||i,r,i,e))}u&&Nt.push({transport:"fetch",method:t=>{var r,e,{contentType:n,body:s,estimatedSize:a}=null!==(r=Ct(t))&&void 0!==r?r:{},o=new Headers;R(t.headers,(function(t,r){o.append(r,t)})),n&&o.append("Content-Type",n);var h=t.url,c=null;if(f){var l=new f;c={signal:l.signal,timeout:setTimeout((()=>l.abort()),t.timeout)}}u(h,i({method:(null==t?void 0:t.method)||"GET",headers:o,keepalive:"POST"===t.method&&(a||0)<52428.8,body:s,signal:null===(e=c)||void 0===e?void 0:e.signal},t.fetchOptions)).then((r=>r.text().then((i=>{var e,n={statusCode:r.status,text:i};if(200===r.status)try{n.json=JSON.parse(i)}catch(t){O.error(t)}null===(e=t.callback)||void 0===e||e.call(t,n)})))).catch((r=>{var i;O.error(r),null===(i=t.callback)||void 0===i||i.call(t,{statusCode:0,text:r})})).finally((()=>c?clearTimeout(c.timeout):null))}}),c&&Nt.push({transport:"XHR",method:t=>{var r,i=new c;i.open(t.method||"GET",t.url,!0);var{contentType:e,body:n}=null!==(r=Ct(t))&&void 0!==r?r:{};R(t.headers,(function(t,r){i.setRequestHeader(r,t)})),e&&i.setRequestHeader("Content-Type",e),t.timeout&&(i.timeout=t.timeout),i.withCredentials=!0,i.onreadystatechange=()=>{if(4===i.readyState){var r,e={statusCode:i.status,text:i.responseText};if(200===i.status)try{e.json=JSON.parse(i.responseText)}catch{}null===(r=t.callback)||void 0===r||r.call(t,e)}},i.send(n)}}),null!=a&&a.sendBeacon&&Nt.push({transport:"sendBeacon",method:t=>{var r=jt(t.url,{beacon:"1"});try{var i,{contentType:e,body:n}=null!==(i=Ct(t))&&void 0!==i?i:{},s="string"==typeof n?new Blob([n],{type:e}):n;a.sendBeacon(r,s)}catch{}}});class At{constructor(t,r){this.u=!0,this.v=[],this.m=void 0,this.S=Pt((null==r?void 0:r.flush_interval_ms)||C,250,5e3,"flush interval",C),this.O=t}enqueue(t){this.v.push(t),this.m||this.T()}unload(){this.k();var t=this.v.length>0?this.M():{},r=Object.values(t);[...r.filter((t=>0===t.url.indexOf("/e"))),...r.filter((t=>0!==t.url.indexOf("/e")))].map((t=>{this.O(i(i({},t),{},{transport:"sendBeacon"}))}))}enable(){this.u=!1,this.T()}T(){var t=this;this.u||(this.m=setTimeout((()=>{if(this.k(),this.v.length>0){var r=this.M(),i=function(){var i=r[e],n=(new Date).getTime();i.data&&b(i.data)&&R(i.data,(t=>{t.offset=Math.abs(t.timestamp-n),delete t.timestamp})),t.O(i)};for(var e in r)i()}}),this.S))}k(){clearTimeout(this.m),this.m=void 0}M(){var t={};return R(this.v,(r=>{var e,n=r,s=(n?n.batchKey:null)||n.url;w(t[s])&&(t[s]=i(i({},n),{},{data:[]})),null===(e=t[s].data)||void 0===e||e.push(n.data)})),this.v=[],t}}var Bt=["retriesPerformedSoFar"];class zt{constructor(t){this.R=t,this.I=!1,this.U=void 0,this.j=3e3,this.v=[],this.D=!0,!w(e)&&"onLine"in e.navigator&&(this.D=e.navigator.onLine,j(e,"online",(()=>{this.D=!0,this.C()})),j(e,"offline",(()=>{this.D=!1})))}get length(){return this.v.length}retriableRequest(t){var{retriesPerformedSoFar:r}=t,e=(function(t,r){if(null==t)return{};var i,e,n=(function(t,r){if(null==t)return{};var i={};for(var e in t)if({}.hasOwnProperty.call(t,e)){if(-1!==r.indexOf(e))continue;i[e]=t[e]}return i})(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(e=0;e<s.length;e++)-1===r.indexOf(i=s[e])&&{}.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n})(t,Bt);x(r)&&r>0&&(e.url=jt(e.url,{retry_count:r})),this.R.N(i(i({},e),{},{callback:t=>{var n;200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=r?r:0)<10?this.P(i({retriesPerformedSoFar:r},e)):null===(n=e.callback)||void 0===n||n.call(e,t)}}))}P(t){var r=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=r+1;var i=(function(t){var r=3e3*2**t,i=r/2,e=Math.min(18e5,r),n=Math.random()-.5;return Math.ceil(e+n*(e-i))})(r),e=Date.now()+i;this.v.push({retryAt:e,requestOptions:t});var n="Enqueued failed request for retry in ".concat(i);navigator.onLine||(n+=" (Browser is offline)"),O.warn(n),this.I||(this.I=!0,this.A())}A(){this.U&&clearTimeout(this.U),this.U=setTimeout((()=>{this.D&&this.v.length>0&&this.C(),this.A()}),this.j)}C(){var t=Date.now(),r=[],i=this.v.filter((i=>i.retryAt<t||(r.push(i),!1)));if(this.v=r,i.length>0)for(var{requestOptions:e}of i)this.retriableRequest(e)}unload(){for(var{requestOptions:t}of(this.U&&(clearTimeout(this.U),this.U=void 0),this.v))try{this.R.N(i(i({},t),{},{transport:"sendBeacon"}))}catch(t){O.error(t)}this.v=[]}}Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return x(t)&&isFinite(t)&&Math.floor(t)===t});var qt="0123456789abcdef";class Ft{constructor(t){if(this.bytes=t,16!==t.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(t,r,i,e){if(!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(i)||!Number.isInteger(e)||t<0||r<0||i<0||e<0||t>0xffffffffffff||r>4095||i>1073741823||e>4294967295)throw new RangeError("invalid field value");var n=new Uint8Array(16);return n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/65536,n[4]=t/256,n[5]=t,n[6]=112|r>>>8,n[7]=r,n[8]=128|i>>>24,n[9]=i>>>16,n[10]=i>>>8,n[11]=i,n[12]=e>>>24,n[13]=e>>>16,n[14]=e>>>8,n[15]=e,new Ft(n)}toString(){for(var t="",r=0;r<this.bytes.length;r++)t=t+qt.charAt(this.bytes[r]>>>4)+qt.charAt(15&this.bytes[r]),3!==r&&5!==r&&7!==r&&9!==r||(t+="-");if(36!==t.length)throw Error("Invalid UUIDv7 was generated");return t}clone(){return new Ft(this.bytes.slice(0))}equals(t){return 0===this.compareTo(t)}compareTo(t){for(var r=0;r<16;r++){var i=this.bytes[r]-t.bytes[r];if(0!==i)return Math.sign(i)}return 0}}class Wt{constructor(){this.B=0,this.q=0,this.F=new Lt}generate(){var t=this.generateOrAbort();if(w(t)){this.B=0;var r=this.generateOrAbort();if(w(r))throw Error("Could not generate UUID after timestamp reset");return r}return t}generateOrAbort(){var t=Date.now();if(t>this.B)this.B=t,this.W();else{if(!(t+1e4>this.B))return;this.q++,this.q>4398046511103&&(this.B++,this.W())}return Ft.fromFieldsV7(this.B,Math.trunc(this.q/2**30),this.q&2**30-1,this.F.nextUint32())}W(){this.q=1024*this.F.nextUint32()+(1023&this.F.nextUint32())}}var Jt,Gt=t=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var r=0;r<t.length;r++)t[r]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};e&&!w(e.crypto)&&crypto.getRandomValues&&(Gt=t=>crypto.getRandomValues(t));class Lt{constructor(){this.J=new Uint32Array(8),this.G=1/0}nextUint32(){return this.G>=this.J.length&&(Gt(this.J),this.G=0),this.J[this.G++]}}var Vt=()=>""+Kt(),Kt=()=>(Jt||(Jt=new Wt)).generate(),Xt="",Ht=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,Qt={is_supported:()=>!!o,error:function(t){O.error("cookieStore error: "+t)},get:function(t){if(o){try{for(var r=t+"=",i=o.cookie.split(";").filter((t=>t.length)),e=0;e<i.length;e++){for(var n=i[e];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(r))return decodeURIComponent(n.substring(r.length,n.length))}}catch{}return null}},parse:function(t){var r;try{r=JSON.parse(Qt.get(t))||{}}catch{}return r},set:function(t,r,i,e,n){if(o)try{var s="",a="",h=(function(t,r){if(r){var i=(function(t,r){if(void 0===r&&(r=o),Xt)return Xt;if(!r)return"";if(["localhost","127.0.0.1"].includes(t))return"";for(var i=t.split("."),e=Math.min(i.length,8),n="dmn_chk_"+Vt(),s=RegExp("(^|;)\\s*"+n+"=1");!Xt&&e--;){var a=i.slice(e).join("."),h=n+"=1;domain=."+a;r.cookie=h,s.test(r.cookie)&&(r.cookie=h+";expires=Thu, 01 Jan 1970 00:00:00 GMT",Xt=a)}return Xt})(t);if(!i){var e=(t=>{var r=t.match(Ht);return r?r[0]:""})(t);i=e}return i?"; domain=."+i:""}return""})(o.location.hostname,e);if(i){var u=new Date;u.setTime(u.getTime()+24*i*60*60*1e3),s="; expires="+u.toUTCString()}n&&(a="; secure");var c=t+"="+encodeURIComponent(JSON.stringify(r))+s+"; SameSite=Lax; path=/"+h+a;return c.length>3686.4&&O.warn("cookieStore warning: large cookie, len="+c.length),o.cookie=c,c}catch{return}},remove:function(t,r){try{Qt.set(t,"",-1,r)}catch{return}}},Yt=null,$t={is_supported:function(){if(!S(Yt))return Yt;var t=!0;if(w(e))t=!1;else try{var r="__mplssupport__";$t.set(r,"xyz"),'"xyz"'!==$t.get(r)&&(t=!1),$t.remove(r)}catch{t=!1}return t||O.error("localStorage unsupported; falling back to cookie store"),Yt=t,t},error:function(t){O.error("localStorage error: "+t)},get:function(t){try{return e&&e.localStorage.getItem(t)}catch(t){$t.error(t)}return null},parse:function(t){try{return JSON.parse($t.get(t))||{}}catch{}return null},set:function(t,r){try{e&&e.localStorage.setItem(t,JSON.stringify(r))}catch(t){$t.error(t)}},remove:function(t){try{e&&e.localStorage.removeItem(t)}catch(t){$t.error(t)}}},Zt=["cid","uid","udata","sid","sn","last","start","wid","primary_window","fv"],tr=i(i({},$t),{},{parse:function(t){try{var r={};try{r=Qt.parse(t)||{}}catch{}var i=I(r,JSON.parse($t.get(t)||"{}"));return $t.set(t,i),i}catch{}return null},set:function(t,r,i,e,n,s){try{$t.set(t,r,void 0,void 0,s);var a={};Zt.forEach((t=>{r[t]&&(a[t]=r[t])})),Object.keys(a).length&&Qt.set(t,a,i,e,n,s)}catch(t){$t.error(t)}},remove:function(t,r){try{e&&e.localStorage.removeItem(t),Qt.remove(t,r)}catch(t){$t.error(t)}}});function rr(t,r){return-1!==t.indexOf(r)}var ir="Mobile",er="iOS",nr="Android",sr="Tablet",ar=nr+" "+sr,or="iPad",hr="Apple",ur=hr+" Watch",cr="Safari",fr="BlackBerry",lr="Samsung",dr=lr+"Browser",vr=lr+" Internet",pr="Chrome",gr=pr+" OS",_r=pr+" "+er,br="Internet Explorer",mr=br+" "+ir,wr="Opera",yr=wr+" Mini",Sr="Edge",xr="Microsoft "+Sr,Er="Firefox",Or=Er+" "+er,Tr="Nintendo",kr="PlayStation",Mr="Xbox",Rr=nr+" "+ir,Ir=ir+" "+cr,Ur="Windows",jr=Ur+" Phone",Dr="Nokia",Cr="Ouya",Nr="Generic",Pr=Nr+" mobile",Ar=Nr+" tablet",Br="Konqueror",zr="(\\d+(\\.\\d+)?)",qr=RegExp("Version/"+zr),Fr=RegExp(Mr,"i"),Wr=RegExp(kr+" \\w+","i"),Jr=RegExp(Tr+" \\w+","i"),Gr=RegExp(fr+"|PlayBook|BB10","i"),Lr={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Vr=function(t,r){return r=r||"",rr(t," OPR/")&&rr(t,"Mini")?yr:rr(t," OPR/")?wr:Gr.test(t)?fr:rr(t,"IE"+ir)||rr(t,"WPDesktop")?mr:rr(t,dr)?vr:rr(t,Sr)||rr(t,"Edg/")?xr:rr(t,"FBIOS")?"Facebook "+ir:rr(t,"UCWEB")||rr(t,"UCBrowser")?"UC Browser":rr(t,"CriOS")?_r:rr(t,"CrMo")||rr(t,pr)?pr:rr(t,nr)&&rr(t,cr)?Rr:rr(t,"FxiOS")?Or:rr(t.toLowerCase(),"konqueror")?Br:((t,r)=>r&&rr(r,hr)||(function(t){return rr(t,cr)&&!rr(t,pr)&&!rr(t,nr)})(t))(t,r)?rr(t,ir)?Ir:cr:rr(t,Er)?Er:rr(t,"MSIE")||rr(t,"Trident/")?br:rr(t,"Gecko")?Er:""},Kr={[mr]:[RegExp("rv:"+zr)],[xr]:[RegExp(Sr+"?\\/"+zr)],[pr]:[RegExp("("+pr+"|CrMo)\\/"+zr)],[_r]:[RegExp("CriOS\\/"+zr)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+zr)],[cr]:[qr],[Ir]:[qr],[wr]:[RegExp("(Opera|OPR)\\/"+zr)],[Er]:[RegExp(Er+"\\/"+zr)],[Or]:[RegExp("FxiOS\\/"+zr)],[Br]:[RegExp("Konqueror[:/]?"+zr,"i")],[fr]:[RegExp(fr+" "+zr),qr],[Rr]:[RegExp("android\\s"+zr,"i")],[vr]:[RegExp(dr+"\\/"+zr)],[br]:[RegExp("(rv:|MSIE )"+zr)],Mozilla:[RegExp("rv:"+zr)]},Xr=function(t,r){var i=Vr(t,r),e=Kr[i];if(w(e))return null;for(var n=0;n<e.length;n++){var s=t.match(e[n]);if(s)return parseFloat(s[s.length-2])}return null},Hr=[[RegExp(Mr+"; "+Mr+" (.*?)[);]","i"),t=>[Mr,t&&t[1]||""]],[RegExp(Tr,"i"),[Tr,""]],[RegExp(kr,"i"),[kr,""]],[Gr,[fr,""]],[RegExp(Ur,"i"),(t,r)=>{if(/Phone/.test(r)||/WPDesktop/.test(r))return[jr,""];if(RegExp(ir).test(r)&&!/IEMobile\b/.test(r))return[Ur+" "+ir,""];var i=/Windows NT ([0-9.]+)/i.exec(r);if(i&&i[1]){var e=Lr[i[1]]||"";return/arm/i.test(r)&&(e="RT"),[Ur,e]}return[Ur,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>t&&t[3]?[er,[t[3],t[4],t[5]||"0"].join(".")]:[er,""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var r="";return t&&t.length>=3&&(r=w(t[2])?t[3]:t[2]),["watchOS",r]}],[RegExp("("+nr+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+nr+")","i"),t=>t&&t[2]?[nr,[t[2],t[3],t[4]||"0"].join(".")]:[nr,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var r=["Mac OS X",""];return t&&t[1]&&(r[1]=[t[1],t[2],t[3]||"0"].join(".")),r}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[gr,""]],[/Linux|debian/i,["Linux",""]]],Qr=function(t){return Jr.test(t)?Tr:Wr.test(t)?kr:Fr.test(t)?Mr:RegExp(Cr,"i").test(t)?Cr:RegExp("("+jr+"|WPDesktop)","i").test(t)?jr:/iPad/.test(t)?or:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?ur:Gr.test(t)?fr:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":RegExp(Dr,"i").test(t)?Dr:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!RegExp(ir).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?nr:ar:nr:RegExp("(pda|"+ir+")","i").test(t)?Pr:RegExp(sr,"i").test(t)&&!RegExp(sr+" pc","i").test(t)?Ar:""},Yr="<masked>";function $r(){return navigator.language||navigator.userLanguage}function Zr(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function ti(){try{return(new Date).getTimezoneOffset()}catch{return}}class ri{constructor(t){this.instance=t,this.DEFAULT_SESSION_TIMEOUT_MINUTES=30,this.MIN_SESSION_TIMEOUT_MINUTES=1,this.MAX_SESSION_TIMEOUT_MINUTES=600,this.SESSION_MAX_LENGTH_MS=864e5,this.SESSION_ID_KEY="_trdt_sid",this.SESSION_NUMBER_KEY="_trdt_sn",this.LAST_ACTIVITY_KEY="_trdt_last",this.SESSION_START_KEY="_trdt_start",this.WINDOW_ID_KEY="_trdt_wid",this.PRIMARY_WINDOW_KEY="_trdt_primary_window",this.windowId=null,this.sessionChangeHandlers=[],this.sessionTimer=null,this.L()}V(){return 60*Math.min(Math.max(this.instance.CONFIG.sessionTimeout||this.DEFAULT_SESSION_TIMEOUT_MINUTES,this.MIN_SESSION_TIMEOUT_MINUTES),this.MAX_SESSION_TIMEOUT_MINUTES)*1e3}K(){return Date.now()+"-"+Math.random().toString(36).substring(2,10)}X(){return!this.instance.CONFIG.disable_persistence}H(){if(this.windowId)return this.windowId;if(this.X())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY);if(t)return t}catch(t){}return null}Y(t){if(this.windowId=t,this.X())try{sessionStorage.setItem(this.WINDOW_ID_KEY,t)}catch(t){}}L(){if(this.X())try{var t=sessionStorage.getItem(this.WINDOW_ID_KEY),r=sessionStorage.getItem(this.PRIMARY_WINDOW_KEY);t&&!r?this.windowId=t:sessionStorage.removeItem(this.WINDOW_ID_KEY),sessionStorage.setItem(this.PRIMARY_WINDOW_KEY,"true"),window.addEventListener("beforeunload",(()=>{sessionStorage.removeItem(this.PRIMARY_WINDOW_KEY)}))}catch(t){}}onSessionChange(t){return this.sessionChangeHandlers.push(t),()=>{this.sessionChangeHandlers=this.sessionChangeHandlers.filter((r=>r!==t))}}$(t,r,i){this.sessionChangeHandlers.forEach((e=>{try{e(t,r,i)}catch(t){}}))}initSession(t){void 0===t&&(t=!1);var r=(new Date).getTime(),i=this.X(),e=this.V(),n=null,s=0,a=0,o=1,h=this.H();if(i)try{n=Qt.get(this.SESSION_ID_KEY),a=parseInt(Qt.get(this.LAST_ACTIVITY_KEY)||"0"),s=parseInt($t.get(this.SESSION_START_KEY)||"0"),o=parseInt($t.get(this.SESSION_NUMBER_KEY)||"1")}catch(t){}var u=!n,c=!t&&r-a>e,f=s>0&&r-s>this.SESSION_MAX_LENGTH_MS,l=!1,d={};if(u||c||f){if(n=this.K(),h||(h=this.K()),s=r,this.instance.STATE.isFirstVisit||o++,this.instance.STATE.sessionId=n,this.instance.STATE.sessionNumber=o,this.instance.STATE.sessionEngaged=!1,this.instance.STATE.isNewVisit=!0,l=!0,d={noSession:u,activityTimeout:c,sessionTooLong:f},i)try{$t.set(this.SESSION_NUMBER_KEY,""+o),$t.set(this.SESSION_START_KEY,""+s),Qt.set(this.SESSION_ID_KEY,n,0,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}catch(t){}}else h||(h=this.K(),this.Y(h)),this.instance.STATE.sessionId=n,this.instance.STATE.sessionNumber=o,this.instance.STATE.sessionEngaged=!0,this.instance.STATE.isNewVisit=!1;if(!t){if(a=r,i)try{Qt.set(this.LAST_ACTIVITY_KEY,""+a,0,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}catch(t){}this.refreshSessionTimer()}return this.Y(h),l&&this.$(n,h,d),{sessionId:this.instance.STATE.sessionId,windowId:h,sessionStart:s,lastActivity:a,sessionNumber:this.instance.STATE.sessionNumber,isNewVisit:this.instance.STATE.isNewVisit}}refreshSessionTimer(){clearTimeout(this.sessionTimer),this.sessionTimer=setTimeout((()=>{this.resetSession()}),1.1*this.V())}resetSession(){if(this.X())try{Qt.remove(this.SESSION_ID_KEY,this.instance.CONFIG.cross_subdomain_cookie),Qt.remove(this.LAST_ACTIVITY_KEY,this.instance.CONFIG.cross_subdomain_cookie)}catch(t){}this.initSession()}getSessionId(){return this.instance.STATE.sessionId}getWindowId(){return this.H()}}class ii{constructor(t){this.instance=t,this.clientId=null,this.isFirstVisit=!1}initClientId(t){void 0===t&&(t={});var r=this.X(),i=this.instance.CONFIG.persistence_name||"_trdt",e=t.client_id||r&&this.instance.persistence.get(i+"_cid"),n=r&&this.instance.persistence.get(i+"_fv");return e?(this.clientId=e,this.isFirstVisit=!n):(this.clientId=this.K(),this.isFirstVisit=!0,r&&(this.Z(this.clientId),this.tt())),this.instance.STATE.clientId=this.clientId,this.instance.STATE.isFirstVisit=this.isFirstVisit,this.clientId}K(){return this.instance.CONFIG.get_device_id?this.instance.CONFIG.get_device_id(Vt()):Vt()}Z(t){this.X()&&this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_cid",t,this.instance.CONFIG.cookie_expiration,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie)}tt(){if(this.X()&&this.isFirstVisit){var t=this.instance.CONFIG.persistence_name||"_trdt",r=this.instance.CONFIG.cookie_expiration,i=this.instance.CONFIG.cross_subdomain_cookie,e=this.instance.CONFIG.secure_cookie,n=""+Date.now();this.instance.persistence.set(t+"_fv",n,r,i,e)}}setClientId(t){return!!t&&(this.clientId=t,this.instance.STATE.clientId=t,this.X()&&this.Z(t),!0)}getClientId(){return this.clientId}X(){return!this.instance.CONFIG.disable_persistence}}class ei{constructor(t){this.instance=t,this.userId=null,this.userData={},this.identifiers={}}initUser(t){void 0===t&&(t={});var r=this.X(),i=this.instance.CONFIG.persistence_name||"_trdt";if(this.userId=t.user_id||r&&this.instance.persistence.get(i+"_uid"),r)try{var e=this.instance.persistence.get(i+"_udata");e&&(this.userData=JSON.parse(e))}catch(t){O.error("Error parsing stored user data",t),this.userData={}}return this.instance.STATE.userId=this.userId,this.userData}setUserId(t){return!!t&&(this.userId=t,this.instance.STATE.userId=t,this.X()&&this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_uid",t,this.instance.CONFIG.cookie_expiration,this.instance.CONFIG.cross_subdomain_cookie,this.instance.CONFIG.secure_cookie),!0)}setUserData(t){if(!(t=>t===Object(t)&&!b(t))(t))return!1;if(this.userData=i(i({},this.userData),t),this.X()){var r=this.instance.CONFIG.cookie_expiration,e=this.instance.CONFIG.cross_subdomain_cookie,n=this.instance.CONFIG.secure_cookie;this.instance.persistence.set((this.instance.CONFIG.persistence_name||"_trdt")+"_udata",JSON.stringify(this.userData),r,e,n)}return!0}setIdentifier(t,r){return!(!y(t)||!y(r)||(this.identifiers[t]=r,0))}getUserData(){return i(i({},this.userData),this.identifiers)}getUserId(){return this.userId}X(){return!this.instance.CONFIG.disable_persistence}}var ni=()=>{},si="__default";!Ut&&-1===(null==l?void 0:l.indexOf("MSIE"))&&(null==l||l.indexOf("Mozilla"));class ai{__loaded=!1;CONFIG=(()=>{var t;return{api_host:"https://t.trstdata.com",api_endpoint:"/api/events",attribution_ids:[],ignore_referrer_domains:[],cross_subdomain_cookie:!0,persistence:"localStorage+cookie",persistence_name:"_trdt",debug:!1,loaded:ni,cookie_expiration:365,disable_persistence:!1,disable_compression:!1,secure_cookie:e&&"https:"===(null===(t=e.location)||void 0===t?void 0:t.protocol),request_batching:!0,properties_string_max_length:65535,session_timeout:30,on_request_error:t=>{O.error("Bad HTTP status: "+t.statusCode+" "+t.text)},send_page_view:!0,onCapture:ni,flush_interval_ms:C}})();analyticsDefaultEndpoint="/api/events";constructor(){this.STATE={clientId:null,userId:null,sessionId:null,sessionNumber:0,sessionEngaged:!1,isNewVisit:!1,isFirstVisit:!1,ignoreReferrer:!1,consentStatus:{analytics:!1,advertising:!1,personalization:!1},persistentParameters:{},initializedTargets:new Set},this.logger=T("[TrustData.js]")}config(t,r,i){var e;if(void 0===r&&(r={}),void 0===i&&(i=null),!i||i===si)return this._config(t,r,i);var n=null!==(e=ui[i])&&void 0!==e?e:new ai;return n._config(t,r,i),ui[i]=n,ui[si][i]=n,n}_config(t,r,i){return void 0===r&&(r={}),this.__loaded?(O.warn("You have already initialized TrustData! Re-initializing is a no-op"),this):(t&&!this.CONFIG.attribution_ids.includes(t)&&this.CONFIG.attribution_ids.push(t),t?(r.ignoreReferrerDomains&&(this.CONFIG.ignore_referrer_domains=Array.isArray(r.ignoreReferrerDomains)?r.ignoreReferrerDomains:[r.ignoreReferrerDomains]),Object.keys(r).forEach((t=>{t in this.CONFIG&&(this.CONFIG[t]=r[t])})),r.consent&&this.consent("update",{consent:r.consent}),this.__loaded=!0,this.rt(),this._requestQueue=new At((t=>this.it(t)),{flush_interval_ms:this.CONFIG.flush_interval_ms}),this._retryQueue=new zt(this),this.sessionManager=new ri(this),this.clientManager=new ii(this),this.userManager=new ei(this),this.clientManager.initClientId(r),this.userManager.initUser(r),this.et(),e.nt&&e.nt.length&&(this.st(e.nt),e.nt.length=0),e.ot=!0,t&&this.STATE.initializedTargets.add(t),!1!==r.send_page_view&&setTimeout((()=>this.event(N,{send_to:t})),0),"function"==typeof this.CONFIG.loaded&&this.CONFIG.loaded(this),!0):(O.critical("TrustData was initialized without a target ID. This likely indicates a misconfiguration."),this))}_processQueuedCommands(){if(e.nt&&e.nt.length){var t=e.nt.slice();e.nt.length=0;for(var r=0;r<t.length;r++){var i=t[r];if(Array.isArray(i)&&0!==i.length)try{var n=i[0],s=i.slice(1);if("config"===n&&this.STATE.pendingConfig){this._config(this.STATE.pendingConfig.targetId,this.STATE.pendingConfig.options);continue}"function"==typeof this[n]?this[n].apply(this,s):O.warn("Unknown command:",n)}catch(t){O.error("Error processing command:",t)}}}}rt(){var t=this.CONFIG;this.persistence="localStorage"===t.persistence?$t:"cookie"===t.persistence?Qt:tr,this.sessionPersistence="sessionStorage"===this.CONFIG.persistence?this.persistence:i(i({},this.persistence),{},{persistence:"sessionStorage"}),this.persistence_name=t.persistence_name||"_trdt"}et(){var t="onpagehide"in self?"pagehide":"unload";e.addEventListener(t,this.ht.bind(this),{passive:!1})}ht(){this.CONFIG.request_batching?(this.event(P),this._requestQueue.unload(),this._retryQueue.unload()):this.event(P,null,{transport:"sendBeacon"})}set(t,r){if(!this.__loaded)return this.push(["set",t,r]);if("object"==typeof t)return Object.entries(t).forEach((t=>{var[r,i]=t;return this.set(r,i)})),!0;if("function"==typeof r)try{r=r()}catch(t){return O.error("Error processing function value:",t),!1}switch("string"==typeof r&&(r=r.substring(0,100)),t){case"user_id":this.STATE.userId=r,this.userManager.setUserId(r);break;case"client_id":this.clientManager.setClientId(r);break;case"debug_mode":this.CONFIG.debug=!0===r||"true"===r;break;case"page_referrer":case"page_location":case"page_title":case"ignore_referrer":this.STATE.persistentParameters[t]=r,"ignore_referrer"===t&&(this.STATE.ignoreReferrer=!0===r||"true"===r);break;case"user_data":"object"==typeof r&&this.userManager.setUserData(r);break;case"email_hash":case"phone_hash":this.userManager.setIdentifier(t,r);break;default:this.STATE.persistentParameters[t]=r}return!0}event(t,r,e){if(void 0===r&&(r={}),void 0===e&&(e={}),!t)return O.error("Missing event name"),!1;if(!this.__loaded)return this.push(["event",t,r,e]);this.STATE.sessionEngaged=!0,r&&r.hasOwnProperty("ignore_referrer")&&(this.STATE.ignoreReferrer=!0===r.ignore_referrer,delete r.ignore_referrer),r&&["page_referrer","page_location","page_title"].forEach((t=>{r.hasOwnProperty(t)&&(this.STATE.persistentParameters[t]=r[t])}));var n=this.CONFIG.attribution_ids;r&&r.send_to&&(n=Array.isArray(r.send_to)?r.send_to:[r.send_to],delete r.send_to);var s=n.filter((t=>this.STATE.initializedTargets.has(t)));0===s.length&&this.CONFIG.attribution_ids.length>0&&(s=[this.CONFIG.attribution_ids[0]]);var a=this.STATE.isFirstVisit,o=this.STATE.isNewVisit,h=this.ut(t,r);return s.forEach((t=>{var r=i(i({},h),{},{attribution_id:t}),n={method:"POST",url:this.CONFIG.api_host+this.CONFIG.api_endpoint,data:r,compression:this.CONFIG.disable_compression?void 0:"gzip-js",batchKey:t};e&&e.transport&&(n.transport=e.transport),this.CONFIG.request_batching&&!e.send_instantly?this._requestQueue.enqueue(n):this.it(n)})),a&&(this.STATE.isFirstVisit=!1),o&&(this.STATE.isNewVisit=!1),this.sessionManager&&this.sessionManager.refreshSessionTimer(),!0}ut(t,r){var n,s,a;void 0===r&&(r={});var u=i(i({},r),{},{[A]:t}),c={[B]:this.STATE.clientId,[z]:null===(n=this.sessionManager)||void 0===n?void 0:n.getSessionId(),[G]:this.STATE.sessionNumber,[L]:this.STATE.sessionEngaged?1:0,[J]:Math.floor(Date.now()/1e3)};Object.entries(c).forEach((t=>{var[r,i]=t;u.hasOwnProperty(r)||(u[r]=i)}));var f=(function(){if(!l)return{};var t,r,i,[n,s]=(function(t){for(var r=0;r<Hr.length;r++){var[i,e]=Hr[r],n=i.exec(t),s=n&&(m(e)?e(n,t):e);if(s)return s}return["",""]})(l);return I({lib:"web",lib_version:v,event_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),event_time:Date.now()/1e3,page_location:D(null==h?void 0:h.href,[],Yr),page_hostname:null==h?void 0:h.host,page_path:null==h?void 0:h.pathname,os_name:n,os_version:s,browser:Vr(l,navigator.vendor),device:Qr(l),device_type:(r=l,i=Qr(r),i===or||i===ar||"Kobo"===i||"Kindle Fire"===i||i===Ar?sr:i===Tr||i===Mr||i===kr||i===Cr?"Console":i===ur?"Wearable":i?ir:"Desktop"),timezone:Zr(),timezone_offset:ti(),raw_user_agent:l.length>1e3?l.substring(0,997)+"...":l,browser_version:Xr(l,navigator.vendor),browser_language:$r(),browser_language_prefix:(t=$r(),"string"==typeof t?t.split("-")[0]:void 0),screen_resolution:e&&e.screen.width+"x"+e&&e.screen.height,viewport_resolution:e&&e.innerWidth+"x"+e&&e.innerHeight})})();Object.entries(f).forEach((t=>{var[r,i]=t;u[r]||(u[r]=i)}));var d,p={referrer:o&&o.referrer||"$direct",referring_domain:!o&&o.referrer?"$direct":(null===(d=(t=>{var r=o&&o.createElement("a");return w(r)?null:(r.href=t,r)})(o.referrer))||void 0===d?void 0:d.host)||"$direct"};Object.entries(p).forEach((t=>{var[r,i]=t;u[r]||(u[r]=i)}));var g,_,y,S=o?(g=D(o.URL,[],Yr),_=H.concat([]),y={},R(_,(function(t){var r=(function(t,r){for(var i,e=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),n=0;n<e.length;n++){var s=e[n].split("=");if(s[0]===r){i=s;break}}if(!b(i)||i.length<2)return"";var a=i[1];try{a=decodeURIComponent(a)}catch{O.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")})(g,t);y[t]=r||null})),y):{};Object.entries(S).forEach((t=>{var[r,i]=t;i&&!u[r]&&(u[r]=i)})),this.STATE.userId&&(u.user_id=this.STATE.userId);var x=null===(s=this.userManager)||void 0===s?void 0:s.getUserData();x&&Object.keys(x).length>0&&Object.entries(x).forEach((t=>{var[r,i]=t;u[r]||(u[r]=i)})),this.STATE.isNewVisit&&!u[K]&&(u[K]=1),this.STATE.isFirstVisit&&!u[V]&&(u[V]=1);var E=o&&(null===(a=o.location)||void 0===a?void 0:a.href),T=o&&o.referrer,k=this.STATE.ignoreReferrer;if(T)try{var M=new URL(T).hostname;this.CONFIG.ignore_referrer_domains.includes(M)&&(k=!0)}catch(t){}if(this.STATE.persistentParameters.page_referrer){var U=this.ct(this.STATE.persistentParameters.page_referrer),j=this.ct(E);j&&U&&j===U&&(k=!0)}return k&&!u[X]&&(u[X]=!0),k||!T||this.STATE.persistentParameters.page_referrer||u[W]||(u[W]=T),this.STATE.persistentParameters.page_referrer||this.STATE.persistentParameters.page_location||this.STATE.persistentParameters.page_title||u[W]||u[F]||u[q]||o&&(u[F]||(u[F]=o.location.href),u[q]||(u[q]=o.title)),Object.entries(this.STATE.persistentParameters).forEach((t=>{var[r,i]=t;u[r]||(u[r]=i)})),u.consent_analytics||(u.consent_analytics=this.STATE.consentStatus.analytics),u.consent_advertising||(u.consent_advertising=this.STATE.consentStatus.advertising),u.consent_personalization||(u.consent_personalization=this.STATE.consentStatus.personalization),u}ct(t){try{return new URL(t||"").hostname}catch(t){return""}}it(t){this._retryQueue?this._retryQueue.retriableRequest(t):this.N(t)}N(t){if(this.__loaded){if(t.headers=t.headers||{},"sendBeacon"===t.transport&&a&&a.sendBeacon)try{if(a.sendBeacon(t.url,new Blob([JSON.stringify(t.data)],{type:"text/plain"})))return;O.warn("sendBeacon failed, falling back to regular request")}catch(t){O.error("Error in sendBeacon, falling back to regular request:",t)}(t=>{var r,e,n,s=i({},t);s.timeout=s.timeout||6e4,s.url=jt(s.url,{_:""+(new Date).getTime(),ver:v,compression:s.compression});var a=null!==(r=s.transport)&&void 0!==r?r:"fetch",o=null!==(e=null===(n=(function(t){for(var r=0;r<t.length;r++)if(t[r].transport===a)return t[r]})(Nt))||void 0===n?void 0:n.method)&&void 0!==e?e:Nt[0].method;if(!o)throw Error("No available transport method");o(s)})(i(i({},t),{},{callback:r=>{var i,e,n;r.statusCode>=400&&(O.error("Request error:",r.statusCode,r.text),null===(e=(n=this.CONFIG).on_request_error)||void 0===e||e.call(n,r)),null===(i=t.callback)||void 0===i||i.call(t,r)}}))}else O.warn("TrustData not initialized, cannot send request")}consent(t,r){if(!this.__loaded)return this.push(["consent",t,r]);if(!r||!r.hasOwnProperty("consent"))return O.error("Invalid consent parameters"),!1;var i=r.consent;return"analytics"in i&&(this.STATE.consentStatus.analytics=!0===i.analytics||"granted"===i.analytics),"advertising"in i&&(this.STATE.consentStatus.advertising=!0===i.advertising||"granted"===i.advertising),"personalization"in i&&(this.STATE.consentStatus.personalization=!0===i.personalization||"granted"===i.personalization),!0}get(t,r,e){var n,s,a;if("string"==typeof t&&"function"==typeof r&&(e=r,r=t,t=null),!this.__loaded)return this.push(["get",t,r,e]);switch(r){case"client_id":a=this.STATE.clientId;break;case"user_id":a=this.STATE.userId;break;case"session_id":a=null===(n=this.sessionManager)||void 0===n?void 0:n.getSessionId();break;case"user_data":a=(null===(s=this.userManager)||void 0===s?void 0:s.getUserData())||{};break;case"consent_status":a=i({},this.STATE.consentStatus);break;case"debug_mode":a=this.CONFIG.debug;break;default:a=this.STATE.persistentParameters[r]}return"function"==typeof e&&e(a),a}push(t){this.__loaded?b(t)?this.st([t]):m(t)&&t.call(this):(e.nt||(e.nt=[]),e.nt.push(t))}}e.ft=e.ft||{},e.nt=e.nt||[],e.ot=!1;var oi,hi,ui={};!(function(t,r){for(var i=0;i<5;i++)t.prototype[r[i]]=U(t.prototype[r[i]])})(ai,["event","set","get","consent","push"]),ai.prototype.lt=function(){this.CONFIG.send_page_view&&this.__loaded&&this.event(N)},ai.prototype.st=function(t){if(b(t)){var r=[],i=[],e=[];R(t,(t=>{if(t){var n=t[0];b(n)?e.push(t):m(t)?t.call(this):b(t)&&"alias"===n?r.push(t):b(t)&&(-1!==n.indexOf("event")||-1!==n.indexOf("capture"))&&m(this[n])?e.push(t):i.push(t)}}));var n=t=>{R(t,(t=>{if(b(t[0])){var r=this;R(t,(t=>{r=r[t[0]].apply(r,t.slice(1))}))}else this[t[0]].apply(this,t.slice(1))}))};n(r),n(i),n(e)}},oi=ui[si]=new ai,(hi=e.trustdata)&&hi.dt&&b(hi.dt)&&R(hi.dt,(function(t){if(t&&b(t)){var r=t[2]||si,i=oi.config(t[0],t[1]||{},r);i&&i.st(hi[r]||hi)}})),e.trustdata=oi,(function(){function t(){t.done||(t.done=!0,Object.values(ui).forEach((function(t){"function"==typeof t.lt&&t.lt()})))}o&&o.addEventListener?"complete"===o.readyState?t():o.addEventListener("DOMContentLoaded",t,{capture:!1,passive:!0}):e&&O.error("Browser doesn't support `document.addEventListener` so TrustData couldn't be initialized")})()})();
